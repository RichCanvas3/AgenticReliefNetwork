"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@agentic-trust+core@1.0.17_@veramo+core@6.0.0_bufferutil@4.0.9_encoding@0.1.13_graphql@16.12._bnyldtxzb6pv7ivr5y6a3orzga";
exports.ids = ["vendor-chunks/@agentic-trust+core@1.0.17_@veramo+core@6.0.0_bufferutil@4.0.9_encoding@0.1.13_graphql@16.12._bnyldtxzb6pv7ivr5y6a3orzga"];
exports.modules = {

/***/ "(ssr)/../../node_modules/.pnpm/@agentic-trust+core@1.0.17_@veramo+core@6.0.0_bufferutil@4.0.9_encoding@0.1.13_graphql@16.12._bnyldtxzb6pv7ivr5y6a3orzga/node_modules/@agentic-trust/core/dist/client/accountClient.js":
/*!***********************************************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/@agentic-trust+core@1.0.17_@veramo+core@6.0.0_bufferutil@4.0.9_encoding@0.1.13_graphql@16.12._bnyldtxzb6pv7ivr5y6a3orzga/node_modules/@agentic-trust/core/dist/client/accountClient.js ***!
  \***********************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deploySmartAccountIfNeeded: () => (/* binding */ deploySmartAccountIfNeeded),\n/* harmony export */   getCounterfactualAAAddressByAgentName: () => (/* binding */ getCounterfactualAAAddressByAgentName),\n/* harmony export */   getCounterfactualAccountClientByAgentName: () => (/* binding */ getCounterfactualAccountClientByAgentName),\n/* harmony export */   getDeployedAccountClientByAgentName: () => (/* binding */ getDeployedAccountClientByAgentName),\n/* harmony export */   isSmartContract: () => (/* binding */ isSmartContract),\n/* harmony export */   sendSponsoredUserOperation: () => (/* binding */ sendSponsoredUserOperation),\n/* harmony export */   waitForUserOperationReceipt: () => (/* binding */ waitForUserOperationReceipt)\n/* harmony export */ });\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! viem */ \"(ssr)/../../node_modules/.pnpm/viem@2.39.3_bufferutil@4.0.9_typescript@5.9.3_utf-8-validate@5.0.10/node_modules/viem/_esm/clients/createWalletClient.js\");\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! viem */ \"(ssr)/../../node_modules/.pnpm/viem@2.39.3_bufferutil@4.0.9_typescript@5.9.3_utf-8-validate@5.0.10/node_modules/viem/_esm/clients/transports/custom.js\");\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! viem */ \"(ssr)/../../node_modules/.pnpm/viem@2.39.3_bufferutil@4.0.9_typescript@5.9.3_utf-8-validate@5.0.10/node_modules/viem/_esm/clients/createPublicClient.js\");\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! viem */ \"(ssr)/../../node_modules/.pnpm/viem@2.39.3_bufferutil@4.0.9_typescript@5.9.3_utf-8-validate@5.0.10/node_modules/viem/_esm/utils/hash/keccak256.js\");\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! viem */ \"(ssr)/../../node_modules/.pnpm/viem@2.39.3_bufferutil@4.0.9_typescript@5.9.3_utf-8-validate@5.0.10/node_modules/viem/_esm/utils/encoding/toHex.js\");\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! viem */ \"(ssr)/../../node_modules/.pnpm/viem@2.39.3_bufferutil@4.0.9_typescript@5.9.3_utf-8-validate@5.0.10/node_modules/viem/_esm/clients/transports/http.js\");\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! viem */ \"(ssr)/../../node_modules/.pnpm/viem@2.39.3_bufferutil@4.0.9_typescript@5.9.3_utf-8-validate@5.0.10/node_modules/viem/_esm/constants/address.js\");\n/* harmony import */ var viem_chains__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! viem/chains */ \"(ssr)/../../node_modules/.pnpm/viem@2.39.3_bufferutil@4.0.9_typescript@5.9.3_utf-8-validate@5.0.10/node_modules/viem/_esm/chains/definitions/sepolia.js\");\n/* harmony import */ var viem_account_abstraction__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! viem/account-abstraction */ \"(ssr)/../../node_modules/.pnpm/viem@2.39.3_bufferutil@4.0.9_typescript@5.9.3_utf-8-validate@5.0.10/node_modules/viem/_esm/account-abstraction/clients/createBundlerClient.js\");\n/* harmony import */ var _server_lib_chainConfig__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../server/lib/chainConfig */ \"(ssr)/../../node_modules/.pnpm/@agentic-trust+core@1.0.17_@veramo+core@6.0.0_bufferutil@4.0.9_encoding@0.1.13_graphql@16.12._bnyldtxzb6pv7ivr5y6a3orzga/node_modules/@agentic-trust/core/dist/server/lib/chainConfig.js\");\n/* harmony import */ var _metamask_delegation_toolkit__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @metamask/delegation-toolkit */ \"(ssr)/../../node_modules/.pnpm/@metamask+delegation-toolkit@0.13.0_viem@2.39.3_bufferutil@4.0.9_typescript@5.9.3_utf-8-validate@5.0.10_/node_modules/@metamask/delegation-toolkit/dist/chunk-NV2Z25GV.mjs\");\n/* harmony import */ var _metamask_delegation_toolkit__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @metamask/delegation-toolkit */ \"(ssr)/../../node_modules/.pnpm/@metamask+delegation-toolkit@0.13.0_viem@2.39.3_bufferutil@4.0.9_typescript@5.9.3_utf-8-validate@5.0.10_/node_modules/@metamask/delegation-toolkit/dist/index.mjs\");\n\n\n\n\n\n/**\n * Get the counterfactual AA address for an agent name (client-side computation)\n *\n * This function computes the AA address without creating a full account client.\n * It uses the wallet provider (MetaMask/Web3Auth) to compute the address.\n *\n * @param agentName - The agent name\n * @param eoaAddress - The EOA address (owner of the AA account)\n * @param options - Options for chain, ethereumProvider, etc.\n * @returns The counterfactual AA address\n */\nasync function getCounterfactualAAAddressByAgentName(agentName, eoaAddress, options) {\n    // Use the existing function to get the account client, then return just the address\n    const accountClient = await getCounterfactualAccountClientByAgentName(agentName, eoaAddress, options);\n    return accountClient.address;\n}\nasync function getCounterfactualAccountClientByAgentName(agentName, eoaAddress, options) {\n    const chain = options?.chain || viem_chains__WEBPACK_IMPORTED_MODULE_1__.sepolia;\n    let walletClient;\n    if (options?.walletClient) {\n        walletClient = options.walletClient;\n    }\n    else if (options?.ethereumProvider) {\n        walletClient = (0,viem__WEBPACK_IMPORTED_MODULE_2__.createWalletClient)({\n            chain: chain,\n            transport: (0,viem__WEBPACK_IMPORTED_MODULE_3__.custom)(options.ethereumProvider),\n            account: eoaAddress,\n        });\n    }\n    else {\n        throw new Error('No wallet client found. Ensure MetaMask/Web3Auth is available or pass walletClient in options.');\n    }\n    let publicClient;\n    if (options?.publicClient) {\n        publicClient = options.publicClient;\n    }\n    else if (options?.ethereumProvider) {\n        publicClient = (0,viem__WEBPACK_IMPORTED_MODULE_4__.createPublicClient)({\n            chain: chain,\n            transport: (0,viem__WEBPACK_IMPORTED_MODULE_3__.custom)(options?.ethereumProvider),\n        });\n    }\n    else {\n        throw new Error('No public client found. Ensure RPC URL is available or pass publicClient in options.');\n    }\n    const salt = (0,viem__WEBPACK_IMPORTED_MODULE_5__.keccak256)((0,viem__WEBPACK_IMPORTED_MODULE_6__.stringToHex)(agentName));\n    const clientConfig = {\n        client: publicClient,\n        implementation: _metamask_delegation_toolkit__WEBPACK_IMPORTED_MODULE_7__.Implementation.Hybrid,\n        signer: {\n            walletClient,\n        },\n        deployParams: [eoaAddress, [], [], []],\n        deploySalt: salt,\n    };\n    let counterfactualAccountClient = await (0,_metamask_delegation_toolkit__WEBPACK_IMPORTED_MODULE_8__.toMetaMaskSmartAccount)(clientConfig);\n    return counterfactualAccountClient;\n}\nasync function getDeployedAccountClientByAgentName(bundlerUrl, agentName, eoaAddress, options) {\n    const chain = options?.chain || viem_chains__WEBPACK_IMPORTED_MODULE_1__.sepolia;\n    console.info('*********** accountClient getDeployedAccountClientByAgentName: agentName', agentName);\n    console.info('*********** accountClient getDeployedAccountClientByAgentName: chain.id', chain?.id);\n    console.info('*********** accountClient getDeployedAccountClientByAgentName: bundlerUrl', bundlerUrl);\n    let walletClient;\n    if (options?.walletClient) {\n        walletClient = options.walletClient;\n    }\n    else if (options?.ethereumProvider) {\n        walletClient = (0,viem__WEBPACK_IMPORTED_MODULE_2__.createWalletClient)({\n            chain: chain,\n            transport: (0,viem__WEBPACK_IMPORTED_MODULE_3__.custom)(options.ethereumProvider),\n            account: eoaAddress,\n        });\n    }\n    else {\n        throw new Error('No wallet client found. Ensure MetaMask/Web3Auth is available or pass walletClient in options.');\n    }\n    let publicClient;\n    if (options?.publicClient) {\n        publicClient = options.publicClient;\n    }\n    else if (options?.ethereumProvider) {\n        publicClient = (0,viem__WEBPACK_IMPORTED_MODULE_4__.createPublicClient)({\n            chain: chain,\n            transport: (0,viem__WEBPACK_IMPORTED_MODULE_3__.custom)(options?.ethereumProvider),\n        });\n    }\n    else {\n        throw new Error('No public client found. Ensure RPC URL is available or pass publicClient in options.');\n    }\n    const salt = (0,viem__WEBPACK_IMPORTED_MODULE_5__.keccak256)((0,viem__WEBPACK_IMPORTED_MODULE_6__.stringToHex)(agentName));\n    const clientConfig = {\n        client: publicClient,\n        implementation: _metamask_delegation_toolkit__WEBPACK_IMPORTED_MODULE_7__.Implementation.Hybrid,\n        signer: {\n            walletClient,\n        },\n        deployParams: [eoaAddress, [], [], []],\n        deploySalt: salt,\n    };\n    let counterfactualAccountClient = await (0,_metamask_delegation_toolkit__WEBPACK_IMPORTED_MODULE_8__.toMetaMaskSmartAccount)(clientConfig);\n    // Check deployment status with provided publicClient, then fall back to HTTP RPC if available\n    let isDeployed = false;\n    try {\n        const code = await publicClient.getBytecode({ address: counterfactualAccountClient.address });\n        isDeployed = !!code && code !== \"0x\";\n    }\n    catch { }\n    if (!isDeployed) {\n        try {\n            const rpcUrl = (0,_server_lib_chainConfig__WEBPACK_IMPORTED_MODULE_0__.getChainRpcUrl)(chain.id);\n            console.info('*********** accountClient getDeployedAccountClientByAgentName: checking on RPC', rpcUrl);\n            if (rpcUrl) {\n                const httpClient = (0,viem__WEBPACK_IMPORTED_MODULE_4__.createPublicClient)({ chain: chain, transport: (0,viem__WEBPACK_IMPORTED_MODULE_9__.http)(rpcUrl) });\n                const codeHttp = await httpClient.getBytecode({ address: counterfactualAccountClient.address });\n                isDeployed = !!codeHttp && codeHttp !== \"0x\";\n            }\n        }\n        catch { }\n    }\n    console.info('*********** accountClient getDeployedAccountClientByAgentName: isDeployed', isDeployed);\n    if (!isDeployed && bundlerUrl) {\n        console.info('*********** accountClient getDeployedAccountClientByAgentName: deploying via bundler');\n        const pimlico = await getPimlicoClient(bundlerUrl);\n        const bundlerClient = (0,viem_account_abstraction__WEBPACK_IMPORTED_MODULE_10__.createBundlerClient)({\n            transport: (0,viem__WEBPACK_IMPORTED_MODULE_9__.http)(bundlerUrl),\n            paymaster: true,\n            chain: chain,\n            paymasterContext: { mode: 'SPONSORED' },\n        });\n        const { fast: fee } = await pimlico.getUserOperationGasPrice();\n        console.info('*********** accountClient getDeployedAccountClientByAgentName: gas price', fee);\n        const userOperationHash = await bundlerClient.sendUserOperation({\n            account: counterfactualAccountClient,\n            calls: [{ to: viem__WEBPACK_IMPORTED_MODULE_11__.zeroAddress }],\n            ...fee,\n        });\n        console.info('*********** accountClient getDeployedAccountClientByAgentName: userOperationHash', userOperationHash);\n        await bundlerClient.waitForUserOperationReceipt({ hash: userOperationHash });\n        // After deployment, mark as deployed so we rebuild below\n        isDeployed = true;\n    }\n    if (isDeployed) {\n        // Rebuild a \"clean\" smart account client with address only (no factory/deploy params)\n        // using an HTTP public client to avoid provider quirks.\n        try {\n            const rpcUrl = (0,_server_lib_chainConfig__WEBPACK_IMPORTED_MODULE_0__.getChainRpcUrl)(chain.id);\n            const httpClient = (0,viem__WEBPACK_IMPORTED_MODULE_4__.createPublicClient)({ chain: chain, transport: (0,viem__WEBPACK_IMPORTED_MODULE_9__.http)(rpcUrl) });\n            console.info('*********** accountClient getDeployedAccountClientByAgentName: rebuilding deployed account client (address-only)');\n            const deployedAccountClient = await (0,_metamask_delegation_toolkit__WEBPACK_IMPORTED_MODULE_8__.toMetaMaskSmartAccount)({\n                client: httpClient,\n                implementation: _metamask_delegation_toolkit__WEBPACK_IMPORTED_MODULE_7__.Implementation.Hybrid,\n                signer: {\n                    walletClient: walletClient,\n                },\n                address: counterfactualAccountClient.address,\n            });\n            console.info('*********** accountClient getDeployedAccountClientByAgentName: agentAccountClient', deployedAccountClient.address);\n            return deployedAccountClient;\n        }\n        catch (rebuildErr) {\n            console.warn('*********** accountClient getDeployedAccountClientByAgentName: rebuild failed, falling back to existing client', rebuildErr);\n            return counterfactualAccountClient;\n        }\n    }\n    console.info('*********** accountClient getDeployedAccountClientByAgentName: agentAccountClient', counterfactualAccountClient.address);\n    return counterfactualAccountClient;\n}\n// ============================================================================\n// Bundler Utilities\n// ============================================================================\n// Dynamic import for permissionless (optional dependency)\nasync function getPimlicoClient(bundlerUrl) {\n    try {\n        // @ts-ignore - permissionless is an optional dependency\n        const { createPimlicoClient } = await Promise.all(/*! import() */[__webpack_require__.e(\"vendor-chunks/viem@2.39.3_bufferutil@4.0.9_typescript@5.9.3_utf-8-validate@5.0.10\"), __webpack_require__.e(\"vendor-chunks/permissionless@0.2.57_ox@0.9.6_typescript@5.9.3__viem@2.39.3_bufferutil@4.0.9_typescript@5.9.3_utf-8-validate@5.0.10_\")]).then(__webpack_require__.bind(__webpack_require__, /*! permissionless/clients/pimlico */ \"(ssr)/../../node_modules/.pnpm/permissionless@0.2.57_ox@0.9.6_typescript@5.9.3__viem@2.39.3_bufferutil@4.0.9_typescript@5.9.3_utf-8-validate@5.0.10_/node_modules/permissionless/_esm/clients/pimlico.js\"));\n        return createPimlicoClient({ transport: (0,viem__WEBPACK_IMPORTED_MODULE_9__.http)(bundlerUrl) });\n    }\n    catch (error) {\n        throw new Error('permissionless package not installed. Install it with: pnpm add permissionless ' +\n            `Error: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n}\n/**\n * Send a sponsored UserOperation via bundler\n *\n * @param params - UserOperation parameters\n * @returns UserOperation hash\n */\nasync function sendSponsoredUserOperation(params) {\n    const { bundlerUrl, chain, accountClient, calls } = params;\n    const pimlicoClient = await getPimlicoClient(bundlerUrl);\n    const bundlerClient = (0,viem_account_abstraction__WEBPACK_IMPORTED_MODULE_10__.createBundlerClient)({\n        transport: (0,viem__WEBPACK_IMPORTED_MODULE_9__.http)(bundlerUrl),\n        paymaster: true,\n        chain: chain,\n        paymasterContext: { mode: 'SPONSORED' }\n    });\n    const { fast: fee } = await pimlicoClient.getUserOperationGasPrice();\n    const userOpHash = await bundlerClient.sendUserOperation({\n        account: accountClient,\n        calls,\n        ...fee\n    });\n    return userOpHash;\n}\n/**\n * Wait for UserOperation receipt\n *\n * @param params - Receipt parameters\n * @returns UserOperation receipt\n */\nasync function waitForUserOperationReceipt(params) {\n    const { bundlerUrl, chain, hash } = params;\n    const bundlerClient = (0,viem_account_abstraction__WEBPACK_IMPORTED_MODULE_10__.createBundlerClient)({\n        transport: (0,viem__WEBPACK_IMPORTED_MODULE_9__.http)(bundlerUrl),\n        paymaster: true,\n        chain: chain,\n        paymasterContext: { mode: 'SPONSORED' }\n    });\n    return await bundlerClient.waitForUserOperationReceipt({ hash });\n}\n/**\n * Deploy smart account if needed\n *\n * @param params - Deployment parameters\n * @returns true if account was deployed, false if already deployed\n */\nasync function deploySmartAccountIfNeeded(params) {\n    const { bundlerUrl, chain, account } = params;\n    const isDeployed = await account.isDeployed();\n    if (isDeployed)\n        return false;\n    const pimlico = await getPimlicoClient(bundlerUrl);\n    const bundlerClient = (0,viem_account_abstraction__WEBPACK_IMPORTED_MODULE_10__.createBundlerClient)({\n        transport: (0,viem__WEBPACK_IMPORTED_MODULE_9__.http)(bundlerUrl),\n        paymaster: true,\n        chain: chain,\n        paymasterContext: { mode: 'SPONSORED' }\n    });\n    const { fast } = await pimlico.getUserOperationGasPrice();\n    const userOperationHash = await bundlerClient.sendUserOperation({\n        account,\n        calls: [{ to: viem__WEBPACK_IMPORTED_MODULE_11__.zeroAddress }],\n        ...fast\n    });\n    await bundlerClient.waitForUserOperationReceipt({ hash: userOperationHash });\n    return true;\n}\n/**\n * Check if an address is a smart contract (has code)\n *\n * @param publicClient - Viem public client\n * @param address - Address to check\n * @returns true if address has code (is a contract), false if EOA\n */\nasync function isSmartContract(publicClient, address) {\n    try {\n        const code = await publicClient.getBytecode({ address });\n        return code !== undefined && code !== '0x';\n    }\n    catch {\n        return false;\n    }\n}\n//# sourceMappingURL=accountClient.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BhZ2VudGljLXRydXN0K2NvcmVAMS4wLjE3X0B2ZXJhbW8rY29yZUA2LjAuMF9idWZmZXJ1dGlsQDQuMC45X2VuY29kaW5nQDAuMS4xM19ncmFwaHFsQDE2LjEyLl9ibnlsZHR4emI2cHY3aXZyNXk2YTNvcnpnYS9ub2RlX21vZHVsZXMvQGFnZW50aWMtdHJ1c3QvY29yZS9kaXN0L2NsaWVudC9hY2NvdW50Q2xpZW50LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBaUg7QUFDM0U7QUFDeUI7QUFDSjtBQUMyQjtBQUN0RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1Asb0NBQW9DLGdEQUFPO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsd0RBQWtCO0FBQ3pDO0FBQ0EsdUJBQXVCLDRDQUFNO0FBQzdCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qix3REFBa0I7QUFDekM7QUFDQSx1QkFBdUIsNENBQU07QUFDN0IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLCtDQUFTLENBQUMsaURBQVc7QUFDdEM7QUFDQTtBQUNBLHdCQUF3Qix3RUFBYztBQUN0QztBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxvRkFBc0I7QUFDbEU7QUFDQTtBQUNPO0FBQ1Asb0NBQW9DLGdEQUFPO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsd0RBQWtCO0FBQ3pDO0FBQ0EsdUJBQXVCLDRDQUFNO0FBQzdCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qix3REFBa0I7QUFDekM7QUFDQSx1QkFBdUIsNENBQU07QUFDN0IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLCtDQUFTLENBQUMsaURBQVc7QUFDdEM7QUFDQTtBQUNBLHdCQUF3Qix3RUFBYztBQUN0QztBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxvRkFBc0I7QUFDbEU7QUFDQTtBQUNBO0FBQ0Esc0RBQXNELDhDQUE4QztBQUNwRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHVFQUFjO0FBQ3pDO0FBQ0E7QUFDQSxtQ0FBbUMsd0RBQWtCLEdBQUcseUJBQXlCLDBDQUFJLFVBQVU7QUFDL0YsZ0VBQWdFLDhDQUE4QztBQUM5RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsOEVBQW1CO0FBQ2pELHVCQUF1QiwwQ0FBSTtBQUMzQjtBQUNBO0FBQ0EsZ0NBQWdDLG1CQUFtQjtBQUNuRCxTQUFTO0FBQ1QsZ0JBQWdCLFlBQVk7QUFDNUI7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLElBQUksOENBQVcsRUFBRTtBQUN2QztBQUNBLFNBQVM7QUFDVDtBQUNBLDBEQUEwRCx5QkFBeUI7QUFDbkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsdUVBQWM7QUFDekMsK0JBQStCLHdEQUFrQixHQUFHLHlCQUF5QiwwQ0FBSSxVQUFVO0FBQzNGO0FBQ0EsZ0RBQWdELG9GQUFzQjtBQUN0RTtBQUNBLGdDQUFnQyx3RUFBYztBQUM5QztBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixzQkFBc0IsUUFBUSw0a0JBQXdDO0FBQ3RGLHFDQUFxQyxXQUFXLDBDQUFJLGNBQWM7QUFDbEU7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHlEQUF5RDtBQUMvRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUCxZQUFZLDBDQUEwQztBQUN0RDtBQUNBLDBCQUEwQiw4RUFBbUI7QUFDN0MsbUJBQW1CLDBDQUFJO0FBQ3ZCO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUIsS0FBSztBQUNMLFlBQVksWUFBWTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUCxZQUFZLDBCQUEwQjtBQUN0QywwQkFBMEIsOEVBQW1CO0FBQzdDLG1CQUFtQiwwQ0FBSTtBQUN2QjtBQUNBO0FBQ0EsNEJBQTRCO0FBQzVCLEtBQUs7QUFDTCw2REFBNkQsTUFBTTtBQUNuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1AsWUFBWSw2QkFBNkI7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsOEVBQW1CO0FBQzdDLG1CQUFtQiwwQ0FBSTtBQUN2QjtBQUNBO0FBQ0EsNEJBQTRCO0FBQzVCLEtBQUs7QUFDTCxZQUFZLE9BQU87QUFDbkI7QUFDQTtBQUNBLGtCQUFrQixJQUFJLDhDQUFXLEVBQUU7QUFDbkM7QUFDQSxLQUFLO0FBQ0wsc0RBQXNELHlCQUF5QjtBQUMvRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0Esc0RBQXNELFNBQVM7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9AbXktc2NvcGUvYXJuLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9AYWdlbnRpYy10cnVzdCtjb3JlQDEuMC4xN19AdmVyYW1vK2NvcmVANi4wLjBfYnVmZmVydXRpbEA0LjAuOV9lbmNvZGluZ0AwLjEuMTNfZ3JhcGhxbEAxNi4xMi5fYm55bGR0eHpiNnB2N2l2cjV5NmEzb3J6Z2Evbm9kZV9tb2R1bGVzL0BhZ2VudGljLXRydXN0L2NvcmUvZGlzdC9jbGllbnQvYWNjb3VudENsaWVudC5qcz9mZmJmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGtlY2NhazI1Niwgc3RyaW5nVG9IZXgsIGNyZWF0ZVB1YmxpY0NsaWVudCwgaHR0cCwgemVyb0FkZHJlc3MsIGNyZWF0ZVdhbGxldENsaWVudCwgY3VzdG9tIH0gZnJvbSAndmllbSc7XG5pbXBvcnQgeyBzZXBvbGlhIH0gZnJvbSAndmllbS9jaGFpbnMnO1xuaW1wb3J0IHsgY3JlYXRlQnVuZGxlckNsaWVudCB9IGZyb20gJ3ZpZW0vYWNjb3VudC1hYnN0cmFjdGlvbic7XG5pbXBvcnQgeyBnZXRDaGFpblJwY1VybCB9IGZyb20gJy4uL3NlcnZlci9saWIvY2hhaW5Db25maWcnO1xuaW1wb3J0IHsgdG9NZXRhTWFza1NtYXJ0QWNjb3VudCwgSW1wbGVtZW50YXRpb24gfSBmcm9tICdAbWV0YW1hc2svZGVsZWdhdGlvbi10b29sa2l0Jztcbi8qKlxuICogR2V0IHRoZSBjb3VudGVyZmFjdHVhbCBBQSBhZGRyZXNzIGZvciBhbiBhZ2VudCBuYW1lIChjbGllbnQtc2lkZSBjb21wdXRhdGlvbilcbiAqXG4gKiBUaGlzIGZ1bmN0aW9uIGNvbXB1dGVzIHRoZSBBQSBhZGRyZXNzIHdpdGhvdXQgY3JlYXRpbmcgYSBmdWxsIGFjY291bnQgY2xpZW50LlxuICogSXQgdXNlcyB0aGUgd2FsbGV0IHByb3ZpZGVyIChNZXRhTWFzay9XZWIzQXV0aCkgdG8gY29tcHV0ZSB0aGUgYWRkcmVzcy5cbiAqXG4gKiBAcGFyYW0gYWdlbnROYW1lIC0gVGhlIGFnZW50IG5hbWVcbiAqIEBwYXJhbSBlb2FBZGRyZXNzIC0gVGhlIEVPQSBhZGRyZXNzIChvd25lciBvZiB0aGUgQUEgYWNjb3VudClcbiAqIEBwYXJhbSBvcHRpb25zIC0gT3B0aW9ucyBmb3IgY2hhaW4sIGV0aGVyZXVtUHJvdmlkZXIsIGV0Yy5cbiAqIEByZXR1cm5zIFRoZSBjb3VudGVyZmFjdHVhbCBBQSBhZGRyZXNzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDb3VudGVyZmFjdHVhbEFBQWRkcmVzc0J5QWdlbnROYW1lKGFnZW50TmFtZSwgZW9hQWRkcmVzcywgb3B0aW9ucykge1xuICAgIC8vIFVzZSB0aGUgZXhpc3RpbmcgZnVuY3Rpb24gdG8gZ2V0IHRoZSBhY2NvdW50IGNsaWVudCwgdGhlbiByZXR1cm4ganVzdCB0aGUgYWRkcmVzc1xuICAgIGNvbnN0IGFjY291bnRDbGllbnQgPSBhd2FpdCBnZXRDb3VudGVyZmFjdHVhbEFjY291bnRDbGllbnRCeUFnZW50TmFtZShhZ2VudE5hbWUsIGVvYUFkZHJlc3MsIG9wdGlvbnMpO1xuICAgIHJldHVybiBhY2NvdW50Q2xpZW50LmFkZHJlc3M7XG59XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q291bnRlcmZhY3R1YWxBY2NvdW50Q2xpZW50QnlBZ2VudE5hbWUoYWdlbnROYW1lLCBlb2FBZGRyZXNzLCBvcHRpb25zKSB7XG4gICAgY29uc3QgY2hhaW4gPSBvcHRpb25zPy5jaGFpbiB8fCBzZXBvbGlhO1xuICAgIGxldCB3YWxsZXRDbGllbnQ7XG4gICAgaWYgKG9wdGlvbnM/LndhbGxldENsaWVudCkge1xuICAgICAgICB3YWxsZXRDbGllbnQgPSBvcHRpb25zLndhbGxldENsaWVudDtcbiAgICB9XG4gICAgZWxzZSBpZiAob3B0aW9ucz8uZXRoZXJldW1Qcm92aWRlcikge1xuICAgICAgICB3YWxsZXRDbGllbnQgPSBjcmVhdGVXYWxsZXRDbGllbnQoe1xuICAgICAgICAgICAgY2hhaW46IGNoYWluLFxuICAgICAgICAgICAgdHJhbnNwb3J0OiBjdXN0b20ob3B0aW9ucy5ldGhlcmV1bVByb3ZpZGVyKSxcbiAgICAgICAgICAgIGFjY291bnQ6IGVvYUFkZHJlc3MsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyB3YWxsZXQgY2xpZW50IGZvdW5kLiBFbnN1cmUgTWV0YU1hc2svV2ViM0F1dGggaXMgYXZhaWxhYmxlIG9yIHBhc3Mgd2FsbGV0Q2xpZW50IGluIG9wdGlvbnMuJyk7XG4gICAgfVxuICAgIGxldCBwdWJsaWNDbGllbnQ7XG4gICAgaWYgKG9wdGlvbnM/LnB1YmxpY0NsaWVudCkge1xuICAgICAgICBwdWJsaWNDbGllbnQgPSBvcHRpb25zLnB1YmxpY0NsaWVudDtcbiAgICB9XG4gICAgZWxzZSBpZiAob3B0aW9ucz8uZXRoZXJldW1Qcm92aWRlcikge1xuICAgICAgICBwdWJsaWNDbGllbnQgPSBjcmVhdGVQdWJsaWNDbGllbnQoe1xuICAgICAgICAgICAgY2hhaW46IGNoYWluLFxuICAgICAgICAgICAgdHJhbnNwb3J0OiBjdXN0b20ob3B0aW9ucz8uZXRoZXJldW1Qcm92aWRlciksXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBwdWJsaWMgY2xpZW50IGZvdW5kLiBFbnN1cmUgUlBDIFVSTCBpcyBhdmFpbGFibGUgb3IgcGFzcyBwdWJsaWNDbGllbnQgaW4gb3B0aW9ucy4nKTtcbiAgICB9XG4gICAgY29uc3Qgc2FsdCA9IGtlY2NhazI1NihzdHJpbmdUb0hleChhZ2VudE5hbWUpKTtcbiAgICBjb25zdCBjbGllbnRDb25maWcgPSB7XG4gICAgICAgIGNsaWVudDogcHVibGljQ2xpZW50LFxuICAgICAgICBpbXBsZW1lbnRhdGlvbjogSW1wbGVtZW50YXRpb24uSHlicmlkLFxuICAgICAgICBzaWduZXI6IHtcbiAgICAgICAgICAgIHdhbGxldENsaWVudCxcbiAgICAgICAgfSxcbiAgICAgICAgZGVwbG95UGFyYW1zOiBbZW9hQWRkcmVzcywgW10sIFtdLCBbXV0sXG4gICAgICAgIGRlcGxveVNhbHQ6IHNhbHQsXG4gICAgfTtcbiAgICBsZXQgY291bnRlcmZhY3R1YWxBY2NvdW50Q2xpZW50ID0gYXdhaXQgdG9NZXRhTWFza1NtYXJ0QWNjb3VudChjbGllbnRDb25maWcpO1xuICAgIHJldHVybiBjb3VudGVyZmFjdHVhbEFjY291bnRDbGllbnQ7XG59XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RGVwbG95ZWRBY2NvdW50Q2xpZW50QnlBZ2VudE5hbWUoYnVuZGxlclVybCwgYWdlbnROYW1lLCBlb2FBZGRyZXNzLCBvcHRpb25zKSB7XG4gICAgY29uc3QgY2hhaW4gPSBvcHRpb25zPy5jaGFpbiB8fCBzZXBvbGlhO1xuICAgIGNvbnNvbGUuaW5mbygnKioqKioqKioqKiogYWNjb3VudENsaWVudCBnZXREZXBsb3llZEFjY291bnRDbGllbnRCeUFnZW50TmFtZTogYWdlbnROYW1lJywgYWdlbnROYW1lKTtcbiAgICBjb25zb2xlLmluZm8oJyoqKioqKioqKioqIGFjY291bnRDbGllbnQgZ2V0RGVwbG95ZWRBY2NvdW50Q2xpZW50QnlBZ2VudE5hbWU6IGNoYWluLmlkJywgY2hhaW4/LmlkKTtcbiAgICBjb25zb2xlLmluZm8oJyoqKioqKioqKioqIGFjY291bnRDbGllbnQgZ2V0RGVwbG95ZWRBY2NvdW50Q2xpZW50QnlBZ2VudE5hbWU6IGJ1bmRsZXJVcmwnLCBidW5kbGVyVXJsKTtcbiAgICBsZXQgd2FsbGV0Q2xpZW50O1xuICAgIGlmIChvcHRpb25zPy53YWxsZXRDbGllbnQpIHtcbiAgICAgICAgd2FsbGV0Q2xpZW50ID0gb3B0aW9ucy53YWxsZXRDbGllbnQ7XG4gICAgfVxuICAgIGVsc2UgaWYgKG9wdGlvbnM/LmV0aGVyZXVtUHJvdmlkZXIpIHtcbiAgICAgICAgd2FsbGV0Q2xpZW50ID0gY3JlYXRlV2FsbGV0Q2xpZW50KHtcbiAgICAgICAgICAgIGNoYWluOiBjaGFpbixcbiAgICAgICAgICAgIHRyYW5zcG9ydDogY3VzdG9tKG9wdGlvbnMuZXRoZXJldW1Qcm92aWRlciksXG4gICAgICAgICAgICBhY2NvdW50OiBlb2FBZGRyZXNzLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gd2FsbGV0IGNsaWVudCBmb3VuZC4gRW5zdXJlIE1ldGFNYXNrL1dlYjNBdXRoIGlzIGF2YWlsYWJsZSBvciBwYXNzIHdhbGxldENsaWVudCBpbiBvcHRpb25zLicpO1xuICAgIH1cbiAgICBsZXQgcHVibGljQ2xpZW50O1xuICAgIGlmIChvcHRpb25zPy5wdWJsaWNDbGllbnQpIHtcbiAgICAgICAgcHVibGljQ2xpZW50ID0gb3B0aW9ucy5wdWJsaWNDbGllbnQ7XG4gICAgfVxuICAgIGVsc2UgaWYgKG9wdGlvbnM/LmV0aGVyZXVtUHJvdmlkZXIpIHtcbiAgICAgICAgcHVibGljQ2xpZW50ID0gY3JlYXRlUHVibGljQ2xpZW50KHtcbiAgICAgICAgICAgIGNoYWluOiBjaGFpbixcbiAgICAgICAgICAgIHRyYW5zcG9ydDogY3VzdG9tKG9wdGlvbnM/LmV0aGVyZXVtUHJvdmlkZXIpLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gcHVibGljIGNsaWVudCBmb3VuZC4gRW5zdXJlIFJQQyBVUkwgaXMgYXZhaWxhYmxlIG9yIHBhc3MgcHVibGljQ2xpZW50IGluIG9wdGlvbnMuJyk7XG4gICAgfVxuICAgIGNvbnN0IHNhbHQgPSBrZWNjYWsyNTYoc3RyaW5nVG9IZXgoYWdlbnROYW1lKSk7XG4gICAgY29uc3QgY2xpZW50Q29uZmlnID0ge1xuICAgICAgICBjbGllbnQ6IHB1YmxpY0NsaWVudCxcbiAgICAgICAgaW1wbGVtZW50YXRpb246IEltcGxlbWVudGF0aW9uLkh5YnJpZCxcbiAgICAgICAgc2lnbmVyOiB7XG4gICAgICAgICAgICB3YWxsZXRDbGllbnQsXG4gICAgICAgIH0sXG4gICAgICAgIGRlcGxveVBhcmFtczogW2VvYUFkZHJlc3MsIFtdLCBbXSwgW11dLFxuICAgICAgICBkZXBsb3lTYWx0OiBzYWx0LFxuICAgIH07XG4gICAgbGV0IGNvdW50ZXJmYWN0dWFsQWNjb3VudENsaWVudCA9IGF3YWl0IHRvTWV0YU1hc2tTbWFydEFjY291bnQoY2xpZW50Q29uZmlnKTtcbiAgICAvLyBDaGVjayBkZXBsb3ltZW50IHN0YXR1cyB3aXRoIHByb3ZpZGVkIHB1YmxpY0NsaWVudCwgdGhlbiBmYWxsIGJhY2sgdG8gSFRUUCBSUEMgaWYgYXZhaWxhYmxlXG4gICAgbGV0IGlzRGVwbG95ZWQgPSBmYWxzZTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBjb2RlID0gYXdhaXQgcHVibGljQ2xpZW50LmdldEJ5dGVjb2RlKHsgYWRkcmVzczogY291bnRlcmZhY3R1YWxBY2NvdW50Q2xpZW50LmFkZHJlc3MgfSk7XG4gICAgICAgIGlzRGVwbG95ZWQgPSAhIWNvZGUgJiYgY29kZSAhPT0gXCIweFwiO1xuICAgIH1cbiAgICBjYXRjaCB7IH1cbiAgICBpZiAoIWlzRGVwbG95ZWQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJwY1VybCA9IGdldENoYWluUnBjVXJsKGNoYWluLmlkKTtcbiAgICAgICAgICAgIGNvbnNvbGUuaW5mbygnKioqKioqKioqKiogYWNjb3VudENsaWVudCBnZXREZXBsb3llZEFjY291bnRDbGllbnRCeUFnZW50TmFtZTogY2hlY2tpbmcgb24gUlBDJywgcnBjVXJsKTtcbiAgICAgICAgICAgIGlmIChycGNVcmwpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBodHRwQ2xpZW50ID0gY3JlYXRlUHVibGljQ2xpZW50KHsgY2hhaW46IGNoYWluLCB0cmFuc3BvcnQ6IGh0dHAocnBjVXJsKSB9KTtcbiAgICAgICAgICAgICAgICBjb25zdCBjb2RlSHR0cCA9IGF3YWl0IGh0dHBDbGllbnQuZ2V0Qnl0ZWNvZGUoeyBhZGRyZXNzOiBjb3VudGVyZmFjdHVhbEFjY291bnRDbGllbnQuYWRkcmVzcyB9KTtcbiAgICAgICAgICAgICAgICBpc0RlcGxveWVkID0gISFjb2RlSHR0cCAmJiBjb2RlSHR0cCAhPT0gXCIweFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIHsgfVxuICAgIH1cbiAgICBjb25zb2xlLmluZm8oJyoqKioqKioqKioqIGFjY291bnRDbGllbnQgZ2V0RGVwbG95ZWRBY2NvdW50Q2xpZW50QnlBZ2VudE5hbWU6IGlzRGVwbG95ZWQnLCBpc0RlcGxveWVkKTtcbiAgICBpZiAoIWlzRGVwbG95ZWQgJiYgYnVuZGxlclVybCkge1xuICAgICAgICBjb25zb2xlLmluZm8oJyoqKioqKioqKioqIGFjY291bnRDbGllbnQgZ2V0RGVwbG95ZWRBY2NvdW50Q2xpZW50QnlBZ2VudE5hbWU6IGRlcGxveWluZyB2aWEgYnVuZGxlcicpO1xuICAgICAgICBjb25zdCBwaW1saWNvID0gYXdhaXQgZ2V0UGltbGljb0NsaWVudChidW5kbGVyVXJsKTtcbiAgICAgICAgY29uc3QgYnVuZGxlckNsaWVudCA9IGNyZWF0ZUJ1bmRsZXJDbGllbnQoe1xuICAgICAgICAgICAgdHJhbnNwb3J0OiBodHRwKGJ1bmRsZXJVcmwpLFxuICAgICAgICAgICAgcGF5bWFzdGVyOiB0cnVlLFxuICAgICAgICAgICAgY2hhaW46IGNoYWluLFxuICAgICAgICAgICAgcGF5bWFzdGVyQ29udGV4dDogeyBtb2RlOiAnU1BPTlNPUkVEJyB9LFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgeyBmYXN0OiBmZWUgfSA9IGF3YWl0IHBpbWxpY28uZ2V0VXNlck9wZXJhdGlvbkdhc1ByaWNlKCk7XG4gICAgICAgIGNvbnNvbGUuaW5mbygnKioqKioqKioqKiogYWNjb3VudENsaWVudCBnZXREZXBsb3llZEFjY291bnRDbGllbnRCeUFnZW50TmFtZTogZ2FzIHByaWNlJywgZmVlKTtcbiAgICAgICAgY29uc3QgdXNlck9wZXJhdGlvbkhhc2ggPSBhd2FpdCBidW5kbGVyQ2xpZW50LnNlbmRVc2VyT3BlcmF0aW9uKHtcbiAgICAgICAgICAgIGFjY291bnQ6IGNvdW50ZXJmYWN0dWFsQWNjb3VudENsaWVudCxcbiAgICAgICAgICAgIGNhbGxzOiBbeyB0bzogemVyb0FkZHJlc3MgfV0sXG4gICAgICAgICAgICAuLi5mZWUsXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zb2xlLmluZm8oJyoqKioqKioqKioqIGFjY291bnRDbGllbnQgZ2V0RGVwbG95ZWRBY2NvdW50Q2xpZW50QnlBZ2VudE5hbWU6IHVzZXJPcGVyYXRpb25IYXNoJywgdXNlck9wZXJhdGlvbkhhc2gpO1xuICAgICAgICBhd2FpdCBidW5kbGVyQ2xpZW50LndhaXRGb3JVc2VyT3BlcmF0aW9uUmVjZWlwdCh7IGhhc2g6IHVzZXJPcGVyYXRpb25IYXNoIH0pO1xuICAgICAgICAvLyBBZnRlciBkZXBsb3ltZW50LCBtYXJrIGFzIGRlcGxveWVkIHNvIHdlIHJlYnVpbGQgYmVsb3dcbiAgICAgICAgaXNEZXBsb3llZCA9IHRydWU7XG4gICAgfVxuICAgIGlmIChpc0RlcGxveWVkKSB7XG4gICAgICAgIC8vIFJlYnVpbGQgYSBcImNsZWFuXCIgc21hcnQgYWNjb3VudCBjbGllbnQgd2l0aCBhZGRyZXNzIG9ubHkgKG5vIGZhY3RvcnkvZGVwbG95IHBhcmFtcylcbiAgICAgICAgLy8gdXNpbmcgYW4gSFRUUCBwdWJsaWMgY2xpZW50IHRvIGF2b2lkIHByb3ZpZGVyIHF1aXJrcy5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJwY1VybCA9IGdldENoYWluUnBjVXJsKGNoYWluLmlkKTtcbiAgICAgICAgICAgIGNvbnN0IGh0dHBDbGllbnQgPSBjcmVhdGVQdWJsaWNDbGllbnQoeyBjaGFpbjogY2hhaW4sIHRyYW5zcG9ydDogaHR0cChycGNVcmwpIH0pO1xuICAgICAgICAgICAgY29uc29sZS5pbmZvKCcqKioqKioqKioqKiBhY2NvdW50Q2xpZW50IGdldERlcGxveWVkQWNjb3VudENsaWVudEJ5QWdlbnROYW1lOiByZWJ1aWxkaW5nIGRlcGxveWVkIGFjY291bnQgY2xpZW50IChhZGRyZXNzLW9ubHkpJyk7XG4gICAgICAgICAgICBjb25zdCBkZXBsb3llZEFjY291bnRDbGllbnQgPSBhd2FpdCB0b01ldGFNYXNrU21hcnRBY2NvdW50KHtcbiAgICAgICAgICAgICAgICBjbGllbnQ6IGh0dHBDbGllbnQsXG4gICAgICAgICAgICAgICAgaW1wbGVtZW50YXRpb246IEltcGxlbWVudGF0aW9uLkh5YnJpZCxcbiAgICAgICAgICAgICAgICBzaWduZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgd2FsbGV0Q2xpZW50OiB3YWxsZXRDbGllbnQsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBhZGRyZXNzOiBjb3VudGVyZmFjdHVhbEFjY291bnRDbGllbnQuYWRkcmVzcyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc29sZS5pbmZvKCcqKioqKioqKioqKiBhY2NvdW50Q2xpZW50IGdldERlcGxveWVkQWNjb3VudENsaWVudEJ5QWdlbnROYW1lOiBhZ2VudEFjY291bnRDbGllbnQnLCBkZXBsb3llZEFjY291bnRDbGllbnQuYWRkcmVzcyk7XG4gICAgICAgICAgICByZXR1cm4gZGVwbG95ZWRBY2NvdW50Q2xpZW50O1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChyZWJ1aWxkRXJyKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJyoqKioqKioqKioqIGFjY291bnRDbGllbnQgZ2V0RGVwbG95ZWRBY2NvdW50Q2xpZW50QnlBZ2VudE5hbWU6IHJlYnVpbGQgZmFpbGVkLCBmYWxsaW5nIGJhY2sgdG8gZXhpc3RpbmcgY2xpZW50JywgcmVidWlsZEVycik7XG4gICAgICAgICAgICByZXR1cm4gY291bnRlcmZhY3R1YWxBY2NvdW50Q2xpZW50O1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnNvbGUuaW5mbygnKioqKioqKioqKiogYWNjb3VudENsaWVudCBnZXREZXBsb3llZEFjY291bnRDbGllbnRCeUFnZW50TmFtZTogYWdlbnRBY2NvdW50Q2xpZW50JywgY291bnRlcmZhY3R1YWxBY2NvdW50Q2xpZW50LmFkZHJlc3MpO1xuICAgIHJldHVybiBjb3VudGVyZmFjdHVhbEFjY291bnRDbGllbnQ7XG59XG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBCdW5kbGVyIFV0aWxpdGllc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gRHluYW1pYyBpbXBvcnQgZm9yIHBlcm1pc3Npb25sZXNzIChvcHRpb25hbCBkZXBlbmRlbmN5KVxuYXN5bmMgZnVuY3Rpb24gZ2V0UGltbGljb0NsaWVudChidW5kbGVyVXJsKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZSAtIHBlcm1pc3Npb25sZXNzIGlzIGFuIG9wdGlvbmFsIGRlcGVuZGVuY3lcbiAgICAgICAgY29uc3QgeyBjcmVhdGVQaW1saWNvQ2xpZW50IH0gPSBhd2FpdCBpbXBvcnQoJ3Blcm1pc3Npb25sZXNzL2NsaWVudHMvcGltbGljbycpO1xuICAgICAgICByZXR1cm4gY3JlYXRlUGltbGljb0NsaWVudCh7IHRyYW5zcG9ydDogaHR0cChidW5kbGVyVXJsKSB9KTtcbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcigncGVybWlzc2lvbmxlc3MgcGFja2FnZSBub3QgaW5zdGFsbGVkLiBJbnN0YWxsIGl0IHdpdGg6IHBucG0gYWRkIHBlcm1pc3Npb25sZXNzICcgK1xuICAgICAgICAgICAgYEVycm9yOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApO1xuICAgIH1cbn1cbi8qKlxuICogU2VuZCBhIHNwb25zb3JlZCBVc2VyT3BlcmF0aW9uIHZpYSBidW5kbGVyXG4gKlxuICogQHBhcmFtIHBhcmFtcyAtIFVzZXJPcGVyYXRpb24gcGFyYW1ldGVyc1xuICogQHJldHVybnMgVXNlck9wZXJhdGlvbiBoYXNoXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZW5kU3BvbnNvcmVkVXNlck9wZXJhdGlvbihwYXJhbXMpIHtcbiAgICBjb25zdCB7IGJ1bmRsZXJVcmwsIGNoYWluLCBhY2NvdW50Q2xpZW50LCBjYWxscyB9ID0gcGFyYW1zO1xuICAgIGNvbnN0IHBpbWxpY29DbGllbnQgPSBhd2FpdCBnZXRQaW1saWNvQ2xpZW50KGJ1bmRsZXJVcmwpO1xuICAgIGNvbnN0IGJ1bmRsZXJDbGllbnQgPSBjcmVhdGVCdW5kbGVyQ2xpZW50KHtcbiAgICAgICAgdHJhbnNwb3J0OiBodHRwKGJ1bmRsZXJVcmwpLFxuICAgICAgICBwYXltYXN0ZXI6IHRydWUsXG4gICAgICAgIGNoYWluOiBjaGFpbixcbiAgICAgICAgcGF5bWFzdGVyQ29udGV4dDogeyBtb2RlOiAnU1BPTlNPUkVEJyB9XG4gICAgfSk7XG4gICAgY29uc3QgeyBmYXN0OiBmZWUgfSA9IGF3YWl0IHBpbWxpY29DbGllbnQuZ2V0VXNlck9wZXJhdGlvbkdhc1ByaWNlKCk7XG4gICAgY29uc3QgdXNlck9wSGFzaCA9IGF3YWl0IGJ1bmRsZXJDbGllbnQuc2VuZFVzZXJPcGVyYXRpb24oe1xuICAgICAgICBhY2NvdW50OiBhY2NvdW50Q2xpZW50LFxuICAgICAgICBjYWxscyxcbiAgICAgICAgLi4uZmVlXG4gICAgfSk7XG4gICAgcmV0dXJuIHVzZXJPcEhhc2g7XG59XG4vKipcbiAqIFdhaXQgZm9yIFVzZXJPcGVyYXRpb24gcmVjZWlwdFxuICpcbiAqIEBwYXJhbSBwYXJhbXMgLSBSZWNlaXB0IHBhcmFtZXRlcnNcbiAqIEByZXR1cm5zIFVzZXJPcGVyYXRpb24gcmVjZWlwdFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gd2FpdEZvclVzZXJPcGVyYXRpb25SZWNlaXB0KHBhcmFtcykge1xuICAgIGNvbnN0IHsgYnVuZGxlclVybCwgY2hhaW4sIGhhc2ggfSA9IHBhcmFtcztcbiAgICBjb25zdCBidW5kbGVyQ2xpZW50ID0gY3JlYXRlQnVuZGxlckNsaWVudCh7XG4gICAgICAgIHRyYW5zcG9ydDogaHR0cChidW5kbGVyVXJsKSxcbiAgICAgICAgcGF5bWFzdGVyOiB0cnVlLFxuICAgICAgICBjaGFpbjogY2hhaW4sXG4gICAgICAgIHBheW1hc3RlckNvbnRleHQ6IHsgbW9kZTogJ1NQT05TT1JFRCcgfVxuICAgIH0pO1xuICAgIHJldHVybiBhd2FpdCBidW5kbGVyQ2xpZW50LndhaXRGb3JVc2VyT3BlcmF0aW9uUmVjZWlwdCh7IGhhc2ggfSk7XG59XG4vKipcbiAqIERlcGxveSBzbWFydCBhY2NvdW50IGlmIG5lZWRlZFxuICpcbiAqIEBwYXJhbSBwYXJhbXMgLSBEZXBsb3ltZW50IHBhcmFtZXRlcnNcbiAqIEByZXR1cm5zIHRydWUgaWYgYWNjb3VudCB3YXMgZGVwbG95ZWQsIGZhbHNlIGlmIGFscmVhZHkgZGVwbG95ZWRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlcGxveVNtYXJ0QWNjb3VudElmTmVlZGVkKHBhcmFtcykge1xuICAgIGNvbnN0IHsgYnVuZGxlclVybCwgY2hhaW4sIGFjY291bnQgfSA9IHBhcmFtcztcbiAgICBjb25zdCBpc0RlcGxveWVkID0gYXdhaXQgYWNjb3VudC5pc0RlcGxveWVkKCk7XG4gICAgaWYgKGlzRGVwbG95ZWQpXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICBjb25zdCBwaW1saWNvID0gYXdhaXQgZ2V0UGltbGljb0NsaWVudChidW5kbGVyVXJsKTtcbiAgICBjb25zdCBidW5kbGVyQ2xpZW50ID0gY3JlYXRlQnVuZGxlckNsaWVudCh7XG4gICAgICAgIHRyYW5zcG9ydDogaHR0cChidW5kbGVyVXJsKSxcbiAgICAgICAgcGF5bWFzdGVyOiB0cnVlLFxuICAgICAgICBjaGFpbjogY2hhaW4sXG4gICAgICAgIHBheW1hc3RlckNvbnRleHQ6IHsgbW9kZTogJ1NQT05TT1JFRCcgfVxuICAgIH0pO1xuICAgIGNvbnN0IHsgZmFzdCB9ID0gYXdhaXQgcGltbGljby5nZXRVc2VyT3BlcmF0aW9uR2FzUHJpY2UoKTtcbiAgICBjb25zdCB1c2VyT3BlcmF0aW9uSGFzaCA9IGF3YWl0IGJ1bmRsZXJDbGllbnQuc2VuZFVzZXJPcGVyYXRpb24oe1xuICAgICAgICBhY2NvdW50LFxuICAgICAgICBjYWxsczogW3sgdG86IHplcm9BZGRyZXNzIH1dLFxuICAgICAgICAuLi5mYXN0XG4gICAgfSk7XG4gICAgYXdhaXQgYnVuZGxlckNsaWVudC53YWl0Rm9yVXNlck9wZXJhdGlvblJlY2VpcHQoeyBoYXNoOiB1c2VyT3BlcmF0aW9uSGFzaCB9KTtcbiAgICByZXR1cm4gdHJ1ZTtcbn1cbi8qKlxuICogQ2hlY2sgaWYgYW4gYWRkcmVzcyBpcyBhIHNtYXJ0IGNvbnRyYWN0IChoYXMgY29kZSlcbiAqXG4gKiBAcGFyYW0gcHVibGljQ2xpZW50IC0gVmllbSBwdWJsaWMgY2xpZW50XG4gKiBAcGFyYW0gYWRkcmVzcyAtIEFkZHJlc3MgdG8gY2hlY2tcbiAqIEByZXR1cm5zIHRydWUgaWYgYWRkcmVzcyBoYXMgY29kZSAoaXMgYSBjb250cmFjdCksIGZhbHNlIGlmIEVPQVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaXNTbWFydENvbnRyYWN0KHB1YmxpY0NsaWVudCwgYWRkcmVzcykge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGNvZGUgPSBhd2FpdCBwdWJsaWNDbGllbnQuZ2V0Qnl0ZWNvZGUoeyBhZGRyZXNzIH0pO1xuICAgICAgICByZXR1cm4gY29kZSAhPT0gdW5kZWZpbmVkICYmIGNvZGUgIT09ICcweCc7XG4gICAgfVxuICAgIGNhdGNoIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFjY291bnRDbGllbnQuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/../../node_modules/.pnpm/@agentic-trust+core@1.0.17_@veramo+core@6.0.0_bufferutil@4.0.9_encoding@0.1.13_graphql@16.12._bnyldtxzb6pv7ivr5y6a3orzga/node_modules/@agentic-trust/core/dist/client/accountClient.js\n");

/***/ }),

/***/ "(ssr)/../../node_modules/.pnpm/@agentic-trust+core@1.0.17_@veramo+core@6.0.0_bufferutil@4.0.9_encoding@0.1.13_graphql@16.12._bnyldtxzb6pv7ivr5y6a3orzga/node_modules/@agentic-trust/core/dist/client/walletSigning.js":
/*!***********************************************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/@agentic-trust+core@1.0.17_@veramo+core@6.0.0_bufferutil@4.0.9_encoding@0.1.13_graphql@16.12._bnyldtxzb6pv7ivr5y6a3orzga/node_modules/@agentic-trust/core/dist/client/walletSigning.js ***!
  \***********************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAgentWithWalletForAA: () => (/* binding */ createAgentWithWalletForAA),\n/* harmony export */   createAgentWithWalletForEOA: () => (/* binding */ createAgentWithWalletForEOA),\n/* harmony export */   extractAgentIdFromReceipt: () => (/* binding */ extractAgentIdFromReceipt),\n/* harmony export */   getCounterfactualAAAddressByAgentName: () => (/* reexport safe */ _accountClient__WEBPACK_IMPORTED_MODULE_1__.getCounterfactualAAAddressByAgentName),\n/* harmony export */   getCounterfactualAccountClientByAgentName: () => (/* reexport safe */ _accountClient__WEBPACK_IMPORTED_MODULE_1__.getCounterfactualAccountClientByAgentName),\n/* harmony export */   getDeployedAccountClientByAgentName: () => (/* reexport safe */ _accountClient__WEBPACK_IMPORTED_MODULE_1__.getDeployedAccountClientByAgentName),\n/* harmony export */   getWalletAddress: () => (/* binding */ getWalletAddress),\n/* harmony export */   isWalletProviderAvailable: () => (/* binding */ isWalletProviderAvailable),\n/* harmony export */   refreshAgentInIndexer: () => (/* binding */ refreshAgentInIndexer),\n/* harmony export */   signAndSendTransaction: () => (/* binding */ signAndSendTransaction)\n/* harmony export */ });\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! viem */ \"(ssr)/../../node_modules/.pnpm/viem@2.39.3_bufferutil@4.0.9_typescript@5.9.3_utf-8-validate@5.0.10/node_modules/viem/_esm/clients/createWalletClient.js\");\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! viem */ \"(ssr)/../../node_modules/.pnpm/viem@2.39.3_bufferutil@4.0.9_typescript@5.9.3_utf-8-validate@5.0.10/node_modules/viem/_esm/clients/transports/custom.js\");\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! viem */ \"(ssr)/../../node_modules/.pnpm/viem@2.39.3_bufferutil@4.0.9_typescript@5.9.3_utf-8-validate@5.0.10/node_modules/viem/_esm/clients/createPublicClient.js\");\n/* harmony import */ var _server_lib_chainConfig__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../server/lib/chainConfig */ \"(ssr)/../../node_modules/.pnpm/@agentic-trust+core@1.0.17_@veramo+core@6.0.0_bufferutil@4.0.9_encoding@0.1.13_graphql@16.12._bnyldtxzb6pv7ivr5y6a3orzga/node_modules/@agentic-trust/core/dist/server/lib/chainConfig.js\");\n/* harmony import */ var _accountClient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./accountClient */ \"(ssr)/../../node_modules/.pnpm/@agentic-trust+core@1.0.17_@veramo+core@6.0.0_bufferutil@4.0.9_encoding@0.1.13_graphql@16.12._bnyldtxzb6pv7ivr5y6a3orzga/node_modules/@agentic-trust/core/dist/client/accountClient.js\");\n/**\n * Client-side wallet signing utilities\n *\n * Handles MetaMask/EIP-1193 wallet integration for signing and sending transactions\n * All Ethereum logic is handled server-side, client only needs to sign and send\n */\n\n\n\n\nfunction resolveEthereumProvider(providedProvider) {\n    if (providedProvider)\n        return providedProvider;\n    if (typeof window !== 'undefined') {\n        const web3authProvider = window?.web3auth?.provider;\n        if (web3authProvider)\n            return web3authProvider;\n        const injected = window.ethereum;\n        if (injected)\n            return injected;\n    }\n    return null;\n}\nasync function resolveChainId(ethereumProvider) {\n    try {\n        const chainHex = await ethereumProvider.request?.({\n            method: 'eth_chainId',\n        });\n        if (typeof chainHex === 'string') {\n            return parseInt(chainHex, 16);\n        }\n    }\n    catch {\n        // ignore; fallback below\n    }\n    // Fallback to default chain id\n    return _server_lib_chainConfig__WEBPACK_IMPORTED_MODULE_0__.DEFAULT_CHAIN_ID;\n}\n/**\n * Ensure the provider has an authorized account and return it.\n * Tries eth_accounts first; if empty, requests eth_requestAccounts.\n */\nasync function ensureAuthorizedAccount(ethereumProvider) {\n    try {\n        const existing = await ethereumProvider.request({ method: 'eth_accounts' });\n        if (Array.isArray(existing) && existing.length > 0) {\n            return existing[0];\n        }\n    }\n    catch {\n        // ignore and fall through to request\n    }\n    try {\n        const granted = await ethereumProvider.request({\n            method: 'eth_requestAccounts',\n        });\n        if (Array.isArray(granted) && granted.length > 0) {\n            return granted[0];\n        }\n    }\n    catch {\n        // fallthrough to permissions flow\n    }\n    try {\n        await ethereumProvider.request?.({\n            method: 'wallet_requestPermissions',\n            params: [{ eth_accounts: {} }],\n        });\n        const afterPerm = await ethereumProvider.request({\n            method: 'eth_accounts',\n        });\n        if (Array.isArray(afterPerm) && afterPerm.length > 0) {\n            return afterPerm[0];\n        }\n    }\n    catch {\n        // ignore\n    }\n    throw new Error('Wallet not authorized. Please connect your wallet.');\n}\nasync function ensureChainSelected(ethereumProvider, chain) {\n    try {\n        const currentHex = await ethereumProvider.request?.({\n            method: 'eth_chainId',\n        });\n        const current = typeof currentHex === 'string' ? parseInt(currentHex, 16) : undefined;\n        if (current === chain.id)\n            return;\n    }\n    catch {\n        // continue to switch\n    }\n    const hexId = `0x${chain.id.toString(16)}`;\n    try {\n        await ethereumProvider.request?.({\n            method: 'wallet_switchEthereumChain',\n            params: [{ chainId: hexId }],\n        });\n        return;\n    }\n    catch (switchErr) {\n        // 4902 = unknown chain, try add then switch\n        if (switchErr?.code !== 4902) {\n            throw switchErr;\n        }\n    }\n    // Try to add chain using centralized configuration\n    const chainConfig = (0,_server_lib_chainConfig__WEBPACK_IMPORTED_MODULE_0__.getChainById)(chain.id);\n    const addParams = {\n        chainId: hexId,\n        chainName: chainConfig.name,\n        nativeCurrency: {\n            name: 'ETH',\n            symbol: 'ETH',\n            decimals: 18,\n        },\n        rpcUrls: [(0,_server_lib_chainConfig__WEBPACK_IMPORTED_MODULE_0__.getChainRpcUrl)(chain.id)],\n        blockExplorerUrls: chainConfig.blockExplorers?.default\n            ? [chainConfig.blockExplorers.default.url]\n            : [],\n    };\n    await ethereumProvider.request?.({\n        method: 'wallet_addEthereumChain',\n        params: [addParams],\n    });\n    await ethereumProvider.request?.({\n        method: 'wallet_switchEthereumChain',\n        params: [{ chainId: hexId }],\n    });\n}\n/**\n * Sign and send a transaction using MetaMask/EIP-1193 wallet\n *\n * @param options - Signing options including transaction, account, chain, and provider\n * @returns Transaction hash, receipt, and optionally extracted agentId\n */\nasync function signAndSendTransaction(options) {\n    const { transaction, account, chain, ethereumProvider, onStatusUpdate, extractAgentId = false, } = options;\n    // Get wallet provider\n    const provider = resolveEthereumProvider(ethereumProvider);\n    if (!provider) {\n        throw new Error('No wallet provider found. Please connect MetaMask or use an EIP-1193 compatible wallet.');\n    }\n    // Update status\n    onStatusUpdate?.('Connecting to wallet...');\n    // Create wallet client\n    try {\n        // Ensure correct chain & account permission before sending\n        await ensureChainSelected(provider, chain);\n        await ensureAuthorizedAccount(provider);\n    }\n    catch {\n        // Non-fatal; some providers may not require this here\n    }\n    const walletClient = (0,viem__WEBPACK_IMPORTED_MODULE_2__.createWalletClient)({\n        account,\n        chain,\n        transport: (0,viem__WEBPACK_IMPORTED_MODULE_3__.custom)(provider),\n    });\n    // Update status\n    onStatusUpdate?.('Transaction prepared. Please confirm in your wallet...');\n    // Convert hex strings to bigint for Viem (Viem accepts both, but TypeScript is strict)\n    const txParams = {\n        ...transaction,\n        value: BigInt(transaction.value),\n    };\n    if (transaction.gas) {\n        txParams.gas = BigInt(transaction.gas);\n    }\n    if (transaction.gasPrice) {\n        txParams.gasPrice = BigInt(transaction.gasPrice);\n    }\n    if (transaction.maxFeePerGas) {\n        txParams.maxFeePerGas = BigInt(transaction.maxFeePerGas);\n    }\n    if (transaction.maxPriorityFeePerGas) {\n        txParams.maxPriorityFeePerGas = BigInt(transaction.maxPriorityFeePerGas);\n    }\n    // Sign and send transaction\n    const hash = await walletClient.sendTransaction(txParams);\n    // Update status\n    onStatusUpdate?.(`Transaction submitted! Hash: ${hash}. Waiting for confirmation...`);\n    // Wait for transaction receipt\n    const publicClient = (0,viem__WEBPACK_IMPORTED_MODULE_4__.createPublicClient)({\n        chain,\n        transport: (0,viem__WEBPACK_IMPORTED_MODULE_3__.custom)(ethereumProvider),\n    });\n    const receipt = await publicClient.waitForTransactionReceipt({ hash });\n    // Extract agentId if requested (for agent creation transactions)\n    let agentId;\n    if (receipt && Array.isArray(receipt.logs)) {\n        const zeroTopic = '0x0000000000000000000000000000000000000000000000000000000000000000';\n        const transferTopic = '0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef';\n        const mintLog = receipt.logs.find((log) => log?.topics?.[0] === transferTopic &&\n            (log?.topics?.[1] === zeroTopic || log?.topics?.[1] === undefined));\n        if (mintLog) {\n            const tokenTopic = mintLog.topics?.[3];\n            const tokenData = mintLog.data;\n            const tokenHex = tokenTopic ?? tokenData;\n            if (tokenHex) {\n                try {\n                    agentId = BigInt(tokenHex).toString();\n                }\n                catch (error) {\n                    console.warn('Unable to parse agentId from mint log:', error);\n                }\n            }\n        }\n    }\n    if (extractAgentId) {\n        try {\n            agentId = extractAgentIdFromReceipt(receipt);\n        }\n        catch (error) {\n            console.warn('Could not extract agentId from receipt:', error);\n        }\n    }\n    return {\n        hash,\n        receipt,\n        agentId,\n    };\n}\n/**\n * Extract agentId from a transaction receipt (for agent creation)\n * Looks for ERC-721 Transfer event from zero address\n *\n * @param receipt - Transaction receipt\n * @returns Extracted agentId as string, or undefined if not found\n */\nfunction extractAgentIdFromReceipt(receipt) {\n    try {\n        // ERC-721 Transfer event signature\n        const transferTopic = '0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef';\n        // Zero address topic (from address)\n        const zeroAddress = '0x0000000000000000000000000000000000000000000000000000000000000000';\n        if (!receipt.logs || !Array.isArray(receipt.logs)) {\n            return undefined;\n        }\n        for (const log of receipt.logs) {\n            if (log.topics &&\n                log.topics[0] === transferTopic &&\n                log.topics[1] === zeroAddress) {\n                // Extract tokenId (agentId) from topics[3]\n                if (log.topics[3]) {\n                    return BigInt(log.topics[3]).toString();\n                }\n            }\n        }\n        return undefined;\n    }\n    catch (error) {\n        console.warn('Error extracting agentId from receipt:', error);\n        return undefined;\n    }\n}\n/**\n * Refresh agent in GraphQL indexer\n *\n * @param agentId - Agent ID to refresh\n * @param chainId - Chain ID for the agent\n * @param refreshEndpoint - Optional custom refresh endpoint (defaults to `/api/agents/<did>/refresh`)\n * @returns Promise that resolves when refresh is complete\n */\nasync function refreshAgentInIndexer(agentId, chainId, refreshEndpoint) {\n    const chainIdStr = typeof chainId === 'number' ? chainId.toString(10) : chainId?.toString() ?? '';\n    if (!chainIdStr.trim()) {\n        throw new Error('Chain ID is required to refresh agent in indexer');\n    }\n    const did = encodeURIComponent(`did:8004:${chainIdStr.trim()}:${agentId}`);\n    const endpoint = refreshEndpoint || `/api/agents/${did}/refresh`;\n    try {\n        const response = await fetch(endpoint, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({}), // Send empty body to avoid JSON parsing errors\n        });\n        if (!response.ok) {\n            const errorText = await response.text();\n            console.warn(`Failed to refresh agent ${agentId} in GraphQL indexer: ${response.status} ${response.statusText}`, errorText);\n            return;\n        }\n        // Try to parse response, but don't fail if it's empty\n        try {\n            const data = await response.json();\n            console.log(` Refreshed agent ${agentId} in GraphQL indexer`, data);\n        }\n        catch (parseError) {\n            // Response might be empty, that's okay\n            console.log(` Refreshed agent ${agentId} in GraphQL indexer`);\n        }\n    }\n    catch (error) {\n        console.warn(`Error refreshing agent ${agentId} in GraphQL indexer:`, error);\n    }\n}\n/**\n * Check if wallet provider is available\n *\n * @param ethereumProvider - Optional provider (defaults to window.ethereum)\n * @returns true if provider is available\n */\nfunction isWalletProviderAvailable(ethereumProvider) {\n    if (ethereumProvider) {\n        return true;\n    }\n    if (typeof window === 'undefined') {\n        return false;\n    }\n    return !!window.ethereum;\n}\n/**\n * Get the connected wallet address from provider\n *\n * @param ethereumProvider - Optional provider (defaults to window.ethereum)\n * @returns Connected wallet address, or null if not connected\n */\nasync function getWalletAddress(ethereumProvider) {\n    const provider = ethereumProvider ||\n        (typeof window !== 'undefined' ? window.ethereum : null);\n    if (!provider) {\n        return null;\n    }\n    try {\n        const accounts = await provider.request({ method: 'eth_accounts' });\n        if (accounts && accounts.length > 0) {\n            return accounts[0];\n        }\n        return null;\n    }\n    catch (error) {\n        console.warn('Error getting wallet address:', error);\n        return null;\n    }\n}\n/**\n * Create an agent with automatic wallet signing if needed\n *\n * This method handles the entire flow:\n * 1. Calls the API to create agent (endpoint: /api/agents/create-for-eoa)\n * 2. If client-side signing is required, signs and sends transaction\n * 3. Waits for receipt and extracts agentId\n * 4. Refreshes GraphQL indexer\n *\n * Only agentData is required - account, chain, and provider are auto-detected\n *\n * @param options - Creation options (only agentData required)\n * @returns Agent creation result\n */\nasync function createAgentWithWalletForEOA(options) {\n    const { agentData, account: providedAccount, ethereumProvider: providedProvider, rpcUrl: providedRpcUrl, onStatusUpdate, chainId: requestedChainId, } = options;\n    // Get wallet provider (default to window.ethereum)\n    const ethereumProvider = providedProvider ||\n        (typeof window !== 'undefined' ? window.ethereum : null);\n    if (!ethereumProvider) {\n        throw new Error('No wallet provider found. Please connect MetaMask or use an EIP-1193 compatible wallet.');\n    }\n    // Get account from provider if not provided\n    let account;\n    if (providedAccount) {\n        account = providedAccount;\n    }\n    else {\n        account = await ensureAuthorizedAccount(ethereumProvider);\n    }\n    // Step 1: Call API to create agent\n    onStatusUpdate?.('Creating agent...');\n    // Prepare request body with AA parameters if needed\n    const requestBody = {\n        ...agentData,\n        chainId: requestedChainId,\n    };\n    const response = await fetch('/api/agents/create-for-eoa', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(requestBody),\n    });\n    if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.message || errorData.error || 'Failed to create agent');\n    }\n    const data = await response.json();\n    // Step 2: Check if client-side signing is required (regular EOA transaction)\n    if (data.requiresClientSigning && data.transaction) {\n        // Get chain from transaction chainId\n        const chainId = data.transaction.chainId;\n        const chain = (0,_server_lib_chainConfig__WEBPACK_IMPORTED_MODULE_0__.getChainById)(chainId);\n        // Sign and send transaction\n        const result = await signAndSendTransaction({\n            transaction: data.transaction,\n            account,\n            chain,\n            ethereumProvider,\n            onStatusUpdate,\n            extractAgentId: true, // Extract agentId for agent creation\n        });\n        // Step 3: Refresh GraphQL indexer if agentId was extracted\n        if (result.agentId) {\n            await refreshAgentInIndexer(result.agentId, chainId);\n        }\n        return {\n            agentId: result.agentId,\n            txHash: result.hash,\n            requiresClientSigning: true,\n        };\n    }\n    else {\n        // Server-side signed transaction\n        // Ensure we have the required fields\n        if (!data.agentId || !data.txHash) {\n            throw new Error(`Invalid response from create agent API. Expected agentId and txHash, got: ${JSON.stringify(data)}`);\n        }\n        const agentIdStr = data.agentId.toString();\n        // Refresh GraphQL indexer for server-side signed transactions too\n        if (agentIdStr) {\n            try {\n                const fallbackChainId = typeof requestedChainId === 'number' && Number.isFinite(requestedChainId)\n                    ? requestedChainId\n                    : _server_lib_chainConfig__WEBPACK_IMPORTED_MODULE_0__.DEFAULT_CHAIN_ID;\n                await refreshAgentInIndexer(agentIdStr, fallbackChainId);\n            }\n            catch (error) {\n                // Don't fail the whole operation if refresh fails\n                console.warn('Failed to refresh agent in indexer:', error);\n            }\n        }\n        return {\n            agentId: agentIdStr,\n            txHash: data.txHash,\n            requiresClientSigning: false,\n        };\n    }\n}\nasync function createAgentWithWalletForAA(options) {\n    const { agentData, account: providedAccount, ethereumProvider: providedProvider, rpcUrl: providedRpcUrl, onStatusUpdate, chainId: providedChainId, } = options;\n    // Get wallet provider (default to window.ethereum)\n    const ethereumProvider = resolveEthereumProvider(providedProvider);\n    if (!ethereumProvider) {\n        throw new Error('No wallet provider found. Please connect MetaMask or use an EIP-1193 compatible wallet.');\n    }\n    // Get account from provider if not provided\n    let account;\n    if (providedAccount) {\n        account = providedAccount;\n    }\n    else {\n        account = await ensureAuthorizedAccount(ethereumProvider);\n    }\n    const chainId = typeof providedChainId === 'number'\n        ? providedChainId\n        : await resolveChainId(ethereumProvider);\n    // Step 1: Call API to create agent\n    onStatusUpdate?.('Creating agent...');\n    // 0.  Get on the correct chain get adapter for the chain\n    let chain;\n    switch (chainId) {\n        case 11155111: // ETH Sepolia\n            chain = _server_lib_chainConfig__WEBPACK_IMPORTED_MODULE_0__.sepolia;\n            break;\n        case 84532: // Base Sepolia\n            chain = _server_lib_chainConfig__WEBPACK_IMPORTED_MODULE_0__.baseSepolia;\n            break;\n        case 11155420: // Optimism Sepolia\n            chain = _server_lib_chainConfig__WEBPACK_IMPORTED_MODULE_0__.optimismSepolia;\n            break;\n        default:\n            chain = _server_lib_chainConfig__WEBPACK_IMPORTED_MODULE_0__.sepolia;\n            console.warn(`Unknown chainId ${chainId}, defaulting to Sepolia`);\n    }\n    // Ensure provider is on the required chain before building clients\n    try {\n        await ensureChainSelected(ethereumProvider, chain);\n    }\n    catch (switchErr) {\n        console.warn('Unable to switch chain on provider for AA flow:', switchErr);\n    }\n    // Build viem clients bound to the user's Web3Auth provider\n    const viemWalletClient = (0,viem__WEBPACK_IMPORTED_MODULE_2__.createWalletClient)({\n        account,\n        chain,\n        transport: (0,viem__WEBPACK_IMPORTED_MODULE_3__.custom)(ethereumProvider),\n    });\n    const viemPublicClient = (0,viem__WEBPACK_IMPORTED_MODULE_4__.createPublicClient)({\n        chain,\n        transport: (0,viem__WEBPACK_IMPORTED_MODULE_3__.custom)(ethereumProvider),\n    });\n    // 1.  Need to create the Agent Account Abstraction (Account)\n    // Build AA account client using client's EOA (MetaMask/Web3Auth)\n    // Get agent name from request\n    //let agentFullName = options.agentData.agentName;\n    //if (options.ensOptions?.orgName) {\n    //  agentFullName = options.agentData.agentName + '.' + options.ensOptions?.orgName + \".eth\";\n    //}\n    // Get Account Client by Agent Name, find if exists and if not then create it\n    const bundlerUrl = (0,_server_lib_chainConfig__WEBPACK_IMPORTED_MODULE_0__.getChainBundlerUrl)(chainId);\n    let agentAccountClient = await (0,_accountClient__WEBPACK_IMPORTED_MODULE_1__.getDeployedAccountClientByAgentName)(bundlerUrl, options.agentData.agentName, account, {\n        chain: chain,\n        walletClient: viemWalletClient,\n        publicClient: viemPublicClient,\n    });\n    if (!agentAccountClient) {\n        throw new Error('Failed to build AA account client');\n    }\n    // Verify the address matches\n    const computedAddress = await agentAccountClient.getAddress();\n    if (computedAddress.toLowerCase() !==\n        options.agentData.agentAccount.toLowerCase()) {\n        throw new Error(`AA address mismatch: computed ${computedAddress}, expected ${options.agentData.agentAccount}`);\n    }\n    // 2.  Add ENS record associated with new agent\n    console.log('*********** createAgentWithWalletForAA: options.ensOptions', options.ensOptions);\n    if (options.ensOptions?.enabled &&\n        options.ensOptions.orgName &&\n        (0,_server_lib_chainConfig__WEBPACK_IMPORTED_MODULE_0__.isL1)(chainId)) {\n        try {\n            const ensAgentAccount = typeof computedAddress === 'string' && computedAddress.startsWith('0x')\n                ? computedAddress\n                : options.agentData.agentAccount;\n            onStatusUpdate?.('Creating ENS subdomain for agent: ' + options.agentData.agentName);\n            const pkModeDetected = (0,_server_lib_chainConfig__WEBPACK_IMPORTED_MODULE_0__.isPrivateKeyMode)();\n            console.log(\"createAgentWithWalletForAA: pkModeDetected\", pkModeDetected);\n            const addEndpoint = pkModeDetected\n                ? '/api/names/add-to-l1-org-pk'\n                : '/api/names/add-to-l1-org';\n            console.info(`[ENS][L1] ${pkModeDetected ? 'PK mode detected 11111' : 'Client mode'} - calling ${addEndpoint}`);\n            const ensResponse = await fetch(addEndpoint, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                    agentAccount: ensAgentAccount,\n                    orgName: options.ensOptions.orgName,\n                    agentName: options.agentData.agentName,\n                    agentUrl: options.agentData.agentUrl,\n                    chainId,\n                }),\n            });\n            if (!ensResponse.ok) {\n                const err = await ensResponse.json().catch(() => ({}));\n                console.warn('[ENS][L1] add-to-l1-org call failed', err);\n            }\n            else {\n                console.info('[ENS][L1] add-to-l1-org call succeeded');\n            }\n            onStatusUpdate?.('Preparing ENS metadata update...');\n            const infoEndpoint = pkModeDetected\n                ? '/api/names/set-l1-name-info-pk'\n                : '/api/names/set-l1-name-info';\n            console.info(`[ENS][L1] ${pkModeDetected ? 'PK mode detected 22222' : 'Client mode'} - calling ${infoEndpoint}`);\n            const infoResponse = await fetch(infoEndpoint, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                    agentAddress: ensAgentAccount,\n                    orgName: options.ensOptions.orgName,\n                    agentName: options.agentData.agentName,\n                    agentUrl: options.agentData.agentUrl,\n                    agentDescription: options.agentData.description,\n                    chainId,\n                }),\n            });\n            if (infoResponse.ok) {\n                console.log('*********** createAgentWithWalletForAA: ENS metadata response received');\n                const infoData = await infoResponse.json();\n                const serverInfoUserOpHash = infoData?.userOpHash;\n                if (serverInfoUserOpHash) {\n                    console.log('*********** createAgentWithWalletForAA: ENS info userOpHash (server-submitted)', serverInfoUserOpHash);\n                }\n                else {\n                    const infoCalls = [];\n                    if (Array.isArray(infoData?.calls)) {\n                        for (const rawCall of infoData.calls) {\n                            const to = rawCall?.to;\n                            const data = rawCall?.data;\n                            if (!to || !data) {\n                                continue;\n                            }\n                            let value;\n                            if (rawCall?.value !== null && rawCall?.value !== undefined) {\n                                try {\n                                    value = BigInt(rawCall.value);\n                                }\n                                catch (error) {\n                                    console.warn('Unable to parse ENS info call value', rawCall.value, error);\n                                }\n                            }\n                            infoCalls.push({\n                                to,\n                                data,\n                                value,\n                            });\n                        }\n                    }\n                    if (infoCalls.length > 0) {\n                        onStatusUpdate?.('Updating ENS agent info...');\n                        // Ensure we are using a deployed-only AA client (no factory/factoryData)\n                        //const fullAgentName = agentName + '.' + options.ensOptions.orgName + \".eth\";\n                        console.log('!!!!!!!!!!!! handleCreateAgent: getDeployedAccountClientByAgentName 2: agentName', options.agentData.agentName);\n                        agentAccountClient = await (0,_accountClient__WEBPACK_IMPORTED_MODULE_1__.getDeployedAccountClientByAgentName)(bundlerUrl, options.agentData.agentName, account, {\n                            chain: chain,\n                            walletClient: viemWalletClient,\n                            publicClient: viemPublicClient,\n                        });\n                        const infoUserOpHash = await (0,_accountClient__WEBPACK_IMPORTED_MODULE_1__.sendSponsoredUserOperation)({\n                            bundlerUrl,\n                            chain: chain,\n                            accountClient: agentAccountClient,\n                            calls: infoCalls,\n                        });\n                        await (0,_accountClient__WEBPACK_IMPORTED_MODULE_1__.waitForUserOperationReceipt)({\n                            bundlerUrl,\n                            chain: chain,\n                            hash: infoUserOpHash,\n                        });\n                    }\n                }\n            }\n            else {\n                const errorPayload = await infoResponse.json().catch(() => ({}));\n                console.warn('Failed to prepare ENS metadata calls:', errorPayload);\n            }\n            console.log('Requested ENS record creation and metadata update for agent', options.agentData.agentName);\n        }\n        catch (ensError) {\n            console.warn('Failed to create ENS record for agent:', ensError);\n        }\n    }\n    else if (options.ensOptions?.enabled &&\n        options.ensOptions.orgName &&\n        (0,_server_lib_chainConfig__WEBPACK_IMPORTED_MODULE_0__.isL2)(chainId)) {\n        const rawOrg = options.ensOptions.orgName || '';\n        const rawAgent = options.agentData.agentName || '';\n        const cleanOrgName = rawOrg.replace(/\\.eth$/i, '').toLowerCase();\n        const orgPattern = cleanOrgName.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n        const cleanAgentName = rawAgent\n            .replace(new RegExp(`^${orgPattern}\\\\.`, 'i'), '')\n            .replace(/\\.eth$/i, '')\n            .trim()\n            .toLowerCase()\n            .replace(/\\s+/g, '-');\n        const agentUrl = options.agentData.agentUrl;\n        const agentDescription = options.agentData.description;\n        const agentImage = options.agentData.image;\n        // Prepare all necessary L2 ENS calls server-side, then send them as one user operation\n        const prepareResp = await fetch('/api/names/add-to-l2-org', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                agentAddress: agentAccountClient.address,\n                orgName: cleanOrgName,\n                agentName: cleanAgentName,\n                agentUrl,\n                agentDescription,\n                agentImage,\n                chainId,\n            }),\n        });\n        if (!prepareResp.ok) {\n            const errorPayload = await prepareResp.json().catch(() => ({}));\n            console.warn('Failed to prepare L2 ENS calls:', errorPayload);\n        }\n        else {\n            const { calls: rawCalls } = await prepareResp.json();\n            const l2EnsCalls = (rawCalls || []).map((call) => ({\n                to: call.to,\n                data: call.data,\n                value: BigInt(call.value || '0'),\n            }));\n            if (l2EnsCalls.length > 0) {\n                for (const call of l2EnsCalls) {\n                    console.log('********************* send sponsored user operation for L2 ENS call');\n                    const userOpHash = await (0,_accountClient__WEBPACK_IMPORTED_MODULE_1__.sendSponsoredUserOperation)({\n                        bundlerUrl,\n                        chain,\n                        accountClient: agentAccountClient,\n                        calls: [call],\n                    });\n                    await (0,_accountClient__WEBPACK_IMPORTED_MODULE_1__.waitForUserOperationReceipt)({\n                        bundlerUrl,\n                        chain,\n                        hash: userOpHash,\n                    });\n                }\n            }\n        }\n        /*  TODO:  Need to resolve this to set ens url and description\n          onStatusUpdate?.('Set ENS metadata update...');\n          const infoResponse = await fetch('/api/names/set-l2-name-info', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n              agentAddress: agentAccountClient.address,\n              orgName: options.ensOptions.orgName,\n              agentName: options.agentData.agentName,\n              agentUrl: options.agentData.agentUrl,\n              agentDescription: options.agentData.description,\n              chainId,\n            }),\n          });\n    \n          if (!infoResponse.ok) {\n            const errorPayload = await infoResponse.json().catch(() => ({}));\n            console.warn('Failed to prepare L2 ENS calls:', errorPayload);\n          } else {\n            const { calls: rawCalls } = await infoResponse.json();\n            const l2EnsCalls = (rawCalls || []).map((call: any) => ({\n              to: call.to as `0x${string}`,\n              data: call.data as `0x${string}`,\n              value: BigInt(call.value || '0'),\n            }));\n            if (l2EnsCalls.length > 0) {\n              for (const call of l2EnsCalls) {\n                console.log('********************* send sponsored user operation for L2 ENS call');\n                const userOpHash = await sendSponsoredUserOperation({\n                  bundlerUrl,\n                  chain,\n                  accountClient: agentAccountClient,\n                  calls: [call],\n                });\n                await waitForUserOperationReceipt({\n                  bundlerUrl,\n                  chain,\n                  hash: userOpHash,\n                });\n              }\n            }\n          }\n            */\n    }\n    // 2.  Need to create the Agent Identity (NFT)\n    console.log('*********** createAgentWithWalletForAA: creating agent identity...');\n    const finalAgentName = options.ensOptions?.enabled && options.ensOptions?.orgName\n        ? `${options.agentData.agentName}.${options.ensOptions?.orgName}.eth`\n        : options.agentData.agentName;\n    agentData.agentName = finalAgentName;\n    // Prepare request body with AA parameters if needed\n    const requestBody = {\n        account: computedAddress,\n        ...agentData,\n        chainId,\n    };\n    const response = await fetch('/api/agents/create-for-aa', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(requestBody),\n    });\n    if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.message || errorData.error || 'Failed to create agent');\n    }\n    const data = await response.json();\n    if (!Array.isArray(data.calls) || data.calls.length === 0) {\n        throw new Error('Agent creation response missing register calls');\n    }\n    // Construct Agent Identity with agentAccount Client\n    const createAgentIdentityCalls = data.calls.map((call) => ({\n        to: call.to,\n        data: call.data,\n        value: BigInt(call.value || '0'),\n    }));\n    // Send UserOperation via bundler\n    onStatusUpdate?.('Sending UserOperation via bundler...');\n    const userOpHash = await (0,_accountClient__WEBPACK_IMPORTED_MODULE_1__.sendSponsoredUserOperation)({\n        bundlerUrl,\n        chain: chain,\n        accountClient: agentAccountClient,\n        calls: createAgentIdentityCalls,\n    });\n    onStatusUpdate?.(`UserOperation sent! Hash: ${userOpHash}. Waiting for confirmation...`);\n    // Wait for receipt\n    const receipt = await (0,_accountClient__WEBPACK_IMPORTED_MODULE_1__.waitForUserOperationReceipt)({\n        bundlerUrl,\n        chain: chain,\n        hash: userOpHash,\n    });\n    // Extract agentId from receipt logs\n    let agentId;\n    try {\n        const extractResponse = await fetch('/api/agents/extract-agent-id', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                receipt: JSON.parse(JSON.stringify(receipt, (_, value) => typeof value === 'bigint' ? value.toString() : value)),\n                chainId: chain.id,\n            }),\n        });\n        if (extractResponse.ok) {\n            const extractData = await extractResponse.json();\n            if (extractData?.agentId) {\n                agentId = extractData.agentId;\n            }\n        }\n        else {\n            const errorPayload = await extractResponse.json().catch(() => ({}));\n            console.warn('Failed to extract agentId via API:', errorPayload);\n        }\n    }\n    catch (error) {\n        console.warn('Unable to extract agentId via API:', error);\n    }\n    // Refresh GraphQL indexer\n    if (agentId) {\n        await refreshAgentInIndexer(agentId, chain.id);\n    }\n    else {\n        onStatusUpdate?.('Refreshing GraphQL indexer...');\n        console.log('UserOperation confirmed. Please refresh the agent list to see the new agent.');\n    }\n    return {\n        agentId,\n        txHash: userOpHash,\n        requiresClientSigning: true,\n    };\n}\n//# sourceMappingURL=walletSigning.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BhZ2VudGljLXRydXN0K2NvcmVAMS4wLjE3X0B2ZXJhbW8rY29yZUA2LjAuMF9idWZmZXJ1dGlsQDQuMC45X2VuY29kaW5nQDAuMS4xM19ncmFwaHFsQDE2LjEyLl9ibnlsZHR4emI2cHY3aXZyNXk2YTNvcnpnYS9ub2RlX21vZHVsZXMvQGFnZW50aWMtdHJ1c3QvY29yZS9kaXN0L2NsaWVudC93YWxsZXRTaWduaW5nLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUN1RTtBQUM4RztBQUNyRDtBQUN5QjtBQUN6SjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBLFdBQVcscUVBQWdCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQSwwREFBMEQsd0JBQXdCO0FBQ2xGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGtCQUFrQjtBQUN6QyxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixzQkFBc0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGdCQUFnQjtBQUN2QyxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7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QUFDQSwwQkFBMEIsMkVBQTJCO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLG9DQUFvQztBQUMzRDtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkVBQTZFO0FBQzdFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL0BteS1zY29wZS9hcm4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BhZ2VudGljLXRydXN0K2NvcmVAMS4wLjE3X0B2ZXJhbW8rY29yZUA2LjAuMF9idWZmZXJ1dGlsQDQuMC45X2VuY29kaW5nQDAuMS4xM19ncmFwaHFsQDE2LjEyLl9ibnlsZHR4emI2cHY3aXZyNXk2YTNvcnpnYS9ub2RlX21vZHVsZXMvQGFnZW50aWMtdHJ1c3QvY29yZS9kaXN0L2NsaWVudC93YWxsZXRTaWduaW5nLmpzP2RlZTEiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDbGllbnQtc2lkZSB3YWxsZXQgc2lnbmluZyB1dGlsaXRpZXNcbiAqXG4gKiBIYW5kbGVzIE1ldGFNYXNrL0VJUC0xMTkzIHdhbGxldCBpbnRlZ3JhdGlvbiBmb3Igc2lnbmluZyBhbmQgc2VuZGluZyB0cmFuc2FjdGlvbnNcbiAqIEFsbCBFdGhlcmV1bSBsb2dpYyBpcyBoYW5kbGVkIHNlcnZlci1zaWRlLCBjbGllbnQgb25seSBuZWVkcyB0byBzaWduIGFuZCBzZW5kXG4gKi9cbmltcG9ydCB7IGNyZWF0ZVdhbGxldENsaWVudCwgY3VzdG9tLCBjcmVhdGVQdWJsaWNDbGllbnQsIH0gZnJvbSAndmllbSc7XG5pbXBvcnQgeyBnZXRDaGFpbkJ5SWQsIERFRkFVTFRfQ0hBSU5fSUQsIGdldENoYWluUnBjVXJsLCBnZXRDaGFpbkJ1bmRsZXJVcmwsIHNlcG9saWEsIGJhc2VTZXBvbGlhLCBvcHRpbWlzbVNlcG9saWEsIGlzTDEsIGlzTDIsIGlzUHJpdmF0ZUtleU1vZGUsIH0gZnJvbSAnLi4vc2VydmVyL2xpYi9jaGFpbkNvbmZpZyc7XG5pbXBvcnQgeyBnZXREZXBsb3llZEFjY291bnRDbGllbnRCeUFnZW50TmFtZSwgc2VuZFNwb25zb3JlZFVzZXJPcGVyYXRpb24sIHdhaXRGb3JVc2VyT3BlcmF0aW9uUmVjZWlwdCwgfSBmcm9tICcuL2FjY291bnRDbGllbnQnO1xuZXhwb3J0IHsgZ2V0RGVwbG95ZWRBY2NvdW50Q2xpZW50QnlBZ2VudE5hbWUsIGdldENvdW50ZXJmYWN0dWFsQWNjb3VudENsaWVudEJ5QWdlbnROYW1lLCBnZXRDb3VudGVyZmFjdHVhbEFBQWRkcmVzc0J5QWdlbnROYW1lLCB9IGZyb20gJy4vYWNjb3VudENsaWVudCc7XG5mdW5jdGlvbiByZXNvbHZlRXRoZXJldW1Qcm92aWRlcihwcm92aWRlZFByb3ZpZGVyKSB7XG4gICAgaWYgKHByb3ZpZGVkUHJvdmlkZXIpXG4gICAgICAgIHJldHVybiBwcm92aWRlZFByb3ZpZGVyO1xuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBjb25zdCB3ZWIzYXV0aFByb3ZpZGVyID0gd2luZG93Py53ZWIzYXV0aD8ucHJvdmlkZXI7XG4gICAgICAgIGlmICh3ZWIzYXV0aFByb3ZpZGVyKVxuICAgICAgICAgICAgcmV0dXJuIHdlYjNhdXRoUHJvdmlkZXI7XG4gICAgICAgIGNvbnN0IGluamVjdGVkID0gd2luZG93LmV0aGVyZXVtO1xuICAgICAgICBpZiAoaW5qZWN0ZWQpXG4gICAgICAgICAgICByZXR1cm4gaW5qZWN0ZWQ7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufVxuYXN5bmMgZnVuY3Rpb24gcmVzb2x2ZUNoYWluSWQoZXRoZXJldW1Qcm92aWRlcikge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGNoYWluSGV4ID0gYXdhaXQgZXRoZXJldW1Qcm92aWRlci5yZXF1ZXN0Py4oe1xuICAgICAgICAgICAgbWV0aG9kOiAnZXRoX2NoYWluSWQnLFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHR5cGVvZiBjaGFpbkhleCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHJldHVybiBwYXJzZUludChjaGFpbkhleCwgMTYpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoIHtcbiAgICAgICAgLy8gaWdub3JlOyBmYWxsYmFjayBiZWxvd1xuICAgIH1cbiAgICAvLyBGYWxsYmFjayB0byBkZWZhdWx0IGNoYWluIGlkXG4gICAgcmV0dXJuIERFRkFVTFRfQ0hBSU5fSUQ7XG59XG4vKipcbiAqIEVuc3VyZSB0aGUgcHJvdmlkZXIgaGFzIGFuIGF1dGhvcml6ZWQgYWNjb3VudCBhbmQgcmV0dXJuIGl0LlxuICogVHJpZXMgZXRoX2FjY291bnRzIGZpcnN0OyBpZiBlbXB0eSwgcmVxdWVzdHMgZXRoX3JlcXVlc3RBY2NvdW50cy5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZW5zdXJlQXV0aG9yaXplZEFjY291bnQoZXRoZXJldW1Qcm92aWRlcikge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGV4aXN0aW5nID0gYXdhaXQgZXRoZXJldW1Qcm92aWRlci5yZXF1ZXN0KHsgbWV0aG9kOiAnZXRoX2FjY291bnRzJyB9KTtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZXhpc3RpbmcpICYmIGV4aXN0aW5nLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHJldHVybiBleGlzdGluZ1swXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjYXRjaCB7XG4gICAgICAgIC8vIGlnbm9yZSBhbmQgZmFsbCB0aHJvdWdoIHRvIHJlcXVlc3RcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgZ3JhbnRlZCA9IGF3YWl0IGV0aGVyZXVtUHJvdmlkZXIucmVxdWVzdCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdldGhfcmVxdWVzdEFjY291bnRzJyxcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGdyYW50ZWQpICYmIGdyYW50ZWQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGdyYW50ZWRbMF07XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2F0Y2gge1xuICAgICAgICAvLyBmYWxsdGhyb3VnaCB0byBwZXJtaXNzaW9ucyBmbG93XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGV0aGVyZXVtUHJvdmlkZXIucmVxdWVzdD8uKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ3dhbGxldF9yZXF1ZXN0UGVybWlzc2lvbnMnLFxuICAgICAgICAgICAgcGFyYW1zOiBbeyBldGhfYWNjb3VudHM6IHt9IH1dLFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgYWZ0ZXJQZXJtID0gYXdhaXQgZXRoZXJldW1Qcm92aWRlci5yZXF1ZXN0KHtcbiAgICAgICAgICAgIG1ldGhvZDogJ2V0aF9hY2NvdW50cycsXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShhZnRlclBlcm0pICYmIGFmdGVyUGVybS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gYWZ0ZXJQZXJtWzBdO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoIHtcbiAgICAgICAgLy8gaWdub3JlXG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcignV2FsbGV0IG5vdCBhdXRob3JpemVkLiBQbGVhc2UgY29ubmVjdCB5b3VyIHdhbGxldC4nKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGVuc3VyZUNoYWluU2VsZWN0ZWQoZXRoZXJldW1Qcm92aWRlciwgY2hhaW4pIHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBjdXJyZW50SGV4ID0gYXdhaXQgZXRoZXJldW1Qcm92aWRlci5yZXF1ZXN0Py4oe1xuICAgICAgICAgICAgbWV0aG9kOiAnZXRoX2NoYWluSWQnLFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgY3VycmVudCA9IHR5cGVvZiBjdXJyZW50SGV4ID09PSAnc3RyaW5nJyA/IHBhcnNlSW50KGN1cnJlbnRIZXgsIDE2KSA6IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKGN1cnJlbnQgPT09IGNoYWluLmlkKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjYXRjaCB7XG4gICAgICAgIC8vIGNvbnRpbnVlIHRvIHN3aXRjaFxuICAgIH1cbiAgICBjb25zdCBoZXhJZCA9IGAweCR7Y2hhaW4uaWQudG9TdHJpbmcoMTYpfWA7XG4gICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgZXRoZXJldW1Qcm92aWRlci5yZXF1ZXN0Py4oe1xuICAgICAgICAgICAgbWV0aG9kOiAnd2FsbGV0X3N3aXRjaEV0aGVyZXVtQ2hhaW4nLFxuICAgICAgICAgICAgcGFyYW1zOiBbeyBjaGFpbklkOiBoZXhJZCB9XSxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY2F0Y2ggKHN3aXRjaEVycikge1xuICAgICAgICAvLyA0OTAyID0gdW5rbm93biBjaGFpbiwgdHJ5IGFkZCB0aGVuIHN3aXRjaFxuICAgICAgICBpZiAoc3dpdGNoRXJyPy5jb2RlICE9PSA0OTAyKSB7XG4gICAgICAgICAgICB0aHJvdyBzd2l0Y2hFcnI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gVHJ5IHRvIGFkZCBjaGFpbiB1c2luZyBjZW50cmFsaXplZCBjb25maWd1cmF0aW9uXG4gICAgY29uc3QgY2hhaW5Db25maWcgPSBnZXRDaGFpbkJ5SWQoY2hhaW4uaWQpO1xuICAgIGNvbnN0IGFkZFBhcmFtcyA9IHtcbiAgICAgICAgY2hhaW5JZDogaGV4SWQsXG4gICAgICAgIGNoYWluTmFtZTogY2hhaW5Db25maWcubmFtZSxcbiAgICAgICAgbmF0aXZlQ3VycmVuY3k6IHtcbiAgICAgICAgICAgIG5hbWU6ICdFVEgnLFxuICAgICAgICAgICAgc3ltYm9sOiAnRVRIJyxcbiAgICAgICAgICAgIGRlY2ltYWxzOiAxOCxcbiAgICAgICAgfSxcbiAgICAgICAgcnBjVXJsczogW2dldENoYWluUnBjVXJsKGNoYWluLmlkKV0sXG4gICAgICAgIGJsb2NrRXhwbG9yZXJVcmxzOiBjaGFpbkNvbmZpZy5ibG9ja0V4cGxvcmVycz8uZGVmYXVsdFxuICAgICAgICAgICAgPyBbY2hhaW5Db25maWcuYmxvY2tFeHBsb3JlcnMuZGVmYXVsdC51cmxdXG4gICAgICAgICAgICA6IFtdLFxuICAgIH07XG4gICAgYXdhaXQgZXRoZXJldW1Qcm92aWRlci5yZXF1ZXN0Py4oe1xuICAgICAgICBtZXRob2Q6ICd3YWxsZXRfYWRkRXRoZXJldW1DaGFpbicsXG4gICAgICAgIHBhcmFtczogW2FkZFBhcmFtc10sXG4gICAgfSk7XG4gICAgYXdhaXQgZXRoZXJldW1Qcm92aWRlci5yZXF1ZXN0Py4oe1xuICAgICAgICBtZXRob2Q6ICd3YWxsZXRfc3dpdGNoRXRoZXJldW1DaGFpbicsXG4gICAgICAgIHBhcmFtczogW3sgY2hhaW5JZDogaGV4SWQgfV0sXG4gICAgfSk7XG59XG4vKipcbiAqIFNpZ24gYW5kIHNlbmQgYSB0cmFuc2FjdGlvbiB1c2luZyBNZXRhTWFzay9FSVAtMTE5MyB3YWxsZXRcbiAqXG4gKiBAcGFyYW0gb3B0aW9ucyAtIFNpZ25pbmcgb3B0aW9ucyBpbmNsdWRpbmcgdHJhbnNhY3Rpb24sIGFjY291bnQsIGNoYWluLCBhbmQgcHJvdmlkZXJcbiAqIEByZXR1cm5zIFRyYW5zYWN0aW9uIGhhc2gsIHJlY2VpcHQsIGFuZCBvcHRpb25hbGx5IGV4dHJhY3RlZCBhZ2VudElkXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzaWduQW5kU2VuZFRyYW5zYWN0aW9uKG9wdGlvbnMpIHtcbiAgICBjb25zdCB7IHRyYW5zYWN0aW9uLCBhY2NvdW50LCBjaGFpbiwgZXRoZXJldW1Qcm92aWRlciwgb25TdGF0dXNVcGRhdGUsIGV4dHJhY3RBZ2VudElkID0gZmFsc2UsIH0gPSBvcHRpb25zO1xuICAgIC8vIEdldCB3YWxsZXQgcHJvdmlkZXJcbiAgICBjb25zdCBwcm92aWRlciA9IHJlc29sdmVFdGhlcmV1bVByb3ZpZGVyKGV0aGVyZXVtUHJvdmlkZXIpO1xuICAgIGlmICghcHJvdmlkZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyB3YWxsZXQgcHJvdmlkZXIgZm91bmQuIFBsZWFzZSBjb25uZWN0IE1ldGFNYXNrIG9yIHVzZSBhbiBFSVAtMTE5MyBjb21wYXRpYmxlIHdhbGxldC4nKTtcbiAgICB9XG4gICAgLy8gVXBkYXRlIHN0YXR1c1xuICAgIG9uU3RhdHVzVXBkYXRlPy4oJ0Nvbm5lY3RpbmcgdG8gd2FsbGV0Li4uJyk7XG4gICAgLy8gQ3JlYXRlIHdhbGxldCBjbGllbnRcbiAgICB0cnkge1xuICAgICAgICAvLyBFbnN1cmUgY29ycmVjdCBjaGFpbiAmIGFjY291bnQgcGVybWlzc2lvbiBiZWZvcmUgc2VuZGluZ1xuICAgICAgICBhd2FpdCBlbnN1cmVDaGFpblNlbGVjdGVkKHByb3ZpZGVyLCBjaGFpbik7XG4gICAgICAgIGF3YWl0IGVuc3VyZUF1dGhvcml6ZWRBY2NvdW50KHByb3ZpZGVyKTtcbiAgICB9XG4gICAgY2F0Y2gge1xuICAgICAgICAvLyBOb24tZmF0YWw7IHNvbWUgcHJvdmlkZXJzIG1heSBub3QgcmVxdWlyZSB0aGlzIGhlcmVcbiAgICB9XG4gICAgY29uc3Qgd2FsbGV0Q2xpZW50ID0gY3JlYXRlV2FsbGV0Q2xpZW50KHtcbiAgICAgICAgYWNjb3VudCxcbiAgICAgICAgY2hhaW4sXG4gICAgICAgIHRyYW5zcG9ydDogY3VzdG9tKHByb3ZpZGVyKSxcbiAgICB9KTtcbiAgICAvLyBVcGRhdGUgc3RhdHVzXG4gICAgb25TdGF0dXNVcGRhdGU/LignVHJhbnNhY3Rpb24gcHJlcGFyZWQuIFBsZWFzZSBjb25maXJtIGluIHlvdXIgd2FsbGV0Li4uJyk7XG4gICAgLy8gQ29udmVydCBoZXggc3RyaW5ncyB0byBiaWdpbnQgZm9yIFZpZW0gKFZpZW0gYWNjZXB0cyBib3RoLCBidXQgVHlwZVNjcmlwdCBpcyBzdHJpY3QpXG4gICAgY29uc3QgdHhQYXJhbXMgPSB7XG4gICAgICAgIC4uLnRyYW5zYWN0aW9uLFxuICAgICAgICB2YWx1ZTogQmlnSW50KHRyYW5zYWN0aW9uLnZhbHVlKSxcbiAgICB9O1xuICAgIGlmICh0cmFuc2FjdGlvbi5nYXMpIHtcbiAgICAgICAgdHhQYXJhbXMuZ2FzID0gQmlnSW50KHRyYW5zYWN0aW9uLmdhcyk7XG4gICAgfVxuICAgIGlmICh0cmFuc2FjdGlvbi5nYXNQcmljZSkge1xuICAgICAgICB0eFBhcmFtcy5nYXNQcmljZSA9IEJpZ0ludCh0cmFuc2FjdGlvbi5nYXNQcmljZSk7XG4gICAgfVxuICAgIGlmICh0cmFuc2FjdGlvbi5tYXhGZWVQZXJHYXMpIHtcbiAgICAgICAgdHhQYXJhbXMubWF4RmVlUGVyR2FzID0gQmlnSW50KHRyYW5zYWN0aW9uLm1heEZlZVBlckdhcyk7XG4gICAgfVxuICAgIGlmICh0cmFuc2FjdGlvbi5tYXhQcmlvcml0eUZlZVBlckdhcykge1xuICAgICAgICB0eFBhcmFtcy5tYXhQcmlvcml0eUZlZVBlckdhcyA9IEJpZ0ludCh0cmFuc2FjdGlvbi5tYXhQcmlvcml0eUZlZVBlckdhcyk7XG4gICAgfVxuICAgIC8vIFNpZ24gYW5kIHNlbmQgdHJhbnNhY3Rpb25cbiAgICBjb25zdCBoYXNoID0gYXdhaXQgd2FsbGV0Q2xpZW50LnNlbmRUcmFuc2FjdGlvbih0eFBhcmFtcyk7XG4gICAgLy8gVXBkYXRlIHN0YXR1c1xuICAgIG9uU3RhdHVzVXBkYXRlPy4oYFRyYW5zYWN0aW9uIHN1Ym1pdHRlZCEgSGFzaDogJHtoYXNofS4gV2FpdGluZyBmb3IgY29uZmlybWF0aW9uLi4uYCk7XG4gICAgLy8gV2FpdCBmb3IgdHJhbnNhY3Rpb24gcmVjZWlwdFxuICAgIGNvbnN0IHB1YmxpY0NsaWVudCA9IGNyZWF0ZVB1YmxpY0NsaWVudCh7XG4gICAgICAgIGNoYWluLFxuICAgICAgICB0cmFuc3BvcnQ6IGN1c3RvbShldGhlcmV1bVByb3ZpZGVyKSxcbiAgICB9KTtcbiAgICBjb25zdCByZWNlaXB0ID0gYXdhaXQgcHVibGljQ2xpZW50LndhaXRGb3JUcmFuc2FjdGlvblJlY2VpcHQoeyBoYXNoIH0pO1xuICAgIC8vIEV4dHJhY3QgYWdlbnRJZCBpZiByZXF1ZXN0ZWQgKGZvciBhZ2VudCBjcmVhdGlvbiB0cmFuc2FjdGlvbnMpXG4gICAgbGV0IGFnZW50SWQ7XG4gICAgaWYgKHJlY2VpcHQgJiYgQXJyYXkuaXNBcnJheShyZWNlaXB0LmxvZ3MpKSB7XG4gICAgICAgIGNvbnN0IHplcm9Ub3BpYyA9ICcweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAnO1xuICAgICAgICBjb25zdCB0cmFuc2ZlclRvcGljID0gJzB4ZGRmMjUyYWQxYmUyYzg5YjY5YzJiMDY4ZmMzNzhkYWE5NTJiYTdmMTYzYzRhMTE2MjhmNTVhNGRmNTIzYjNlZic7XG4gICAgICAgIGNvbnN0IG1pbnRMb2cgPSByZWNlaXB0LmxvZ3MuZmluZCgobG9nKSA9PiBsb2c/LnRvcGljcz8uWzBdID09PSB0cmFuc2ZlclRvcGljICYmXG4gICAgICAgICAgICAobG9nPy50b3BpY3M/LlsxXSA9PT0gemVyb1RvcGljIHx8IGxvZz8udG9waWNzPy5bMV0gPT09IHVuZGVmaW5lZCkpO1xuICAgICAgICBpZiAobWludExvZykge1xuICAgICAgICAgICAgY29uc3QgdG9rZW5Ub3BpYyA9IG1pbnRMb2cudG9waWNzPy5bM107XG4gICAgICAgICAgICBjb25zdCB0b2tlbkRhdGEgPSBtaW50TG9nLmRhdGE7XG4gICAgICAgICAgICBjb25zdCB0b2tlbkhleCA9IHRva2VuVG9waWMgPz8gdG9rZW5EYXRhO1xuICAgICAgICAgICAgaWYgKHRva2VuSGV4KSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgYWdlbnRJZCA9IEJpZ0ludCh0b2tlbkhleCkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignVW5hYmxlIHRvIHBhcnNlIGFnZW50SWQgZnJvbSBtaW50IGxvZzonLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChleHRyYWN0QWdlbnRJZCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYWdlbnRJZCA9IGV4dHJhY3RBZ2VudElkRnJvbVJlY2VpcHQocmVjZWlwdCk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0NvdWxkIG5vdCBleHRyYWN0IGFnZW50SWQgZnJvbSByZWNlaXB0OicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBoYXNoLFxuICAgICAgICByZWNlaXB0LFxuICAgICAgICBhZ2VudElkLFxuICAgIH07XG59XG4vKipcbiAqIEV4dHJhY3QgYWdlbnRJZCBmcm9tIGEgdHJhbnNhY3Rpb24gcmVjZWlwdCAoZm9yIGFnZW50IGNyZWF0aW9uKVxuICogTG9va3MgZm9yIEVSQy03MjEgVHJhbnNmZXIgZXZlbnQgZnJvbSB6ZXJvIGFkZHJlc3NcbiAqXG4gKiBAcGFyYW0gcmVjZWlwdCAtIFRyYW5zYWN0aW9uIHJlY2VpcHRcbiAqIEByZXR1cm5zIEV4dHJhY3RlZCBhZ2VudElkIGFzIHN0cmluZywgb3IgdW5kZWZpbmVkIGlmIG5vdCBmb3VuZFxuICovXG5leHBvcnQgZnVuY3Rpb24gZXh0cmFjdEFnZW50SWRGcm9tUmVjZWlwdChyZWNlaXB0KSB7XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gRVJDLTcyMSBUcmFuc2ZlciBldmVudCBzaWduYXR1cmVcbiAgICAgICAgY29uc3QgdHJhbnNmZXJUb3BpYyA9ICcweGRkZjI1MmFkMWJlMmM4OWI2OWMyYjA2OGZjMzc4ZGFhOTUyYmE3ZjE2M2M0YTExNjI4ZjU1YTRkZjUyM2IzZWYnO1xuICAgICAgICAvLyBaZXJvIGFkZHJlc3MgdG9waWMgKGZyb20gYWRkcmVzcylcbiAgICAgICAgY29uc3QgemVyb0FkZHJlc3MgPSAnMHgwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwJztcbiAgICAgICAgaWYgKCFyZWNlaXB0LmxvZ3MgfHwgIUFycmF5LmlzQXJyYXkocmVjZWlwdC5sb2dzKSkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IGxvZyBvZiByZWNlaXB0LmxvZ3MpIHtcbiAgICAgICAgICAgIGlmIChsb2cudG9waWNzICYmXG4gICAgICAgICAgICAgICAgbG9nLnRvcGljc1swXSA9PT0gdHJhbnNmZXJUb3BpYyAmJlxuICAgICAgICAgICAgICAgIGxvZy50b3BpY3NbMV0gPT09IHplcm9BZGRyZXNzKSB7XG4gICAgICAgICAgICAgICAgLy8gRXh0cmFjdCB0b2tlbklkIChhZ2VudElkKSBmcm9tIHRvcGljc1szXVxuICAgICAgICAgICAgICAgIGlmIChsb2cudG9waWNzWzNdKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBCaWdJbnQobG9nLnRvcGljc1szXSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybignRXJyb3IgZXh0cmFjdGluZyBhZ2VudElkIGZyb20gcmVjZWlwdDonLCBlcnJvcik7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxufVxuLyoqXG4gKiBSZWZyZXNoIGFnZW50IGluIEdyYXBoUUwgaW5kZXhlclxuICpcbiAqIEBwYXJhbSBhZ2VudElkIC0gQWdlbnQgSUQgdG8gcmVmcmVzaFxuICogQHBhcmFtIGNoYWluSWQgLSBDaGFpbiBJRCBmb3IgdGhlIGFnZW50XG4gKiBAcGFyYW0gcmVmcmVzaEVuZHBvaW50IC0gT3B0aW9uYWwgY3VzdG9tIHJlZnJlc2ggZW5kcG9pbnQgKGRlZmF1bHRzIHRvIGAvYXBpL2FnZW50cy88ZGlkPi9yZWZyZXNoYClcbiAqIEByZXR1cm5zIFByb21pc2UgdGhhdCByZXNvbHZlcyB3aGVuIHJlZnJlc2ggaXMgY29tcGxldGVcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlZnJlc2hBZ2VudEluSW5kZXhlcihhZ2VudElkLCBjaGFpbklkLCByZWZyZXNoRW5kcG9pbnQpIHtcbiAgICBjb25zdCBjaGFpbklkU3RyID0gdHlwZW9mIGNoYWluSWQgPT09ICdudW1iZXInID8gY2hhaW5JZC50b1N0cmluZygxMCkgOiBjaGFpbklkPy50b1N0cmluZygpID8/ICcnO1xuICAgIGlmICghY2hhaW5JZFN0ci50cmltKCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDaGFpbiBJRCBpcyByZXF1aXJlZCB0byByZWZyZXNoIGFnZW50IGluIGluZGV4ZXInKTtcbiAgICB9XG4gICAgY29uc3QgZGlkID0gZW5jb2RlVVJJQ29tcG9uZW50KGBkaWQ6ODAwNDoke2NoYWluSWRTdHIudHJpbSgpfToke2FnZW50SWR9YCk7XG4gICAgY29uc3QgZW5kcG9pbnQgPSByZWZyZXNoRW5kcG9pbnQgfHwgYC9hcGkvYWdlbnRzLyR7ZGlkfS9yZWZyZXNoYDtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGVuZHBvaW50LCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHt9KSwgLy8gU2VuZCBlbXB0eSBib2R5IHRvIGF2b2lkIEpTT04gcGFyc2luZyBlcnJvcnNcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yVGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgRmFpbGVkIHRvIHJlZnJlc2ggYWdlbnQgJHthZ2VudElkfSBpbiBHcmFwaFFMIGluZGV4ZXI6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCwgZXJyb3JUZXh0KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBUcnkgdG8gcGFyc2UgcmVzcG9uc2UsIGJ1dCBkb24ndCBmYWlsIGlmIGl0J3MgZW1wdHlcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg4pyFIFJlZnJlc2hlZCBhZ2VudCAke2FnZW50SWR9IGluIEdyYXBoUUwgaW5kZXhlcmAsIGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChwYXJzZUVycm9yKSB7XG4gICAgICAgICAgICAvLyBSZXNwb25zZSBtaWdodCBiZSBlbXB0eSwgdGhhdCdzIG9rYXlcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDinIUgUmVmcmVzaGVkIGFnZW50ICR7YWdlbnRJZH0gaW4gR3JhcGhRTCBpbmRleGVyYCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihgRXJyb3IgcmVmcmVzaGluZyBhZ2VudCAke2FnZW50SWR9IGluIEdyYXBoUUwgaW5kZXhlcjpgLCBlcnJvcik7XG4gICAgfVxufVxuLyoqXG4gKiBDaGVjayBpZiB3YWxsZXQgcHJvdmlkZXIgaXMgYXZhaWxhYmxlXG4gKlxuICogQHBhcmFtIGV0aGVyZXVtUHJvdmlkZXIgLSBPcHRpb25hbCBwcm92aWRlciAoZGVmYXVsdHMgdG8gd2luZG93LmV0aGVyZXVtKVxuICogQHJldHVybnMgdHJ1ZSBpZiBwcm92aWRlciBpcyBhdmFpbGFibGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzV2FsbGV0UHJvdmlkZXJBdmFpbGFibGUoZXRoZXJldW1Qcm92aWRlcikge1xuICAgIGlmIChldGhlcmV1bVByb3ZpZGVyKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gISF3aW5kb3cuZXRoZXJldW07XG59XG4vKipcbiAqIEdldCB0aGUgY29ubmVjdGVkIHdhbGxldCBhZGRyZXNzIGZyb20gcHJvdmlkZXJcbiAqXG4gKiBAcGFyYW0gZXRoZXJldW1Qcm92aWRlciAtIE9wdGlvbmFsIHByb3ZpZGVyIChkZWZhdWx0cyB0byB3aW5kb3cuZXRoZXJldW0pXG4gKiBAcmV0dXJucyBDb25uZWN0ZWQgd2FsbGV0IGFkZHJlc3MsIG9yIG51bGwgaWYgbm90IGNvbm5lY3RlZFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0V2FsbGV0QWRkcmVzcyhldGhlcmV1bVByb3ZpZGVyKSB7XG4gICAgY29uc3QgcHJvdmlkZXIgPSBldGhlcmV1bVByb3ZpZGVyIHx8XG4gICAgICAgICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdy5ldGhlcmV1bSA6IG51bGwpO1xuICAgIGlmICghcHJvdmlkZXIpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgcHJvdmlkZXIucmVxdWVzdCh7IG1ldGhvZDogJ2V0aF9hY2NvdW50cycgfSk7XG4gICAgICAgIGlmIChhY2NvdW50cyAmJiBhY2NvdW50cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gYWNjb3VudHNbMF07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oJ0Vycm9yIGdldHRpbmcgd2FsbGV0IGFkZHJlc3M6JywgZXJyb3IpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG59XG4vKipcbiAqIENyZWF0ZSBhbiBhZ2VudCB3aXRoIGF1dG9tYXRpYyB3YWxsZXQgc2lnbmluZyBpZiBuZWVkZWRcbiAqXG4gKiBUaGlzIG1ldGhvZCBoYW5kbGVzIHRoZSBlbnRpcmUgZmxvdzpcbiAqIDEuIENhbGxzIHRoZSBBUEkgdG8gY3JlYXRlIGFnZW50IChlbmRwb2ludDogL2FwaS9hZ2VudHMvY3JlYXRlLWZvci1lb2EpXG4gKiAyLiBJZiBjbGllbnQtc2lkZSBzaWduaW5nIGlzIHJlcXVpcmVkLCBzaWducyBhbmQgc2VuZHMgdHJhbnNhY3Rpb25cbiAqIDMuIFdhaXRzIGZvciByZWNlaXB0IGFuZCBleHRyYWN0cyBhZ2VudElkXG4gKiA0LiBSZWZyZXNoZXMgR3JhcGhRTCBpbmRleGVyXG4gKlxuICogT25seSBhZ2VudERhdGEgaXMgcmVxdWlyZWQgLSBhY2NvdW50LCBjaGFpbiwgYW5kIHByb3ZpZGVyIGFyZSBhdXRvLWRldGVjdGVkXG4gKlxuICogQHBhcmFtIG9wdGlvbnMgLSBDcmVhdGlvbiBvcHRpb25zIChvbmx5IGFnZW50RGF0YSByZXF1aXJlZClcbiAqIEByZXR1cm5zIEFnZW50IGNyZWF0aW9uIHJlc3VsdFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlQWdlbnRXaXRoV2FsbGV0Rm9yRU9BKG9wdGlvbnMpIHtcbiAgICBjb25zdCB7IGFnZW50RGF0YSwgYWNjb3VudDogcHJvdmlkZWRBY2NvdW50LCBldGhlcmV1bVByb3ZpZGVyOiBwcm92aWRlZFByb3ZpZGVyLCBycGNVcmw6IHByb3ZpZGVkUnBjVXJsLCBvblN0YXR1c1VwZGF0ZSwgY2hhaW5JZDogcmVxdWVzdGVkQ2hhaW5JZCwgfSA9IG9wdGlvbnM7XG4gICAgLy8gR2V0IHdhbGxldCBwcm92aWRlciAoZGVmYXVsdCB0byB3aW5kb3cuZXRoZXJldW0pXG4gICAgY29uc3QgZXRoZXJldW1Qcm92aWRlciA9IHByb3ZpZGVkUHJvdmlkZXIgfHxcbiAgICAgICAgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93LmV0aGVyZXVtIDogbnVsbCk7XG4gICAgaWYgKCFldGhlcmV1bVByb3ZpZGVyKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gd2FsbGV0IHByb3ZpZGVyIGZvdW5kLiBQbGVhc2UgY29ubmVjdCBNZXRhTWFzayBvciB1c2UgYW4gRUlQLTExOTMgY29tcGF0aWJsZSB3YWxsZXQuJyk7XG4gICAgfVxuICAgIC8vIEdldCBhY2NvdW50IGZyb20gcHJvdmlkZXIgaWYgbm90IHByb3ZpZGVkXG4gICAgbGV0IGFjY291bnQ7XG4gICAgaWYgKHByb3ZpZGVkQWNjb3VudCkge1xuICAgICAgICBhY2NvdW50ID0gcHJvdmlkZWRBY2NvdW50O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgYWNjb3VudCA9IGF3YWl0IGVuc3VyZUF1dGhvcml6ZWRBY2NvdW50KGV0aGVyZXVtUHJvdmlkZXIpO1xuICAgIH1cbiAgICAvLyBTdGVwIDE6IENhbGwgQVBJIHRvIGNyZWF0ZSBhZ2VudFxuICAgIG9uU3RhdHVzVXBkYXRlPy4oJ0NyZWF0aW5nIGFnZW50Li4uJyk7XG4gICAgLy8gUHJlcGFyZSByZXF1ZXN0IGJvZHkgd2l0aCBBQSBwYXJhbWV0ZXJzIGlmIG5lZWRlZFxuICAgIGNvbnN0IHJlcXVlc3RCb2R5ID0ge1xuICAgICAgICAuLi5hZ2VudERhdGEsXG4gICAgICAgIGNoYWluSWQ6IHJlcXVlc3RlZENoYWluSWQsXG4gICAgfTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCcvYXBpL2FnZW50cy9jcmVhdGUtZm9yLWVvYScsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShyZXF1ZXN0Qm9keSksXG4gICAgfSk7XG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvckRhdGEubWVzc2FnZSB8fCBlcnJvckRhdGEuZXJyb3IgfHwgJ0ZhaWxlZCB0byBjcmVhdGUgYWdlbnQnKTtcbiAgICB9XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAvLyBTdGVwIDI6IENoZWNrIGlmIGNsaWVudC1zaWRlIHNpZ25pbmcgaXMgcmVxdWlyZWQgKHJlZ3VsYXIgRU9BIHRyYW5zYWN0aW9uKVxuICAgIGlmIChkYXRhLnJlcXVpcmVzQ2xpZW50U2lnbmluZyAmJiBkYXRhLnRyYW5zYWN0aW9uKSB7XG4gICAgICAgIC8vIEdldCBjaGFpbiBmcm9tIHRyYW5zYWN0aW9uIGNoYWluSWRcbiAgICAgICAgY29uc3QgY2hhaW5JZCA9IGRhdGEudHJhbnNhY3Rpb24uY2hhaW5JZDtcbiAgICAgICAgY29uc3QgY2hhaW4gPSBnZXRDaGFpbkJ5SWQoY2hhaW5JZCk7XG4gICAgICAgIC8vIFNpZ24gYW5kIHNlbmQgdHJhbnNhY3Rpb25cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2lnbkFuZFNlbmRUcmFuc2FjdGlvbih7XG4gICAgICAgICAgICB0cmFuc2FjdGlvbjogZGF0YS50cmFuc2FjdGlvbixcbiAgICAgICAgICAgIGFjY291bnQsXG4gICAgICAgICAgICBjaGFpbixcbiAgICAgICAgICAgIGV0aGVyZXVtUHJvdmlkZXIsXG4gICAgICAgICAgICBvblN0YXR1c1VwZGF0ZSxcbiAgICAgICAgICAgIGV4dHJhY3RBZ2VudElkOiB0cnVlLCAvLyBFeHRyYWN0IGFnZW50SWQgZm9yIGFnZW50IGNyZWF0aW9uXG4gICAgICAgIH0pO1xuICAgICAgICAvLyBTdGVwIDM6IFJlZnJlc2ggR3JhcGhRTCBpbmRleGVyIGlmIGFnZW50SWQgd2FzIGV4dHJhY3RlZFxuICAgICAgICBpZiAocmVzdWx0LmFnZW50SWQpIHtcbiAgICAgICAgICAgIGF3YWl0IHJlZnJlc2hBZ2VudEluSW5kZXhlcihyZXN1bHQuYWdlbnRJZCwgY2hhaW5JZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFnZW50SWQ6IHJlc3VsdC5hZ2VudElkLFxuICAgICAgICAgICAgdHhIYXNoOiByZXN1bHQuaGFzaCxcbiAgICAgICAgICAgIHJlcXVpcmVzQ2xpZW50U2lnbmluZzogdHJ1ZSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIC8vIFNlcnZlci1zaWRlIHNpZ25lZCB0cmFuc2FjdGlvblxuICAgICAgICAvLyBFbnN1cmUgd2UgaGF2ZSB0aGUgcmVxdWlyZWQgZmllbGRzXG4gICAgICAgIGlmICghZGF0YS5hZ2VudElkIHx8ICFkYXRhLnR4SGFzaCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHJlc3BvbnNlIGZyb20gY3JlYXRlIGFnZW50IEFQSS4gRXhwZWN0ZWQgYWdlbnRJZCBhbmQgdHhIYXNoLCBnb3Q6ICR7SlNPTi5zdHJpbmdpZnkoZGF0YSl9YCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYWdlbnRJZFN0ciA9IGRhdGEuYWdlbnRJZC50b1N0cmluZygpO1xuICAgICAgICAvLyBSZWZyZXNoIEdyYXBoUUwgaW5kZXhlciBmb3Igc2VydmVyLXNpZGUgc2lnbmVkIHRyYW5zYWN0aW9ucyB0b29cbiAgICAgICAgaWYgKGFnZW50SWRTdHIpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmFsbGJhY2tDaGFpbklkID0gdHlwZW9mIHJlcXVlc3RlZENoYWluSWQgPT09ICdudW1iZXInICYmIE51bWJlci5pc0Zpbml0ZShyZXF1ZXN0ZWRDaGFpbklkKVxuICAgICAgICAgICAgICAgICAgICA/IHJlcXVlc3RlZENoYWluSWRcbiAgICAgICAgICAgICAgICAgICAgOiBERUZBVUxUX0NIQUlOX0lEO1xuICAgICAgICAgICAgICAgIGF3YWl0IHJlZnJlc2hBZ2VudEluSW5kZXhlcihhZ2VudElkU3RyLCBmYWxsYmFja0NoYWluSWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgLy8gRG9uJ3QgZmFpbCB0aGUgd2hvbGUgb3BlcmF0aW9uIGlmIHJlZnJlc2ggZmFpbHNcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byByZWZyZXNoIGFnZW50IGluIGluZGV4ZXI6JywgZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhZ2VudElkOiBhZ2VudElkU3RyLFxuICAgICAgICAgICAgdHhIYXNoOiBkYXRhLnR4SGFzaCxcbiAgICAgICAgICAgIHJlcXVpcmVzQ2xpZW50U2lnbmluZzogZmFsc2UsXG4gICAgICAgIH07XG4gICAgfVxufVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUFnZW50V2l0aFdhbGxldEZvckFBKG9wdGlvbnMpIHtcbiAgICBjb25zdCB7IGFnZW50RGF0YSwgYWNjb3VudDogcHJvdmlkZWRBY2NvdW50LCBldGhlcmV1bVByb3ZpZGVyOiBwcm92aWRlZFByb3ZpZGVyLCBycGNVcmw6IHByb3ZpZGVkUnBjVXJsLCBvblN0YXR1c1VwZGF0ZSwgY2hhaW5JZDogcHJvdmlkZWRDaGFpbklkLCB9ID0gb3B0aW9ucztcbiAgICAvLyBHZXQgd2FsbGV0IHByb3ZpZGVyIChkZWZhdWx0IHRvIHdpbmRvdy5ldGhlcmV1bSlcbiAgICBjb25zdCBldGhlcmV1bVByb3ZpZGVyID0gcmVzb2x2ZUV0aGVyZXVtUHJvdmlkZXIocHJvdmlkZWRQcm92aWRlcik7XG4gICAgaWYgKCFldGhlcmV1bVByb3ZpZGVyKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gd2FsbGV0IHByb3ZpZGVyIGZvdW5kLiBQbGVhc2UgY29ubmVjdCBNZXRhTWFzayBvciB1c2UgYW4gRUlQLTExOTMgY29tcGF0aWJsZSB3YWxsZXQuJyk7XG4gICAgfVxuICAgIC8vIEdldCBhY2NvdW50IGZyb20gcHJvdmlkZXIgaWYgbm90IHByb3ZpZGVkXG4gICAgbGV0IGFjY291bnQ7XG4gICAgaWYgKHByb3ZpZGVkQWNjb3VudCkge1xuICAgICAgICBhY2NvdW50ID0gcHJvdmlkZWRBY2NvdW50O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgYWNjb3VudCA9IGF3YWl0IGVuc3VyZUF1dGhvcml6ZWRBY2NvdW50KGV0aGVyZXVtUHJvdmlkZXIpO1xuICAgIH1cbiAgICBjb25zdCBjaGFpbklkID0gdHlwZW9mIHByb3ZpZGVkQ2hhaW5JZCA9PT0gJ251bWJlcidcbiAgICAgICAgPyBwcm92aWRlZENoYWluSWRcbiAgICAgICAgOiBhd2FpdCByZXNvbHZlQ2hhaW5JZChldGhlcmV1bVByb3ZpZGVyKTtcbiAgICAvLyBTdGVwIDE6IENhbGwgQVBJIHRvIGNyZWF0ZSBhZ2VudFxuICAgIG9uU3RhdHVzVXBkYXRlPy4oJ0NyZWF0aW5nIGFnZW50Li4uJyk7XG4gICAgLy8gMC4gIEdldCBvbiB0aGUgY29ycmVjdCBjaGFpbiBnZXQgYWRhcHRlciBmb3IgdGhlIGNoYWluXG4gICAgbGV0IGNoYWluO1xuICAgIHN3aXRjaCAoY2hhaW5JZCkge1xuICAgICAgICBjYXNlIDExMTU1MTExOiAvLyBFVEggU2Vwb2xpYVxuICAgICAgICAgICAgY2hhaW4gPSBzZXBvbGlhO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgODQ1MzI6IC8vIEJhc2UgU2Vwb2xpYVxuICAgICAgICAgICAgY2hhaW4gPSBiYXNlU2Vwb2xpYTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDExMTU1NDIwOiAvLyBPcHRpbWlzbSBTZXBvbGlhXG4gICAgICAgICAgICBjaGFpbiA9IG9wdGltaXNtU2Vwb2xpYTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgY2hhaW4gPSBzZXBvbGlhO1xuICAgICAgICAgICAgY29uc29sZS53YXJuKGBVbmtub3duIGNoYWluSWQgJHtjaGFpbklkfSwgZGVmYXVsdGluZyB0byBTZXBvbGlhYCk7XG4gICAgfVxuICAgIC8vIEVuc3VyZSBwcm92aWRlciBpcyBvbiB0aGUgcmVxdWlyZWQgY2hhaW4gYmVmb3JlIGJ1aWxkaW5nIGNsaWVudHNcbiAgICB0cnkge1xuICAgICAgICBhd2FpdCBlbnN1cmVDaGFpblNlbGVjdGVkKGV0aGVyZXVtUHJvdmlkZXIsIGNoYWluKTtcbiAgICB9XG4gICAgY2F0Y2ggKHN3aXRjaEVycikge1xuICAgICAgICBjb25zb2xlLndhcm4oJ1VuYWJsZSB0byBzd2l0Y2ggY2hhaW4gb24gcHJvdmlkZXIgZm9yIEFBIGZsb3c6Jywgc3dpdGNoRXJyKTtcbiAgICB9XG4gICAgLy8gQnVpbGQgdmllbSBjbGllbnRzIGJvdW5kIHRvIHRoZSB1c2VyJ3MgV2ViM0F1dGggcHJvdmlkZXJcbiAgICBjb25zdCB2aWVtV2FsbGV0Q2xpZW50ID0gY3JlYXRlV2FsbGV0Q2xpZW50KHtcbiAgICAgICAgYWNjb3VudCxcbiAgICAgICAgY2hhaW4sXG4gICAgICAgIHRyYW5zcG9ydDogY3VzdG9tKGV0aGVyZXVtUHJvdmlkZXIpLFxuICAgIH0pO1xuICAgIGNvbnN0IHZpZW1QdWJsaWNDbGllbnQgPSBjcmVhdGVQdWJsaWNDbGllbnQoe1xuICAgICAgICBjaGFpbixcbiAgICAgICAgdHJhbnNwb3J0OiBjdXN0b20oZXRoZXJldW1Qcm92aWRlciksXG4gICAgfSk7XG4gICAgLy8gMS4gIE5lZWQgdG8gY3JlYXRlIHRoZSBBZ2VudCBBY2NvdW50IEFic3RyYWN0aW9uIChBY2NvdW50KVxuICAgIC8vIEJ1aWxkIEFBIGFjY291bnQgY2xpZW50IHVzaW5nIGNsaWVudCdzIEVPQSAoTWV0YU1hc2svV2ViM0F1dGgpXG4gICAgLy8gR2V0IGFnZW50IG5hbWUgZnJvbSByZXF1ZXN0XG4gICAgLy9sZXQgYWdlbnRGdWxsTmFtZSA9IG9wdGlvbnMuYWdlbnREYXRhLmFnZW50TmFtZTtcbiAgICAvL2lmIChvcHRpb25zLmVuc09wdGlvbnM/Lm9yZ05hbWUpIHtcbiAgICAvLyAgYWdlbnRGdWxsTmFtZSA9IG9wdGlvbnMuYWdlbnREYXRhLmFnZW50TmFtZSArICcuJyArIG9wdGlvbnMuZW5zT3B0aW9ucz8ub3JnTmFtZSArIFwiLmV0aFwiO1xuICAgIC8vfVxuICAgIC8vIEdldCBBY2NvdW50IENsaWVudCBieSBBZ2VudCBOYW1lLCBmaW5kIGlmIGV4aXN0cyBhbmQgaWYgbm90IHRoZW4gY3JlYXRlIGl0XG4gICAgY29uc3QgYnVuZGxlclVybCA9IGdldENoYWluQnVuZGxlclVybChjaGFpbklkKTtcbiAgICBsZXQgYWdlbnRBY2NvdW50Q2xpZW50ID0gYXdhaXQgZ2V0RGVwbG95ZWRBY2NvdW50Q2xpZW50QnlBZ2VudE5hbWUoYnVuZGxlclVybCwgb3B0aW9ucy5hZ2VudERhdGEuYWdlbnROYW1lLCBhY2NvdW50LCB7XG4gICAgICAgIGNoYWluOiBjaGFpbixcbiAgICAgICAgd2FsbGV0Q2xpZW50OiB2aWVtV2FsbGV0Q2xpZW50LFxuICAgICAgICBwdWJsaWNDbGllbnQ6IHZpZW1QdWJsaWNDbGllbnQsXG4gICAgfSk7XG4gICAgaWYgKCFhZ2VudEFjY291bnRDbGllbnQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gYnVpbGQgQUEgYWNjb3VudCBjbGllbnQnKTtcbiAgICB9XG4gICAgLy8gVmVyaWZ5IHRoZSBhZGRyZXNzIG1hdGNoZXNcbiAgICBjb25zdCBjb21wdXRlZEFkZHJlc3MgPSBhd2FpdCBhZ2VudEFjY291bnRDbGllbnQuZ2V0QWRkcmVzcygpO1xuICAgIGlmIChjb21wdXRlZEFkZHJlc3MudG9Mb3dlckNhc2UoKSAhPT1cbiAgICAgICAgb3B0aW9ucy5hZ2VudERhdGEuYWdlbnRBY2NvdW50LnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBQSBhZGRyZXNzIG1pc21hdGNoOiBjb21wdXRlZCAke2NvbXB1dGVkQWRkcmVzc30sIGV4cGVjdGVkICR7b3B0aW9ucy5hZ2VudERhdGEuYWdlbnRBY2NvdW50fWApO1xuICAgIH1cbiAgICAvLyAyLiAgQWRkIEVOUyByZWNvcmQgYXNzb2NpYXRlZCB3aXRoIG5ldyBhZ2VudFxuICAgIGNvbnNvbGUubG9nKCcqKioqKioqKioqKiBjcmVhdGVBZ2VudFdpdGhXYWxsZXRGb3JBQTogb3B0aW9ucy5lbnNPcHRpb25zJywgb3B0aW9ucy5lbnNPcHRpb25zKTtcbiAgICBpZiAob3B0aW9ucy5lbnNPcHRpb25zPy5lbmFibGVkICYmXG4gICAgICAgIG9wdGlvbnMuZW5zT3B0aW9ucy5vcmdOYW1lICYmXG4gICAgICAgIGlzTDEoY2hhaW5JZCkpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGVuc0FnZW50QWNjb3VudCA9IHR5cGVvZiBjb21wdXRlZEFkZHJlc3MgPT09ICdzdHJpbmcnICYmIGNvbXB1dGVkQWRkcmVzcy5zdGFydHNXaXRoKCcweCcpXG4gICAgICAgICAgICAgICAgPyBjb21wdXRlZEFkZHJlc3NcbiAgICAgICAgICAgICAgICA6IG9wdGlvbnMuYWdlbnREYXRhLmFnZW50QWNjb3VudDtcbiAgICAgICAgICAgIG9uU3RhdHVzVXBkYXRlPy4oJ0NyZWF0aW5nIEVOUyBzdWJkb21haW4gZm9yIGFnZW50OiAnICsgb3B0aW9ucy5hZ2VudERhdGEuYWdlbnROYW1lKTtcbiAgICAgICAgICAgIGNvbnN0IHBrTW9kZURldGVjdGVkID0gaXNQcml2YXRlS2V5TW9kZSgpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJjcmVhdGVBZ2VudFdpdGhXYWxsZXRGb3JBQTogcGtNb2RlRGV0ZWN0ZWRcIiwgcGtNb2RlRGV0ZWN0ZWQpO1xuICAgICAgICAgICAgY29uc3QgYWRkRW5kcG9pbnQgPSBwa01vZGVEZXRlY3RlZFxuICAgICAgICAgICAgICAgID8gJy9hcGkvbmFtZXMvYWRkLXRvLWwxLW9yZy1waydcbiAgICAgICAgICAgICAgICA6ICcvYXBpL25hbWVzL2FkZC10by1sMS1vcmcnO1xuICAgICAgICAgICAgY29uc29sZS5pbmZvKGBbRU5TXVtMMV0gJHtwa01vZGVEZXRlY3RlZCA/ICdQSyBtb2RlIGRldGVjdGVkIDExMTExJyA6ICdDbGllbnQgbW9kZSd9IC0gY2FsbGluZyAke2FkZEVuZHBvaW50fWApO1xuICAgICAgICAgICAgY29uc3QgZW5zUmVzcG9uc2UgPSBhd2FpdCBmZXRjaChhZGRFbmRwb2ludCwge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICAgICAgYWdlbnRBY2NvdW50OiBlbnNBZ2VudEFjY291bnQsXG4gICAgICAgICAgICAgICAgICAgIG9yZ05hbWU6IG9wdGlvbnMuZW5zT3B0aW9ucy5vcmdOYW1lLFxuICAgICAgICAgICAgICAgICAgICBhZ2VudE5hbWU6IG9wdGlvbnMuYWdlbnREYXRhLmFnZW50TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgYWdlbnRVcmw6IG9wdGlvbnMuYWdlbnREYXRhLmFnZW50VXJsLFxuICAgICAgICAgICAgICAgICAgICBjaGFpbklkLFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoIWVuc1Jlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZXJyID0gYXdhaXQgZW5zUmVzcG9uc2UuanNvbigpLmNhdGNoKCgpID0+ICh7fSkpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignW0VOU11bTDFdIGFkZC10by1sMS1vcmcgY2FsbCBmYWlsZWQnLCBlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5pbmZvKCdbRU5TXVtMMV0gYWRkLXRvLWwxLW9yZyBjYWxsIHN1Y2NlZWRlZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb25TdGF0dXNVcGRhdGU/LignUHJlcGFyaW5nIEVOUyBtZXRhZGF0YSB1cGRhdGUuLi4nKTtcbiAgICAgICAgICAgIGNvbnN0IGluZm9FbmRwb2ludCA9IHBrTW9kZURldGVjdGVkXG4gICAgICAgICAgICAgICAgPyAnL2FwaS9uYW1lcy9zZXQtbDEtbmFtZS1pbmZvLXBrJ1xuICAgICAgICAgICAgICAgIDogJy9hcGkvbmFtZXMvc2V0LWwxLW5hbWUtaW5mbyc7XG4gICAgICAgICAgICBjb25zb2xlLmluZm8oYFtFTlNdW0wxXSAke3BrTW9kZURldGVjdGVkID8gJ1BLIG1vZGUgZGV0ZWN0ZWQgMjIyMjInIDogJ0NsaWVudCBtb2RlJ30gLSBjYWxsaW5nICR7aW5mb0VuZHBvaW50fWApO1xuICAgICAgICAgICAgY29uc3QgaW5mb1Jlc3BvbnNlID0gYXdhaXQgZmV0Y2goaW5mb0VuZHBvaW50LCB7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgICBhZ2VudEFkZHJlc3M6IGVuc0FnZW50QWNjb3VudCxcbiAgICAgICAgICAgICAgICAgICAgb3JnTmFtZTogb3B0aW9ucy5lbnNPcHRpb25zLm9yZ05hbWUsXG4gICAgICAgICAgICAgICAgICAgIGFnZW50TmFtZTogb3B0aW9ucy5hZ2VudERhdGEuYWdlbnROYW1lLFxuICAgICAgICAgICAgICAgICAgICBhZ2VudFVybDogb3B0aW9ucy5hZ2VudERhdGEuYWdlbnRVcmwsXG4gICAgICAgICAgICAgICAgICAgIGFnZW50RGVzY3JpcHRpb246IG9wdGlvbnMuYWdlbnREYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAgICAgICBjaGFpbklkLFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoaW5mb1Jlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJyoqKioqKioqKioqIGNyZWF0ZUFnZW50V2l0aFdhbGxldEZvckFBOiBFTlMgbWV0YWRhdGEgcmVzcG9uc2UgcmVjZWl2ZWQnKTtcbiAgICAgICAgICAgICAgICBjb25zdCBpbmZvRGF0YSA9IGF3YWl0IGluZm9SZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VydmVySW5mb1VzZXJPcEhhc2ggPSBpbmZvRGF0YT8udXNlck9wSGFzaDtcbiAgICAgICAgICAgICAgICBpZiAoc2VydmVySW5mb1VzZXJPcEhhc2gpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJyoqKioqKioqKioqIGNyZWF0ZUFnZW50V2l0aFdhbGxldEZvckFBOiBFTlMgaW5mbyB1c2VyT3BIYXNoIChzZXJ2ZXItc3VibWl0dGVkKScsIHNlcnZlckluZm9Vc2VyT3BIYXNoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZm9DYWxscyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShpbmZvRGF0YT8uY2FsbHMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHJhd0NhbGwgb2YgaW5mb0RhdGEuY2FsbHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0byA9IHJhd0NhbGw/LnRvO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByYXdDYWxsPy5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdG8gfHwgIWRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmF3Q2FsbD8udmFsdWUgIT09IG51bGwgJiYgcmF3Q2FsbD8udmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBCaWdJbnQocmF3Q2FsbC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ1VuYWJsZSB0byBwYXJzZSBFTlMgaW5mbyBjYWxsIHZhbHVlJywgcmF3Q2FsbC52YWx1ZSwgZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm9DYWxscy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmZvQ2FsbHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb25TdGF0dXNVcGRhdGU/LignVXBkYXRpbmcgRU5TIGFnZW50IGluZm8uLi4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEVuc3VyZSB3ZSBhcmUgdXNpbmcgYSBkZXBsb3llZC1vbmx5IEFBIGNsaWVudCAobm8gZmFjdG9yeS9mYWN0b3J5RGF0YSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc3QgZnVsbEFnZW50TmFtZSA9IGFnZW50TmFtZSArICcuJyArIG9wdGlvbnMuZW5zT3B0aW9ucy5vcmdOYW1lICsgXCIuZXRoXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnISEhISEhISEhISEhIGhhbmRsZUNyZWF0ZUFnZW50OiBnZXREZXBsb3llZEFjY291bnRDbGllbnRCeUFnZW50TmFtZSAyOiBhZ2VudE5hbWUnLCBvcHRpb25zLmFnZW50RGF0YS5hZ2VudE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWdlbnRBY2NvdW50Q2xpZW50ID0gYXdhaXQgZ2V0RGVwbG95ZWRBY2NvdW50Q2xpZW50QnlBZ2VudE5hbWUoYnVuZGxlclVybCwgb3B0aW9ucy5hZ2VudERhdGEuYWdlbnROYW1lLCBhY2NvdW50LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhaW46IGNoYWluLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhbGxldENsaWVudDogdmllbVdhbGxldENsaWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdWJsaWNDbGllbnQ6IHZpZW1QdWJsaWNDbGllbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZm9Vc2VyT3BIYXNoID0gYXdhaXQgc2VuZFNwb25zb3JlZFVzZXJPcGVyYXRpb24oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1bmRsZXJVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhaW46IGNoYWluLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRDbGllbnQ6IGFnZW50QWNjb3VudENsaWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsczogaW5mb0NhbGxzLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB3YWl0Rm9yVXNlck9wZXJhdGlvblJlY2VpcHQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1bmRsZXJVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhaW46IGNoYWluLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc2g6IGluZm9Vc2VyT3BIYXNoLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlcnJvclBheWxvYWQgPSBhd2FpdCBpbmZvUmVzcG9uc2UuanNvbigpLmNhdGNoKCgpID0+ICh7fSkpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIHByZXBhcmUgRU5TIG1ldGFkYXRhIGNhbGxzOicsIGVycm9yUGF5bG9hZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVxdWVzdGVkIEVOUyByZWNvcmQgY3JlYXRpb24gYW5kIG1ldGFkYXRhIHVwZGF0ZSBmb3IgYWdlbnQnLCBvcHRpb25zLmFnZW50RGF0YS5hZ2VudE5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlbnNFcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gY3JlYXRlIEVOUyByZWNvcmQgZm9yIGFnZW50OicsIGVuc0Vycm9yKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChvcHRpb25zLmVuc09wdGlvbnM/LmVuYWJsZWQgJiZcbiAgICAgICAgb3B0aW9ucy5lbnNPcHRpb25zLm9yZ05hbWUgJiZcbiAgICAgICAgaXNMMihjaGFpbklkKSkge1xuICAgICAgICBjb25zdCByYXdPcmcgPSBvcHRpb25zLmVuc09wdGlvbnMub3JnTmFtZSB8fCAnJztcbiAgICAgICAgY29uc3QgcmF3QWdlbnQgPSBvcHRpb25zLmFnZW50RGF0YS5hZ2VudE5hbWUgfHwgJyc7XG4gICAgICAgIGNvbnN0IGNsZWFuT3JnTmFtZSA9IHJhd09yZy5yZXBsYWNlKC9cXC5ldGgkL2ksICcnKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBjb25zdCBvcmdQYXR0ZXJuID0gY2xlYW5PcmdOYW1lLnJlcGxhY2UoL1suKis/XiR7fSgpfFtcXF1cXFxcXS9nLCAnXFxcXCQmJyk7XG4gICAgICAgIGNvbnN0IGNsZWFuQWdlbnROYW1lID0gcmF3QWdlbnRcbiAgICAgICAgICAgIC5yZXBsYWNlKG5ldyBSZWdFeHAoYF4ke29yZ1BhdHRlcm59XFxcXC5gLCAnaScpLCAnJylcbiAgICAgICAgICAgIC5yZXBsYWNlKC9cXC5ldGgkL2ksICcnKVxuICAgICAgICAgICAgLnRyaW0oKVxuICAgICAgICAgICAgLnRvTG93ZXJDYXNlKClcbiAgICAgICAgICAgIC5yZXBsYWNlKC9cXHMrL2csICctJyk7XG4gICAgICAgIGNvbnN0IGFnZW50VXJsID0gb3B0aW9ucy5hZ2VudERhdGEuYWdlbnRVcmw7XG4gICAgICAgIGNvbnN0IGFnZW50RGVzY3JpcHRpb24gPSBvcHRpb25zLmFnZW50RGF0YS5kZXNjcmlwdGlvbjtcbiAgICAgICAgY29uc3QgYWdlbnRJbWFnZSA9IG9wdGlvbnMuYWdlbnREYXRhLmltYWdlO1xuICAgICAgICAvLyBQcmVwYXJlIGFsbCBuZWNlc3NhcnkgTDIgRU5TIGNhbGxzIHNlcnZlci1zaWRlLCB0aGVuIHNlbmQgdGhlbSBhcyBvbmUgdXNlciBvcGVyYXRpb25cbiAgICAgICAgY29uc3QgcHJlcGFyZVJlc3AgPSBhd2FpdCBmZXRjaCgnL2FwaS9uYW1lcy9hZGQtdG8tbDItb3JnJywge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBhZ2VudEFkZHJlc3M6IGFnZW50QWNjb3VudENsaWVudC5hZGRyZXNzLFxuICAgICAgICAgICAgICAgIG9yZ05hbWU6IGNsZWFuT3JnTmFtZSxcbiAgICAgICAgICAgICAgICBhZ2VudE5hbWU6IGNsZWFuQWdlbnROYW1lLFxuICAgICAgICAgICAgICAgIGFnZW50VXJsLFxuICAgICAgICAgICAgICAgIGFnZW50RGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgYWdlbnRJbWFnZSxcbiAgICAgICAgICAgICAgICBjaGFpbklkLFxuICAgICAgICAgICAgfSksXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXByZXBhcmVSZXNwLm9rKSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvclBheWxvYWQgPSBhd2FpdCBwcmVwYXJlUmVzcC5qc29uKCkuY2F0Y2goKCkgPT4gKHt9KSk7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBwcmVwYXJlIEwyIEVOUyBjYWxsczonLCBlcnJvclBheWxvYWQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgeyBjYWxsczogcmF3Q2FsbHMgfSA9IGF3YWl0IHByZXBhcmVSZXNwLmpzb24oKTtcbiAgICAgICAgICAgIGNvbnN0IGwyRW5zQ2FsbHMgPSAocmF3Q2FsbHMgfHwgW10pLm1hcCgoY2FsbCkgPT4gKHtcbiAgICAgICAgICAgICAgICB0bzogY2FsbC50byxcbiAgICAgICAgICAgICAgICBkYXRhOiBjYWxsLmRhdGEsXG4gICAgICAgICAgICAgICAgdmFsdWU6IEJpZ0ludChjYWxsLnZhbHVlIHx8ICcwJyksXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBpZiAobDJFbnNDYWxscy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBjYWxsIG9mIGwyRW5zQ2FsbHMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJyoqKioqKioqKioqKioqKioqKioqKiBzZW5kIHNwb25zb3JlZCB1c2VyIG9wZXJhdGlvbiBmb3IgTDIgRU5TIGNhbGwnKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdXNlck9wSGFzaCA9IGF3YWl0IHNlbmRTcG9uc29yZWRVc2VyT3BlcmF0aW9uKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1bmRsZXJVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRDbGllbnQ6IGFnZW50QWNjb3VudENsaWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxzOiBbY2FsbF0sXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB3YWl0Rm9yVXNlck9wZXJhdGlvblJlY2VpcHQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgYnVuZGxlclVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYWluLFxuICAgICAgICAgICAgICAgICAgICAgICAgaGFzaDogdXNlck9wSGFzaCxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qICBUT0RPOiAgTmVlZCB0byByZXNvbHZlIHRoaXMgdG8gc2V0IGVucyB1cmwgYW5kIGRlc2NyaXB0aW9uXG4gICAgICAgICAgb25TdGF0dXNVcGRhdGU/LignU2V0IEVOUyBtZXRhZGF0YSB1cGRhdGUuLi4nKTtcbiAgICAgICAgICBjb25zdCBpbmZvUmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnL2FwaS9uYW1lcy9zZXQtbDItbmFtZS1pbmZvJywge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgYWdlbnRBZGRyZXNzOiBhZ2VudEFjY291bnRDbGllbnQuYWRkcmVzcyxcbiAgICAgICAgICAgICAgb3JnTmFtZTogb3B0aW9ucy5lbnNPcHRpb25zLm9yZ05hbWUsXG4gICAgICAgICAgICAgIGFnZW50TmFtZTogb3B0aW9ucy5hZ2VudERhdGEuYWdlbnROYW1lLFxuICAgICAgICAgICAgICBhZ2VudFVybDogb3B0aW9ucy5hZ2VudERhdGEuYWdlbnRVcmwsXG4gICAgICAgICAgICAgIGFnZW50RGVzY3JpcHRpb246IG9wdGlvbnMuYWdlbnREYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICBjaGFpbklkLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSk7XG4gICAgXG4gICAgICAgICAgaWYgKCFpbmZvUmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yUGF5bG9hZCA9IGF3YWl0IGluZm9SZXNwb25zZS5qc29uKCkuY2F0Y2goKCkgPT4gKHt9KSk7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBwcmVwYXJlIEwyIEVOUyBjYWxsczonLCBlcnJvclBheWxvYWQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCB7IGNhbGxzOiByYXdDYWxscyB9ID0gYXdhaXQgaW5mb1Jlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICAgIGNvbnN0IGwyRW5zQ2FsbHMgPSAocmF3Q2FsbHMgfHwgW10pLm1hcCgoY2FsbDogYW55KSA9PiAoe1xuICAgICAgICAgICAgICB0bzogY2FsbC50byBhcyBgMHgke3N0cmluZ31gLFxuICAgICAgICAgICAgICBkYXRhOiBjYWxsLmRhdGEgYXMgYDB4JHtzdHJpbmd9YCxcbiAgICAgICAgICAgICAgdmFsdWU6IEJpZ0ludChjYWxsLnZhbHVlIHx8ICcwJyksXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBpZiAobDJFbnNDYWxscy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgIGZvciAoY29uc3QgY2FsbCBvZiBsMkVuc0NhbGxzKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJyoqKioqKioqKioqKioqKioqKioqKiBzZW5kIHNwb25zb3JlZCB1c2VyIG9wZXJhdGlvbiBmb3IgTDIgRU5TIGNhbGwnKTtcbiAgICAgICAgICAgICAgICBjb25zdCB1c2VyT3BIYXNoID0gYXdhaXQgc2VuZFNwb25zb3JlZFVzZXJPcGVyYXRpb24oe1xuICAgICAgICAgICAgICAgICAgYnVuZGxlclVybCxcbiAgICAgICAgICAgICAgICAgIGNoYWluLFxuICAgICAgICAgICAgICAgICAgYWNjb3VudENsaWVudDogYWdlbnRBY2NvdW50Q2xpZW50LFxuICAgICAgICAgICAgICAgICAgY2FsbHM6IFtjYWxsXSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBhd2FpdCB3YWl0Rm9yVXNlck9wZXJhdGlvblJlY2VpcHQoe1xuICAgICAgICAgICAgICAgICAgYnVuZGxlclVybCxcbiAgICAgICAgICAgICAgICAgIGNoYWluLFxuICAgICAgICAgICAgICAgICAgaGFzaDogdXNlck9wSGFzaCxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICAgICovXG4gICAgfVxuICAgIC8vIDIuICBOZWVkIHRvIGNyZWF0ZSB0aGUgQWdlbnQgSWRlbnRpdHkgKE5GVClcbiAgICBjb25zb2xlLmxvZygnKioqKioqKioqKiogY3JlYXRlQWdlbnRXaXRoV2FsbGV0Rm9yQUE6IGNyZWF0aW5nIGFnZW50IGlkZW50aXR5Li4uJyk7XG4gICAgY29uc3QgZmluYWxBZ2VudE5hbWUgPSBvcHRpb25zLmVuc09wdGlvbnM/LmVuYWJsZWQgJiYgb3B0aW9ucy5lbnNPcHRpb25zPy5vcmdOYW1lXG4gICAgICAgID8gYCR7b3B0aW9ucy5hZ2VudERhdGEuYWdlbnROYW1lfS4ke29wdGlvbnMuZW5zT3B0aW9ucz8ub3JnTmFtZX0uZXRoYFxuICAgICAgICA6IG9wdGlvbnMuYWdlbnREYXRhLmFnZW50TmFtZTtcbiAgICBhZ2VudERhdGEuYWdlbnROYW1lID0gZmluYWxBZ2VudE5hbWU7XG4gICAgLy8gUHJlcGFyZSByZXF1ZXN0IGJvZHkgd2l0aCBBQSBwYXJhbWV0ZXJzIGlmIG5lZWRlZFxuICAgIGNvbnN0IHJlcXVlc3RCb2R5ID0ge1xuICAgICAgICBhY2NvdW50OiBjb21wdXRlZEFkZHJlc3MsXG4gICAgICAgIC4uLmFnZW50RGF0YSxcbiAgICAgICAgY2hhaW5JZCxcbiAgICB9O1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvYWdlbnRzL2NyZWF0ZS1mb3ItYWEnLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdEJvZHkpLFxuICAgIH0pO1xuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JEYXRhLm1lc3NhZ2UgfHwgZXJyb3JEYXRhLmVycm9yIHx8ICdGYWlsZWQgdG8gY3JlYXRlIGFnZW50Jyk7XG4gICAgfVxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KGRhdGEuY2FsbHMpIHx8IGRhdGEuY2FsbHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQWdlbnQgY3JlYXRpb24gcmVzcG9uc2UgbWlzc2luZyByZWdpc3RlciBjYWxscycpO1xuICAgIH1cbiAgICAvLyBDb25zdHJ1Y3QgQWdlbnQgSWRlbnRpdHkgd2l0aCBhZ2VudEFjY291bnQgQ2xpZW50XG4gICAgY29uc3QgY3JlYXRlQWdlbnRJZGVudGl0eUNhbGxzID0gZGF0YS5jYWxscy5tYXAoKGNhbGwpID0+ICh7XG4gICAgICAgIHRvOiBjYWxsLnRvLFxuICAgICAgICBkYXRhOiBjYWxsLmRhdGEsXG4gICAgICAgIHZhbHVlOiBCaWdJbnQoY2FsbC52YWx1ZSB8fCAnMCcpLFxuICAgIH0pKTtcbiAgICAvLyBTZW5kIFVzZXJPcGVyYXRpb24gdmlhIGJ1bmRsZXJcbiAgICBvblN0YXR1c1VwZGF0ZT8uKCdTZW5kaW5nIFVzZXJPcGVyYXRpb24gdmlhIGJ1bmRsZXIuLi4nKTtcbiAgICBjb25zdCB1c2VyT3BIYXNoID0gYXdhaXQgc2VuZFNwb25zb3JlZFVzZXJPcGVyYXRpb24oe1xuICAgICAgICBidW5kbGVyVXJsLFxuICAgICAgICBjaGFpbjogY2hhaW4sXG4gICAgICAgIGFjY291bnRDbGllbnQ6IGFnZW50QWNjb3VudENsaWVudCxcbiAgICAgICAgY2FsbHM6IGNyZWF0ZUFnZW50SWRlbnRpdHlDYWxscyxcbiAgICB9KTtcbiAgICBvblN0YXR1c1VwZGF0ZT8uKGBVc2VyT3BlcmF0aW9uIHNlbnQhIEhhc2g6ICR7dXNlck9wSGFzaH0uIFdhaXRpbmcgZm9yIGNvbmZpcm1hdGlvbi4uLmApO1xuICAgIC8vIFdhaXQgZm9yIHJlY2VpcHRcbiAgICBjb25zdCByZWNlaXB0ID0gYXdhaXQgd2FpdEZvclVzZXJPcGVyYXRpb25SZWNlaXB0KHtcbiAgICAgICAgYnVuZGxlclVybCxcbiAgICAgICAgY2hhaW46IGNoYWluLFxuICAgICAgICBoYXNoOiB1c2VyT3BIYXNoLFxuICAgIH0pO1xuICAgIC8vIEV4dHJhY3QgYWdlbnRJZCBmcm9tIHJlY2VpcHQgbG9nc1xuICAgIGxldCBhZ2VudElkO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGV4dHJhY3RSZXNwb25zZSA9IGF3YWl0IGZldGNoKCcvYXBpL2FnZW50cy9leHRyYWN0LWFnZW50LWlkJywge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICByZWNlaXB0OiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHJlY2VpcHQsIChfLCB2YWx1ZSkgPT4gdHlwZW9mIHZhbHVlID09PSAnYmlnaW50JyA/IHZhbHVlLnRvU3RyaW5nKCkgOiB2YWx1ZSkpLFxuICAgICAgICAgICAgICAgIGNoYWluSWQ6IGNoYWluLmlkLFxuICAgICAgICAgICAgfSksXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoZXh0cmFjdFJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICBjb25zdCBleHRyYWN0RGF0YSA9IGF3YWl0IGV4dHJhY3RSZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICBpZiAoZXh0cmFjdERhdGE/LmFnZW50SWQpIHtcbiAgICAgICAgICAgICAgICBhZ2VudElkID0gZXh0cmFjdERhdGEuYWdlbnRJZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yUGF5bG9hZCA9IGF3YWl0IGV4dHJhY3RSZXNwb25zZS5qc29uKCkuY2F0Y2goKCkgPT4gKHt9KSk7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBleHRyYWN0IGFnZW50SWQgdmlhIEFQSTonLCBlcnJvclBheWxvYWQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oJ1VuYWJsZSB0byBleHRyYWN0IGFnZW50SWQgdmlhIEFQSTonLCBlcnJvcik7XG4gICAgfVxuICAgIC8vIFJlZnJlc2ggR3JhcGhRTCBpbmRleGVyXG4gICAgaWYgKGFnZW50SWQpIHtcbiAgICAgICAgYXdhaXQgcmVmcmVzaEFnZW50SW5JbmRleGVyKGFnZW50SWQsIGNoYWluLmlkKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIG9uU3RhdHVzVXBkYXRlPy4oJ1JlZnJlc2hpbmcgR3JhcGhRTCBpbmRleGVyLi4uJyk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdVc2VyT3BlcmF0aW9uIGNvbmZpcm1lZC4gUGxlYXNlIHJlZnJlc2ggdGhlIGFnZW50IGxpc3QgdG8gc2VlIHRoZSBuZXcgYWdlbnQuJyk7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGFnZW50SWQsXG4gICAgICAgIHR4SGFzaDogdXNlck9wSGFzaCxcbiAgICAgICAgcmVxdWlyZXNDbGllbnRTaWduaW5nOiB0cnVlLFxuICAgIH07XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD13YWxsZXRTaWduaW5nLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/../../node_modules/.pnpm/@agentic-trust+core@1.0.17_@veramo+core@6.0.0_bufferutil@4.0.9_encoding@0.1.13_graphql@16.12._bnyldtxzb6pv7ivr5y6a3orzga/node_modules/@agentic-trust/core/dist/client/walletSigning.js\n");

/***/ }),

/***/ "(ssr)/../../node_modules/.pnpm/@agentic-trust+core@1.0.17_@veramo+core@6.0.0_bufferutil@4.0.9_encoding@0.1.13_graphql@16.12._bnyldtxzb6pv7ivr5y6a3orzga/node_modules/@agentic-trust/core/dist/client/walletSigningClient.js":
/*!*****************************************************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/@agentic-trust+core@1.0.17_@veramo+core@6.0.0_bufferutil@4.0.9_encoding@0.1.13_graphql@16.12._bnyldtxzb6pv7ivr5y6a3orzga/node_modules/@agentic-trust/core/dist/client/walletSigningClient.js ***!
  \*****************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAgentWithWalletForAA: () => (/* reexport safe */ _walletSigning__WEBPACK_IMPORTED_MODULE_0__.createAgentWithWalletForAA),\n/* harmony export */   createAgentWithWalletForEOA: () => (/* reexport safe */ _walletSigning__WEBPACK_IMPORTED_MODULE_0__.createAgentWithWalletForEOA),\n/* harmony export */   extractAgentIdFromReceipt: () => (/* reexport safe */ _walletSigning__WEBPACK_IMPORTED_MODULE_0__.extractAgentIdFromReceipt),\n/* harmony export */   getCounterfactualAAAddressByAgentName: () => (/* reexport safe */ _walletSigning__WEBPACK_IMPORTED_MODULE_0__.getCounterfactualAAAddressByAgentName),\n/* harmony export */   getCounterfactualAccountClientByAgentName: () => (/* reexport safe */ _walletSigning__WEBPACK_IMPORTED_MODULE_0__.getCounterfactualAccountClientByAgentName),\n/* harmony export */   getDeployedAccountClientByAgentName: () => (/* reexport safe */ _walletSigning__WEBPACK_IMPORTED_MODULE_0__.getDeployedAccountClientByAgentName),\n/* harmony export */   getWalletAddress: () => (/* reexport safe */ _walletSigning__WEBPACK_IMPORTED_MODULE_0__.getWalletAddress),\n/* harmony export */   isWalletProviderAvailable: () => (/* reexport safe */ _walletSigning__WEBPACK_IMPORTED_MODULE_0__.isWalletProviderAvailable),\n/* harmony export */   refreshAgentInIndexer: () => (/* reexport safe */ _walletSigning__WEBPACK_IMPORTED_MODULE_0__.refreshAgentInIndexer),\n/* harmony export */   signAndSendTransaction: () => (/* reexport safe */ _walletSigning__WEBPACK_IMPORTED_MODULE_0__.signAndSendTransaction)\n/* harmony export */ });\n/* harmony import */ var _walletSigning__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./walletSigning */ \"(ssr)/../../node_modules/.pnpm/@agentic-trust+core@1.0.17_@veramo+core@6.0.0_bufferutil@4.0.9_encoding@0.1.13_graphql@16.12._bnyldtxzb6pv7ivr5y6a3orzga/node_modules/@agentic-trust/core/dist/client/walletSigning.js\");\n/**\n * Client-side wallet signing utilities (client-only entry point)\n *\n * This is a client-only export that can be safely imported in browser code\n */\n\n//# sourceMappingURL=walletSigningClient.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BhZ2VudGljLXRydXN0K2NvcmVAMS4wLjE3X0B2ZXJhbW8rY29yZUA2LjAuMF9idWZmZXJ1dGlsQDQuMC45X2VuY29kaW5nQDAuMS4xM19ncmFwaHFsQDE2LjEyLl9ibnlsZHR4emI2cHY3aXZyNXk2YTNvcnpnYS9ub2RlX21vZHVsZXMvQGFnZW50aWMtdHJ1c3QvY29yZS9kaXN0L2NsaWVudC93YWxsZXRTaWduaW5nQ2xpZW50LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUN5VTtBQUN6VSIsInNvdXJjZXMiOlsid2VicGFjazovL0BteS1zY29wZS9hcm4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BhZ2VudGljLXRydXN0K2NvcmVAMS4wLjE3X0B2ZXJhbW8rY29yZUA2LjAuMF9idWZmZXJ1dGlsQDQuMC45X2VuY29kaW5nQDAuMS4xM19ncmFwaHFsQDE2LjEyLl9ibnlsZHR4emI2cHY3aXZyNXk2YTNvcnpnYS9ub2RlX21vZHVsZXMvQGFnZW50aWMtdHJ1c3QvY29yZS9kaXN0L2NsaWVudC93YWxsZXRTaWduaW5nQ2xpZW50LmpzPzU0NjMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDbGllbnQtc2lkZSB3YWxsZXQgc2lnbmluZyB1dGlsaXRpZXMgKGNsaWVudC1vbmx5IGVudHJ5IHBvaW50KVxuICpcbiAqIFRoaXMgaXMgYSBjbGllbnQtb25seSBleHBvcnQgdGhhdCBjYW4gYmUgc2FmZWx5IGltcG9ydGVkIGluIGJyb3dzZXIgY29kZVxuICovXG5leHBvcnQgeyBzaWduQW5kU2VuZFRyYW5zYWN0aW9uLCBleHRyYWN0QWdlbnRJZEZyb21SZWNlaXB0LCByZWZyZXNoQWdlbnRJbkluZGV4ZXIsIGlzV2FsbGV0UHJvdmlkZXJBdmFpbGFibGUsIGdldFdhbGxldEFkZHJlc3MsIGNyZWF0ZUFnZW50V2l0aFdhbGxldEZvckVPQSwgY3JlYXRlQWdlbnRXaXRoV2FsbGV0Rm9yQUEsIGdldENvdW50ZXJmYWN0dWFsQWNjb3VudENsaWVudEJ5QWdlbnROYW1lLCBnZXREZXBsb3llZEFjY291bnRDbGllbnRCeUFnZW50TmFtZSwgZ2V0Q291bnRlcmZhY3R1YWxBQUFkZHJlc3NCeUFnZW50TmFtZSwgfSBmcm9tICcuL3dhbGxldFNpZ25pbmcnO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9d2FsbGV0U2lnbmluZ0NsaWVudC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/../../node_modules/.pnpm/@agentic-trust+core@1.0.17_@veramo+core@6.0.0_bufferutil@4.0.9_encoding@0.1.13_graphql@16.12._bnyldtxzb6pv7ivr5y6a3orzga/node_modules/@agentic-trust/core/dist/client/walletSigningClient.js\n");

/***/ }),

/***/ "(ssr)/../../node_modules/.pnpm/@agentic-trust+core@1.0.17_@veramo+core@6.0.0_bufferutil@4.0.9_encoding@0.1.13_graphql@16.12._bnyldtxzb6pv7ivr5y6a3orzga/node_modules/@agentic-trust/core/dist/server/lib/chainConfig.js":
/*!*************************************************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/@agentic-trust+core@1.0.17_@veramo+core@6.0.0_bufferutil@4.0.9_encoding@0.1.13_graphql@16.12._bnyldtxzb6pv7ivr5y6a3orzga/node_modules/@agentic-trust/core/dist/server/lib/chainConfig.js ***!
  \*************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CHAIN_CONFIG: () => (/* binding */ CHAIN_CONFIG),\n/* harmony export */   DEFAULT_CHAIN_ID: () => (/* binding */ DEFAULT_CHAIN_ID),\n/* harmony export */   baseSepolia: () => (/* reexport safe */ viem_chains__WEBPACK_IMPORTED_MODULE_1__.baseSepolia),\n/* harmony export */   getChainBundlerUrl: () => (/* binding */ getChainBundlerUrl),\n/* harmony export */   getChainById: () => (/* binding */ getChainById),\n/* harmony export */   getChainConfig: () => (/* binding */ getChainConfig),\n/* harmony export */   getChainContractAddress: () => (/* binding */ getChainContractAddress),\n/* harmony export */   getChainDisplayMetadata: () => (/* binding */ getChainDisplayMetadata),\n/* harmony export */   getChainEnvVar: () => (/* binding */ getChainEnvVar),\n/* harmony export */   getChainEnvVarDetails: () => (/* binding */ getChainEnvVarDetails),\n/* harmony export */   getChainEnvVarNames: () => (/* binding */ getChainEnvVarNames),\n/* harmony export */   getChainIdHex: () => (/* binding */ getChainIdHex),\n/* harmony export */   getChainLayer: () => (/* binding */ getChainLayer),\n/* harmony export */   getChainRpcUrl: () => (/* binding */ getChainRpcUrl),\n/* harmony export */   getEnsOrgAddress: () => (/* binding */ getEnsOrgAddress),\n/* harmony export */   getEnsOrgName: () => (/* binding */ getEnsOrgName),\n/* harmony export */   getEnsPrivateKey: () => (/* binding */ getEnsPrivateKey),\n/* harmony export */   getSupportedChainIds: () => (/* binding */ getSupportedChainIds),\n/* harmony export */   getWeb3AuthChainSettings: () => (/* binding */ getWeb3AuthChainSettings),\n/* harmony export */   getWeb3AuthClientId: () => (/* binding */ getWeb3AuthClientId),\n/* harmony export */   getWeb3AuthNetwork: () => (/* binding */ getWeb3AuthNetwork),\n/* harmony export */   isChainSupported: () => (/* binding */ isChainSupported),\n/* harmony export */   isL1: () => (/* binding */ isL1),\n/* harmony export */   isL2: () => (/* binding */ isL2),\n/* harmony export */   isPrivateKeyMode: () => (/* binding */ isPrivateKeyMode),\n/* harmony export */   optimismSepolia: () => (/* reexport safe */ viem_chains__WEBPACK_IMPORTED_MODULE_2__.optimismSepolia),\n/* harmony export */   requireChainEnvVar: () => (/* binding */ requireChainEnvVar),\n/* harmony export */   sepolia: () => (/* reexport safe */ viem_chains__WEBPACK_IMPORTED_MODULE_0__.sepolia)\n/* harmony export */ });\n/* harmony import */ var viem_chains__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! viem/chains */ \"(ssr)/../../node_modules/.pnpm/viem@2.39.3_bufferutil@4.0.9_typescript@5.9.3_utf-8-validate@5.0.10/node_modules/viem/_esm/chains/definitions/sepolia.js\");\n/* harmony import */ var viem_chains__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! viem/chains */ \"(ssr)/../../node_modules/.pnpm/viem@2.39.3_bufferutil@4.0.9_typescript@5.9.3_utf-8-validate@5.0.10/node_modules/viem/_esm/chains/definitions/baseSepolia.js\");\n/* harmony import */ var viem_chains__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! viem/chains */ \"(ssr)/../../node_modules/.pnpm/viem@2.39.3_bufferutil@4.0.9_typescript@5.9.3_utf-8-validate@5.0.10/node_modules/viem/_esm/chains/definitions/optimismSepolia.js\");\n/**\n * Centralized Chain Configuration\n *\n * This module provides chain-specific configuration and utilities\n * used throughout the AgenticTrust system.\n */\n\n// Re-export chains for convenience\n\n/**\n * Chain configuration mapping\n */\nconst CHAIN_CONFIG = {\n    11155111: {\n        suffix: 'SEPOLIA',\n        name: 'sepolia',\n        displayName: 'Ethereum Sepolia',\n        layer: 'L1',\n    },\n    84532: {\n        suffix: 'BASE_SEPOLIA',\n        name: 'baseSepolia',\n        displayName: 'Base Sepolia',\n        layer: 'L2',\n    },\n    11155420: {\n        suffix: 'OPTIMISM_SEPOLIA',\n        name: 'optimismSepolia',\n        displayName: 'Optimism Sepolia',\n        layer: 'L2',\n    },\n};\nfunction getChainLayer(chainId) {\n    const cfg = CHAIN_CONFIG[chainId];\n    if (!cfg)\n        throw new Error(`Unsupported chainId: ${chainId}`);\n    return cfg.layer;\n}\nfunction isL1(chainId) {\n    return getChainLayer(chainId) === 'L1';\n}\nfunction isL2(chainId) {\n    return getChainLayer(chainId) === 'L2';\n}\n/**\n * Default chain ID used when no chain is specified\n */\nconst DEFAULT_CHAIN_ID = 11155111; // Ethereum Sepolia\nconst SERVER_CHAIN_RPC_ENV = {\n    11155111: process.env.AGENTIC_TRUST_RPC_URL_SEPOLIA,\n    84532: process.env.AGENTIC_TRUST_RPC_URL_BASE_SEPOLIA,\n    11155420: process.env.AGENTIC_TRUST_RPC_URL_OPTIMISM_SEPOLIA,\n};\nconst CLIENT_CHAIN_RPC_ENV = {\n    11155111: \"https://eth-sepolia.g.alchemy.com/v2/WvEny4nR70VTUMX0DfR-A\",\n    84532: process.env.NEXT_PUBLIC_AGENTIC_TRUST_RPC_URL_BASE_SEPOLIA,\n    11155420: process.env.NEXT_PUBLIC_AGENTIC_TRUST_RPC_URL_OPTIMISM_SEPOLIA,\n};\nconst SERVER_CHAIN_BUNDLER_ENV = {\n    11155111: process.env.AGENTIC_TRUST_BUNDLER_URL_SEPOLIA,\n    84532: process.env.AGENTIC_TRUST_BUNDLER_URL_BASE_SEPOLIA,\n    11155420: process.env.AGENTIC_TRUST_BUNDLER_URL_OPTIMISM_SEPOLIA,\n};\nconst CLIENT_CHAIN_BUNDLER_ENV = {\n    11155111: \"https://api.pimlico.io/v2/11155111/rpc?apikey=pim_HmE7RySzpkRBpcekjHfXpT\",\n    84532: process.env.NEXT_PUBLIC_AGENTIC_TRUST_BUNDLER_URL_BASE_SEPOLIA,\n    11155420: process.env.NEXT_PUBLIC_AGENTIC_TRUST_BUNDLER_URL_OPTIMISM_SEPOLIA,\n};\n// ENS chain-specific variables\nconst SERVER_CHAIN_ENS_PRIVKEY_ENV = {\n    11155111: process.env.AGENTIC_TRUST_ENS_PRIVATE_KEY_SEPOLIA,\n    84532: process.env.AGENTIC_TRUST_ENS_PRIVATE_KEY_BASE_SEPOLIA,\n    11155420: process.env.AGENTIC_TRUST_ENS_PRIVATE_KEY_OPTIMISM_SEPOLIA,\n};\nconst SERVER_CHAIN_ENS_ORG_ADDRESS_ENV = {\n    11155111: process.env.AGENTIC_TRUST_ENS_ORG_ADDRESS_SEPOLIA,\n    84532: process.env.AGENTIC_TRUST_ENS_ORG_ADDRESS_BASE_SEPOLIA,\n    11155420: process.env.AGENTIC_TRUST_ENS_ORG_ADDRESS_OPTIMISM_SEPOLIA,\n};\nconst CLIENT_CHAIN_ENS_ORG_NAME_ENV = {\n    11155111: \"8004-agent\",\n    84532: process.env.NEXT_PUBLIC_AGENTIC_TRUST_ENS_ORG_NAME_BASE_SEPOLIA,\n    11155420: process.env.NEXT_PUBLIC_AGENTIC_TRUST_ENS_ORG_NAME_OPTIMISM_SEPOLIA,\n};\n/**\n * Get chain-specific environment variable\n * @param baseName - Base environment variable name (e.g., 'AGENTIC_TRUST_RPC_URL')\n * @param chainId - Chain ID to get configuration for\n * @returns Chain-specific environment variable value or fallback to base name\n */\nfunction getChainEnvVarDetails(baseName, chainId) {\n    const cfg = CHAIN_CONFIG[chainId];\n    const chainKey = cfg ? `${baseName}_${cfg.suffix}` : `${baseName}_${chainId}`;\n    const fallbackKey = baseName;\n    const chainValue = cfg ? process.env[chainKey] : undefined;\n    const fallbackValue = process.env[fallbackKey];\n    const value = chainValue ?? fallbackValue ?? '';\n    const usedKey = chainValue ? chainKey : fallbackValue ? fallbackKey : chainKey;\n    return {\n        value,\n        chainKey: cfg ? chainKey : fallbackKey,\n        fallbackKey,\n        usedKey,\n    };\n}\nfunction getChainEnvVar(baseName, chainId) {\n    return getChainEnvVarDetails(baseName, chainId).value;\n}\nfunction getChainEnvVarNames(chainId) {\n    const cfg = CHAIN_CONFIG[chainId];\n    if (!cfg) {\n        throw new Error(`Unsupported chainId: ${chainId}`);\n    }\n    return {\n        rpcServer: `AGENTIC_TRUST_RPC_URL_${cfg.suffix}`,\n        rpcClient: `NEXT_PUBLIC_AGENTIC_TRUST_RPC_URL_${cfg.suffix}`,\n        bundlerServer: `AGENTIC_TRUST_BUNDLER_URL_${cfg.suffix}`,\n        bundlerClient: `NEXT_PUBLIC_AGENTIC_TRUST_BUNDLER_URL_${cfg.suffix}`,\n        ensOrgAddressServer: `AGENTIC_TRUST_ENS_ORG_ADDRESS_${cfg.suffix}`,\n        ensOrgNameClient: `NEXT_PUBLIC_AGENTIC_TRUST_ENS_ORG_NAME_${cfg.suffix}`,\n        ensPrivateKeyServer: `AGENTIC_TRUST_ENS_PRIVATE_KEY_${cfg.suffix}`,\n    };\n}\nfunction requireChainEnvVar(baseName, chainId) {\n    const { value, chainKey } = getChainEnvVarDetails(baseName, chainId);\n    if (!value) {\n        throw new Error(`Missing required environment variable: ${chainKey}`);\n    }\n    return value;\n}\n/**\n * Get chain-specific contract address\n * @param baseName - Base environment variable name (e.g., 'AGENTIC_TRUST_ENS_REGISTRY')\n * @param chainId - Chain ID to get configuration for\n * @returns Chain-specific contract address or fallback to base name\n */\nfunction getChainContractAddress(baseName, chainId) {\n    const value = getChainEnvVar(baseName, chainId);\n    return value ? (value.startsWith('0x') ? value : `0x${value}`) : undefined;\n}\n/**\n * Get chain object by chainId\n * @param chainId - Chain ID to get chain object for\n * @returns viem Chain object\n * @throws Error if chainId is not supported\n */\nfunction getChainById(chainId) {\n    const chainConfig = CHAIN_CONFIG[chainId];\n    if (!chainConfig) {\n        throw new Error(`Unsupported chainId: ${chainId}. Supported chains: ${Object.keys(CHAIN_CONFIG).join(', ')}`);\n    }\n    const chainName = chainConfig.name;\n    switch (chainName) {\n        case 'sepolia':\n            return viem_chains__WEBPACK_IMPORTED_MODULE_0__.sepolia;\n        case 'baseSepolia':\n            return viem_chains__WEBPACK_IMPORTED_MODULE_1__.baseSepolia;\n        case 'optimismSepolia':\n            return viem_chains__WEBPACK_IMPORTED_MODULE_2__.optimismSepolia;\n        default:\n            throw new Error(`Chain ${chainName} not implemented`);\n    }\n}\n/**\n * Get all supported chain IDs\n * @returns Array of supported chain IDs\n */\nfunction getSupportedChainIds() {\n    return Object.keys(CHAIN_CONFIG).map(id => parseInt(id, 10));\n}\n/**\n * Check if a chain ID is supported\n * @param chainId - Chain ID to check\n * @returns True if the chain ID is supported\n */\nfunction isChainSupported(chainId) {\n    return chainId in CHAIN_CONFIG;\n}\n/**\n * Get chain configuration by chain ID\n * @param chainId - Chain ID to get configuration for\n * @returns Chain configuration object or null if not supported\n */\nfunction getChainConfig(chainId) {\n    return CHAIN_CONFIG[chainId] || null;\n}\n/**\n * Get chain-specific RPC URL (accessible from both server and client)\n *\n * Requires chain-specific environment variables - throws error if not found:\n * Browser: NEXT_PUBLIC_AGENTIC_TRUST_RPC_URL_{CHAIN_SUFFIX}\n * Server: AGENTIC_TRUST_RPC_URL_{CHAIN_SUFFIX} (preferred) or NEXT_PUBLIC_AGENTIC_TRUST_RPC_URL_{CHAIN_SUFFIX}\n * No generic fallbacks - only chain-specific variables are checked\n *\n * @param chainId - Chain ID to get RPC URL for\n * @returns RPC URL string\n */\nfunction getChainRpcUrl(chainId) {\n    const chainConfig = CHAIN_CONFIG[chainId];\n    if (chainConfig) {\n        // Determine if we're running in browser or server\n        const isBrowser = typeof window !== 'undefined';\n        // Read directly from process.env at runtime instead of using cached values\n        // This ensures we get the current value even if env vars were loaded after module initialization\n        let serverValue;\n        let clientValue;\n        if (chainId === 11155111) {\n            serverValue = process.env.AGENTIC_TRUST_RPC_URL_SEPOLIA;\n            clientValue = \"https://eth-sepolia.g.alchemy.com/v2/WvEny4nR70VTUMX0DfR-A\";\n        }\n        else if (chainId === 84532) {\n            serverValue = process.env.AGENTIC_TRUST_RPC_URL_BASE_SEPOLIA;\n            clientValue = process.env.NEXT_PUBLIC_AGENTIC_TRUST_RPC_URL_BASE_SEPOLIA;\n        }\n        else if (chainId === 11155420) {\n            serverValue = process.env.AGENTIC_TRUST_RPC_URL_OPTIMISM_SEPOLIA;\n            clientValue = process.env.NEXT_PUBLIC_AGENTIC_TRUST_RPC_URL_OPTIMISM_SEPOLIA;\n        }\n        if (isBrowser) {\n            if (clientValue)\n                return clientValue;\n        }\n        else {\n            if (serverValue)\n                return serverValue;\n            if (clientValue)\n                return clientValue;\n        }\n        // Log all AGENTIC_TRUST variables for debugging\n        const allMatchingKeys = Object.keys(process.env).filter(key => key.startsWith('AGENTIC_TRUST') || key.startsWith('NEXT_PUBLIC_AGENTIC_TRUST'));\n        // No generic fallbacks - throw error if chain-specific variable not configured\n        const envNames = getChainEnvVarNames(chainId);\n        const mask = (val) => (val ? '<set>' : '<missing>');\n        const expectedVar = isBrowser ? envNames.rpcClient : envNames.rpcServer;\n        console.error(`[chainConfig] Missing RPC URL for chain ${chainId} (${chainConfig.name}). Checked env vars ` +\n            `${envNames.rpcServer}=${mask(serverValue)} and ${envNames.rpcClient}=${mask(clientValue)}. ` +\n            `Set ${isBrowser ? envNames.rpcClient : `${envNames.rpcServer} (server) or ${envNames.rpcClient}`}.`);\n        throw new Error(`Missing required RPC URL for chain ${chainId} (${chainConfig.name}). ` +\n            `Set ${expectedVar} environment variable.`);\n    }\n    throw new Error(`Unsupported chain ID: ${chainId}`);\n}\nfunction getChainIdHex(chainId) {\n    return `0x${chainId.toString(16)}`;\n}\nfunction getChainDisplayMetadata(chainId) {\n    const chainConfig = CHAIN_CONFIG[chainId];\n    if (!chainConfig) {\n        throw new Error(`Unsupported chain ID: ${chainId}`);\n    }\n    const chain = getChainById(chainId);\n    const chainIdHex = getChainIdHex(chainId);\n    const rpcUrl = getChainRpcUrl(chainId);\n    const nativeCurrency = chain.nativeCurrency ?? {\n        name: 'Ether',\n        symbol: 'ETH',\n        decimals: 18,\n    };\n    const blockExplorerUrls = [];\n    const defaultExplorerUrl = chain.blockExplorers?.default?.url;\n    if (defaultExplorerUrl) {\n        blockExplorerUrls.push(defaultExplorerUrl);\n    }\n    return {\n        chainId,\n        chainIdHex,\n        chainName: chain.name,\n        displayName: chainConfig.displayName || chain.name,\n        nativeCurrency,\n        rpcUrls: [rpcUrl],\n        blockExplorerUrls,\n    };\n}\nfunction getWeb3AuthChainSettings(chainId) {\n    const metadata = getChainDisplayMetadata(chainId);\n    const nativeCurrency = metadata.nativeCurrency;\n    const rpcTarget = metadata.rpcUrls[0];\n    if (!rpcTarget) {\n        throw new Error(`Missing RPC URL for Web3Auth chain ${chainId}`);\n    }\n    return {\n        chainNamespace: 'eip155',\n        chainId: metadata.chainIdHex,\n        rpcTarget,\n        displayName: metadata.displayName,\n        blockExplorerUrl: metadata.blockExplorerUrls[0],\n        ticker: nativeCurrency.symbol ?? 'ETH',\n        tickerName: nativeCurrency.name ?? 'Ether',\n        decimals: nativeCurrency.decimals ?? 18,\n        nativeCurrency,\n        rpcUrls: metadata.rpcUrls,\n        blockExplorerUrls: metadata.blockExplorerUrls,\n    };\n}\n/**\n * Get chain-specific bundler URL (accessible from both server and client)\n * @param chainId - Chain ID to get bundler URL for\n * @returns Bundler URL string\n */\nfunction getChainBundlerUrl(chainId) {\n    const chainConfig = CHAIN_CONFIG[chainId];\n    if (chainConfig) {\n        const isBrowser = typeof window !== 'undefined';\n        if (isBrowser) {\n            const clientValue = CLIENT_CHAIN_BUNDLER_ENV[chainId];\n            if (clientValue)\n                return clientValue;\n        }\n        else {\n            const serverValue = SERVER_CHAIN_BUNDLER_ENV[chainId];\n            if (serverValue)\n                return serverValue;\n            const clientValue = CLIENT_CHAIN_BUNDLER_ENV[chainId];\n            if (clientValue)\n                return clientValue;\n        }\n        const envNames = getChainEnvVarNames(chainId);\n        const mask = (val) => (val ? '<set>' : '<missing>');\n        const expectedVar = isBrowser ? envNames.bundlerClient : envNames.bundlerServer;\n        console.error(`[chainConfig] Missing bundler URL for chain ${chainId} (${chainConfig.name}). Checked env vars ` +\n            `${envNames.bundlerServer}=${mask(SERVER_CHAIN_BUNDLER_ENV[chainId])} ` +\n            `and ${envNames.bundlerClient}=${mask(CLIENT_CHAIN_BUNDLER_ENV[chainId])}.`);\n        throw new Error(`Missing required bundler URL for chain ${chainId} (${chainConfig.name}). ` +\n            `Set ${expectedVar} environment variable.`);\n    }\n    throw new Error(`Unsupported chain ID: ${chainId}`);\n}\n/**\n * Check if private key mode is enabled (accessible from both server and client)\n * @returns True if private key mode is enabled\n */\nfunction isPrivateKeyMode() {\n    console.log(\"isPrivateKeyMode: \", process.env.NEXT_PUBLIC_AGENTIC_TRUST_USE_PRIVATE_KEY);\n    return process.env.NEXT_PUBLIC_AGENTIC_TRUST_USE_PRIVATE_KEY === 'true';\n}\n/**\n * Get ENS organization name (accessible from both server and client), chain-specific.\n * Throws if not configured.\n * @param chainId - target chain (defaults to DEFAULT_CHAIN_ID)\n */\nfunction getEnsOrgName(chainId) {\n    const target = (chainId ?? DEFAULT_CHAIN_ID);\n    const chainConfig = CHAIN_CONFIG[target];\n    const isBrowser = typeof window !== 'undefined';\n    const clientValue = CLIENT_CHAIN_ENS_ORG_NAME_ENV[target];\n    if (clientValue)\n        return clientValue;\n    // Allow server to also read NEXT_PUBLIC_ value (consistency with RPC logic)\n    if (!isBrowser && clientValue)\n        return clientValue;\n    const expectedVar = `NEXT_PUBLIC_AGENTIC_TRUST_ENS_ORG_NAME_${chainConfig.suffix}`;\n    throw new Error(`Missing required ENS org name for chain ${target} (${chainConfig.name}). Set ${expectedVar}.`);\n}\n/**\n * Get ENS org address (server-only), chain-specific. Throws if not configured.\n */\nfunction getEnsOrgAddress(chainId) {\n    const target = chainId;\n    const chainConfig = CHAIN_CONFIG[target];\n    const value = SERVER_CHAIN_ENS_ORG_ADDRESS_ENV[target];\n    if (value && value.startsWith('0x') && value.length === 42)\n        return value;\n    const expectedVar = `AGENTIC_TRUST_ENS_ORG_ADDRESS_${chainConfig.suffix}`;\n    throw new Error(`Missing required ENS org address for chain ${target} (${chainConfig.name}). Set ${expectedVar}.`);\n}\n/**\n * Get ENS private key (server-only), chain-specific. Throws if not configured.\n */\nfunction getEnsPrivateKey(chainId) {\n    const target = chainId;\n    const chainConfig = CHAIN_CONFIG[target];\n    const value = SERVER_CHAIN_ENS_PRIVKEY_ENV[target];\n    if (value)\n        return value.startsWith('0x') ? value : `0x${value}`;\n    const expectedVar = `AGENTIC_TRUST_ENS_PRIVATE_KEY_${chainConfig.suffix}`;\n    throw new Error(`Missing required ENS private key for chain ${target} (${chainConfig.name}). Set ${expectedVar}.`);\n}\n/**\n * Get Web3Auth client ID (accessible from both server and client)\n * @returns Web3Auth client ID\n */\nfunction getWeb3AuthClientId() {\n    return \"BLPEpiCGGemncsyRbSt1NucfuR4IxWiGVPpuz0-8xNtoRtBn_d_XZxkcwm8c9V_FQUAj_1q9WuJNm7NYLnBORgE\" || 0;\n}\n/**\n * Get Web3Auth network (accessible from both server and client)\n * @returns Web3Auth network\n */\nfunction getWeb3AuthNetwork() {\n    return process.env.NEXT_PUBLIC_WEB3AUTH_NETWORK || 'sapphire_devnet';\n}\n//# sourceMappingURL=chainConfig.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BhZ2VudGljLXRydXN0K2NvcmVAMS4wLjE3X0B2ZXJhbW8rY29yZUA2LjAuMF9idWZmZXJ1dGlsQDQuMC45X2VuY29kaW5nQDAuMS4xM19ncmFwaHFsQDE2LjEyLl9ibnlsZHR4emI2cHY3aXZyNXk2YTNvcnpnYS9ub2RlX21vZHVsZXMvQGFnZW50aWMtdHJ1c3QvY29yZS9kaXN0L3NlcnZlci9saWIvY2hhaW5Db25maWcuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNvRTtBQUNwRTtBQUNpRDtBQUNqRDtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ087QUFDUDtBQUNBO0FBQ0EsZ0RBQWdELFFBQVE7QUFDeEQ7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPLG1DQUFtQztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLDREQUFxRDtBQUNuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLDBFQUF5RDtBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLFlBQTBEO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQSw4QkFBOEIsU0FBUyxHQUFHLFdBQVcsT0FBTyxTQUFTLEdBQUcsUUFBUTtBQUNoRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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O0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtFQUFrRSxtQkFBbUI7QUFDckYsK0RBQStELFFBQVEsR0FBRyxpQkFBaUIsU0FBUyxZQUFZO0FBQ2hIO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseURBQXlELG1CQUFtQjtBQUM1RSxrRUFBa0UsUUFBUSxHQUFHLGlCQUFpQixTQUFTLFlBQVk7QUFDbkg7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscURBQXFELE1BQU07QUFDM0QseURBQXlELG1CQUFtQjtBQUM1RSxrRUFBa0UsUUFBUSxHQUFHLGlCQUFpQixTQUFTLFlBQVk7QUFDbkg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1AsV0FBVyx5RkFBMEMsSUFBSSxDQUFFO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL0BteS1zY29wZS9hcm4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BhZ2VudGljLXRydXN0K2NvcmVAMS4wLjE3X0B2ZXJhbW8rY29yZUA2LjAuMF9idWZmZXJ1dGlsQDQuMC45X2VuY29kaW5nQDAuMS4xM19ncmFwaHFsQDE2LjEyLl9ibnlsZHR4emI2cHY3aXZyNXk2YTNvcnpnYS9ub2RlX21vZHVsZXMvQGFnZW50aWMtdHJ1c3QvY29yZS9kaXN0L3NlcnZlci9saWIvY2hhaW5Db25maWcuanM/ZWQ1NCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENlbnRyYWxpemVkIENoYWluIENvbmZpZ3VyYXRpb25cbiAqXG4gKiBUaGlzIG1vZHVsZSBwcm92aWRlcyBjaGFpbi1zcGVjaWZpYyBjb25maWd1cmF0aW9uIGFuZCB1dGlsaXRpZXNcbiAqIHVzZWQgdGhyb3VnaG91dCB0aGUgQWdlbnRpY1RydXN0IHN5c3RlbS5cbiAqL1xuaW1wb3J0IHsgc2Vwb2xpYSwgYmFzZVNlcG9saWEsIG9wdGltaXNtU2Vwb2xpYSB9IGZyb20gJ3ZpZW0vY2hhaW5zJztcbi8vIFJlLWV4cG9ydCBjaGFpbnMgZm9yIGNvbnZlbmllbmNlXG5leHBvcnQgeyBzZXBvbGlhLCBiYXNlU2Vwb2xpYSwgb3B0aW1pc21TZXBvbGlhIH07XG4vKipcbiAqIENoYWluIGNvbmZpZ3VyYXRpb24gbWFwcGluZ1xuICovXG5leHBvcnQgY29uc3QgQ0hBSU5fQ09ORklHID0ge1xuICAgIDExMTU1MTExOiB7XG4gICAgICAgIHN1ZmZpeDogJ1NFUE9MSUEnLFxuICAgICAgICBuYW1lOiAnc2Vwb2xpYScsXG4gICAgICAgIGRpc3BsYXlOYW1lOiAnRXRoZXJldW0gU2Vwb2xpYScsXG4gICAgICAgIGxheWVyOiAnTDEnLFxuICAgIH0sXG4gICAgODQ1MzI6IHtcbiAgICAgICAgc3VmZml4OiAnQkFTRV9TRVBPTElBJyxcbiAgICAgICAgbmFtZTogJ2Jhc2VTZXBvbGlhJyxcbiAgICAgICAgZGlzcGxheU5hbWU6ICdCYXNlIFNlcG9saWEnLFxuICAgICAgICBsYXllcjogJ0wyJyxcbiAgICB9LFxuICAgIDExMTU1NDIwOiB7XG4gICAgICAgIHN1ZmZpeDogJ09QVElNSVNNX1NFUE9MSUEnLFxuICAgICAgICBuYW1lOiAnb3B0aW1pc21TZXBvbGlhJyxcbiAgICAgICAgZGlzcGxheU5hbWU6ICdPcHRpbWlzbSBTZXBvbGlhJyxcbiAgICAgICAgbGF5ZXI6ICdMMicsXG4gICAgfSxcbn07XG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2hhaW5MYXllcihjaGFpbklkKSB7XG4gICAgY29uc3QgY2ZnID0gQ0hBSU5fQ09ORklHW2NoYWluSWRdO1xuICAgIGlmICghY2ZnKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIGNoYWluSWQ6ICR7Y2hhaW5JZH1gKTtcbiAgICByZXR1cm4gY2ZnLmxheWVyO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGlzTDEoY2hhaW5JZCkge1xuICAgIHJldHVybiBnZXRDaGFpbkxheWVyKGNoYWluSWQpID09PSAnTDEnO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGlzTDIoY2hhaW5JZCkge1xuICAgIHJldHVybiBnZXRDaGFpbkxheWVyKGNoYWluSWQpID09PSAnTDInO1xufVxuLyoqXG4gKiBEZWZhdWx0IGNoYWluIElEIHVzZWQgd2hlbiBubyBjaGFpbiBpcyBzcGVjaWZpZWRcbiAqL1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfQ0hBSU5fSUQgPSAxMTE1NTExMTsgLy8gRXRoZXJldW0gU2Vwb2xpYVxuY29uc3QgU0VSVkVSX0NIQUlOX1JQQ19FTlYgPSB7XG4gICAgMTExNTUxMTE6IHByb2Nlc3MuZW52LkFHRU5USUNfVFJVU1RfUlBDX1VSTF9TRVBPTElBLFxuICAgIDg0NTMyOiBwcm9jZXNzLmVudi5BR0VOVElDX1RSVVNUX1JQQ19VUkxfQkFTRV9TRVBPTElBLFxuICAgIDExMTU1NDIwOiBwcm9jZXNzLmVudi5BR0VOVElDX1RSVVNUX1JQQ19VUkxfT1BUSU1JU01fU0VQT0xJQSxcbn07XG5jb25zdCBDTElFTlRfQ0hBSU5fUlBDX0VOViA9IHtcbiAgICAxMTE1NTExMTogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQUdFTlRJQ19UUlVTVF9SUENfVVJMX1NFUE9MSUEsXG4gICAgODQ1MzI6IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0FHRU5USUNfVFJVU1RfUlBDX1VSTF9CQVNFX1NFUE9MSUEsXG4gICAgMTExNTU0MjA6IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0FHRU5USUNfVFJVU1RfUlBDX1VSTF9PUFRJTUlTTV9TRVBPTElBLFxufTtcbmNvbnN0IFNFUlZFUl9DSEFJTl9CVU5ETEVSX0VOViA9IHtcbiAgICAxMTE1NTExMTogcHJvY2Vzcy5lbnYuQUdFTlRJQ19UUlVTVF9CVU5ETEVSX1VSTF9TRVBPTElBLFxuICAgIDg0NTMyOiBwcm9jZXNzLmVudi5BR0VOVElDX1RSVVNUX0JVTkRMRVJfVVJMX0JBU0VfU0VQT0xJQSxcbiAgICAxMTE1NTQyMDogcHJvY2Vzcy5lbnYuQUdFTlRJQ19UUlVTVF9CVU5ETEVSX1VSTF9PUFRJTUlTTV9TRVBPTElBLFxufTtcbmNvbnN0IENMSUVOVF9DSEFJTl9CVU5ETEVSX0VOViA9IHtcbiAgICAxMTE1NTExMTogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQUdFTlRJQ19UUlVTVF9CVU5ETEVSX1VSTF9TRVBPTElBLFxuICAgIDg0NTMyOiBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19BR0VOVElDX1RSVVNUX0JVTkRMRVJfVVJMX0JBU0VfU0VQT0xJQSxcbiAgICAxMTE1NTQyMDogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQUdFTlRJQ19UUlVTVF9CVU5ETEVSX1VSTF9PUFRJTUlTTV9TRVBPTElBLFxufTtcbi8vIEVOUyBjaGFpbi1zcGVjaWZpYyB2YXJpYWJsZXNcbmNvbnN0IFNFUlZFUl9DSEFJTl9FTlNfUFJJVktFWV9FTlYgPSB7XG4gICAgMTExNTUxMTE6IHByb2Nlc3MuZW52LkFHRU5USUNfVFJVU1RfRU5TX1BSSVZBVEVfS0VZX1NFUE9MSUEsXG4gICAgODQ1MzI6IHByb2Nlc3MuZW52LkFHRU5USUNfVFJVU1RfRU5TX1BSSVZBVEVfS0VZX0JBU0VfU0VQT0xJQSxcbiAgICAxMTE1NTQyMDogcHJvY2Vzcy5lbnYuQUdFTlRJQ19UUlVTVF9FTlNfUFJJVkFURV9LRVlfT1BUSU1JU01fU0VQT0xJQSxcbn07XG5jb25zdCBTRVJWRVJfQ0hBSU5fRU5TX09SR19BRERSRVNTX0VOViA9IHtcbiAgICAxMTE1NTExMTogcHJvY2Vzcy5lbnYuQUdFTlRJQ19UUlVTVF9FTlNfT1JHX0FERFJFU1NfU0VQT0xJQSxcbiAgICA4NDUzMjogcHJvY2Vzcy5lbnYuQUdFTlRJQ19UUlVTVF9FTlNfT1JHX0FERFJFU1NfQkFTRV9TRVBPTElBLFxuICAgIDExMTU1NDIwOiBwcm9jZXNzLmVudi5BR0VOVElDX1RSVVNUX0VOU19PUkdfQUREUkVTU19PUFRJTUlTTV9TRVBPTElBLFxufTtcbmNvbnN0IENMSUVOVF9DSEFJTl9FTlNfT1JHX05BTUVfRU5WID0ge1xuICAgIDExMTU1MTExOiBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19BR0VOVElDX1RSVVNUX0VOU19PUkdfTkFNRV9TRVBPTElBLFxuICAgIDg0NTMyOiBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19BR0VOVElDX1RSVVNUX0VOU19PUkdfTkFNRV9CQVNFX1NFUE9MSUEsXG4gICAgMTExNTU0MjA6IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0FHRU5USUNfVFJVU1RfRU5TX09SR19OQU1FX09QVElNSVNNX1NFUE9MSUEsXG59O1xuLyoqXG4gKiBHZXQgY2hhaW4tc3BlY2lmaWMgZW52aXJvbm1lbnQgdmFyaWFibGVcbiAqIEBwYXJhbSBiYXNlTmFtZSAtIEJhc2UgZW52aXJvbm1lbnQgdmFyaWFibGUgbmFtZSAoZS5nLiwgJ0FHRU5USUNfVFJVU1RfUlBDX1VSTCcpXG4gKiBAcGFyYW0gY2hhaW5JZCAtIENoYWluIElEIHRvIGdldCBjb25maWd1cmF0aW9uIGZvclxuICogQHJldHVybnMgQ2hhaW4tc3BlY2lmaWMgZW52aXJvbm1lbnQgdmFyaWFibGUgdmFsdWUgb3IgZmFsbGJhY2sgdG8gYmFzZSBuYW1lXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDaGFpbkVudlZhckRldGFpbHMoYmFzZU5hbWUsIGNoYWluSWQpIHtcbiAgICBjb25zdCBjZmcgPSBDSEFJTl9DT05GSUdbY2hhaW5JZF07XG4gICAgY29uc3QgY2hhaW5LZXkgPSBjZmcgPyBgJHtiYXNlTmFtZX1fJHtjZmcuc3VmZml4fWAgOiBgJHtiYXNlTmFtZX1fJHtjaGFpbklkfWA7XG4gICAgY29uc3QgZmFsbGJhY2tLZXkgPSBiYXNlTmFtZTtcbiAgICBjb25zdCBjaGFpblZhbHVlID0gY2ZnID8gcHJvY2Vzcy5lbnZbY2hhaW5LZXldIDogdW5kZWZpbmVkO1xuICAgIGNvbnN0IGZhbGxiYWNrVmFsdWUgPSBwcm9jZXNzLmVudltmYWxsYmFja0tleV07XG4gICAgY29uc3QgdmFsdWUgPSBjaGFpblZhbHVlID8/IGZhbGxiYWNrVmFsdWUgPz8gJyc7XG4gICAgY29uc3QgdXNlZEtleSA9IGNoYWluVmFsdWUgPyBjaGFpbktleSA6IGZhbGxiYWNrVmFsdWUgPyBmYWxsYmFja0tleSA6IGNoYWluS2V5O1xuICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlLFxuICAgICAgICBjaGFpbktleTogY2ZnID8gY2hhaW5LZXkgOiBmYWxsYmFja0tleSxcbiAgICAgICAgZmFsbGJhY2tLZXksXG4gICAgICAgIHVzZWRLZXksXG4gICAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRDaGFpbkVudlZhcihiYXNlTmFtZSwgY2hhaW5JZCkge1xuICAgIHJldHVybiBnZXRDaGFpbkVudlZhckRldGFpbHMoYmFzZU5hbWUsIGNoYWluSWQpLnZhbHVlO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldENoYWluRW52VmFyTmFtZXMoY2hhaW5JZCkge1xuICAgIGNvbnN0IGNmZyA9IENIQUlOX0NPTkZJR1tjaGFpbklkXTtcbiAgICBpZiAoIWNmZykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIGNoYWluSWQ6ICR7Y2hhaW5JZH1gKTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcnBjU2VydmVyOiBgQUdFTlRJQ19UUlVTVF9SUENfVVJMXyR7Y2ZnLnN1ZmZpeH1gLFxuICAgICAgICBycGNDbGllbnQ6IGBORVhUX1BVQkxJQ19BR0VOVElDX1RSVVNUX1JQQ19VUkxfJHtjZmcuc3VmZml4fWAsXG4gICAgICAgIGJ1bmRsZXJTZXJ2ZXI6IGBBR0VOVElDX1RSVVNUX0JVTkRMRVJfVVJMXyR7Y2ZnLnN1ZmZpeH1gLFxuICAgICAgICBidW5kbGVyQ2xpZW50OiBgTkVYVF9QVUJMSUNfQUdFTlRJQ19UUlVTVF9CVU5ETEVSX1VSTF8ke2NmZy5zdWZmaXh9YCxcbiAgICAgICAgZW5zT3JnQWRkcmVzc1NlcnZlcjogYEFHRU5USUNfVFJVU1RfRU5TX09SR19BRERSRVNTXyR7Y2ZnLnN1ZmZpeH1gLFxuICAgICAgICBlbnNPcmdOYW1lQ2xpZW50OiBgTkVYVF9QVUJMSUNfQUdFTlRJQ19UUlVTVF9FTlNfT1JHX05BTUVfJHtjZmcuc3VmZml4fWAsXG4gICAgICAgIGVuc1ByaXZhdGVLZXlTZXJ2ZXI6IGBBR0VOVElDX1RSVVNUX0VOU19QUklWQVRFX0tFWV8ke2NmZy5zdWZmaXh9YCxcbiAgICB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIHJlcXVpcmVDaGFpbkVudlZhcihiYXNlTmFtZSwgY2hhaW5JZCkge1xuICAgIGNvbnN0IHsgdmFsdWUsIGNoYWluS2V5IH0gPSBnZXRDaGFpbkVudlZhckRldGFpbHMoYmFzZU5hbWUsIGNoYWluSWQpO1xuICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBNaXNzaW5nIHJlcXVpcmVkIGVudmlyb25tZW50IHZhcmlhYmxlOiAke2NoYWluS2V5fWApO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG59XG4vKipcbiAqIEdldCBjaGFpbi1zcGVjaWZpYyBjb250cmFjdCBhZGRyZXNzXG4gKiBAcGFyYW0gYmFzZU5hbWUgLSBCYXNlIGVudmlyb25tZW50IHZhcmlhYmxlIG5hbWUgKGUuZy4sICdBR0VOVElDX1RSVVNUX0VOU19SRUdJU1RSWScpXG4gKiBAcGFyYW0gY2hhaW5JZCAtIENoYWluIElEIHRvIGdldCBjb25maWd1cmF0aW9uIGZvclxuICogQHJldHVybnMgQ2hhaW4tc3BlY2lmaWMgY29udHJhY3QgYWRkcmVzcyBvciBmYWxsYmFjayB0byBiYXNlIG5hbWVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENoYWluQ29udHJhY3RBZGRyZXNzKGJhc2VOYW1lLCBjaGFpbklkKSB7XG4gICAgY29uc3QgdmFsdWUgPSBnZXRDaGFpbkVudlZhcihiYXNlTmFtZSwgY2hhaW5JZCk7XG4gICAgcmV0dXJuIHZhbHVlID8gKHZhbHVlLnN0YXJ0c1dpdGgoJzB4JykgPyB2YWx1ZSA6IGAweCR7dmFsdWV9YCkgOiB1bmRlZmluZWQ7XG59XG4vKipcbiAqIEdldCBjaGFpbiBvYmplY3QgYnkgY2hhaW5JZFxuICogQHBhcmFtIGNoYWluSWQgLSBDaGFpbiBJRCB0byBnZXQgY2hhaW4gb2JqZWN0IGZvclxuICogQHJldHVybnMgdmllbSBDaGFpbiBvYmplY3RcbiAqIEB0aHJvd3MgRXJyb3IgaWYgY2hhaW5JZCBpcyBub3Qgc3VwcG9ydGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDaGFpbkJ5SWQoY2hhaW5JZCkge1xuICAgIGNvbnN0IGNoYWluQ29uZmlnID0gQ0hBSU5fQ09ORklHW2NoYWluSWRdO1xuICAgIGlmICghY2hhaW5Db25maWcpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCBjaGFpbklkOiAke2NoYWluSWR9LiBTdXBwb3J0ZWQgY2hhaW5zOiAke09iamVjdC5rZXlzKENIQUlOX0NPTkZJRykuam9pbignLCAnKX1gKTtcbiAgICB9XG4gICAgY29uc3QgY2hhaW5OYW1lID0gY2hhaW5Db25maWcubmFtZTtcbiAgICBzd2l0Y2ggKGNoYWluTmFtZSkge1xuICAgICAgICBjYXNlICdzZXBvbGlhJzpcbiAgICAgICAgICAgIHJldHVybiBzZXBvbGlhO1xuICAgICAgICBjYXNlICdiYXNlU2Vwb2xpYSc6XG4gICAgICAgICAgICByZXR1cm4gYmFzZVNlcG9saWE7XG4gICAgICAgIGNhc2UgJ29wdGltaXNtU2Vwb2xpYSc6XG4gICAgICAgICAgICByZXR1cm4gb3B0aW1pc21TZXBvbGlhO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDaGFpbiAke2NoYWluTmFtZX0gbm90IGltcGxlbWVudGVkYCk7XG4gICAgfVxufVxuLyoqXG4gKiBHZXQgYWxsIHN1cHBvcnRlZCBjaGFpbiBJRHNcbiAqIEByZXR1cm5zIEFycmF5IG9mIHN1cHBvcnRlZCBjaGFpbiBJRHNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFN1cHBvcnRlZENoYWluSWRzKCkge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhDSEFJTl9DT05GSUcpLm1hcChpZCA9PiBwYXJzZUludChpZCwgMTApKTtcbn1cbi8qKlxuICogQ2hlY2sgaWYgYSBjaGFpbiBJRCBpcyBzdXBwb3J0ZWRcbiAqIEBwYXJhbSBjaGFpbklkIC0gQ2hhaW4gSUQgdG8gY2hlY2tcbiAqIEByZXR1cm5zIFRydWUgaWYgdGhlIGNoYWluIElEIGlzIHN1cHBvcnRlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNDaGFpblN1cHBvcnRlZChjaGFpbklkKSB7XG4gICAgcmV0dXJuIGNoYWluSWQgaW4gQ0hBSU5fQ09ORklHO1xufVxuLyoqXG4gKiBHZXQgY2hhaW4gY29uZmlndXJhdGlvbiBieSBjaGFpbiBJRFxuICogQHBhcmFtIGNoYWluSWQgLSBDaGFpbiBJRCB0byBnZXQgY29uZmlndXJhdGlvbiBmb3JcbiAqIEByZXR1cm5zIENoYWluIGNvbmZpZ3VyYXRpb24gb2JqZWN0IG9yIG51bGwgaWYgbm90IHN1cHBvcnRlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2hhaW5Db25maWcoY2hhaW5JZCkge1xuICAgIHJldHVybiBDSEFJTl9DT05GSUdbY2hhaW5JZF0gfHwgbnVsbDtcbn1cbi8qKlxuICogR2V0IGNoYWluLXNwZWNpZmljIFJQQyBVUkwgKGFjY2Vzc2libGUgZnJvbSBib3RoIHNlcnZlciBhbmQgY2xpZW50KVxuICpcbiAqIFJlcXVpcmVzIGNoYWluLXNwZWNpZmljIGVudmlyb25tZW50IHZhcmlhYmxlcyAtIHRocm93cyBlcnJvciBpZiBub3QgZm91bmQ6XG4gKiBCcm93c2VyOiBORVhUX1BVQkxJQ19BR0VOVElDX1RSVVNUX1JQQ19VUkxfe0NIQUlOX1NVRkZJWH1cbiAqIFNlcnZlcjogQUdFTlRJQ19UUlVTVF9SUENfVVJMX3tDSEFJTl9TVUZGSVh9IChwcmVmZXJyZWQpIG9yIE5FWFRfUFVCTElDX0FHRU5USUNfVFJVU1RfUlBDX1VSTF97Q0hBSU5fU1VGRklYfVxuICogTm8gZ2VuZXJpYyBmYWxsYmFja3MgLSBvbmx5IGNoYWluLXNwZWNpZmljIHZhcmlhYmxlcyBhcmUgY2hlY2tlZFxuICpcbiAqIEBwYXJhbSBjaGFpbklkIC0gQ2hhaW4gSUQgdG8gZ2V0IFJQQyBVUkwgZm9yXG4gKiBAcmV0dXJucyBSUEMgVVJMIHN0cmluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2hhaW5ScGNVcmwoY2hhaW5JZCkge1xuICAgIGNvbnN0IGNoYWluQ29uZmlnID0gQ0hBSU5fQ09ORklHW2NoYWluSWRdO1xuICAgIGlmIChjaGFpbkNvbmZpZykge1xuICAgICAgICAvLyBEZXRlcm1pbmUgaWYgd2UncmUgcnVubmluZyBpbiBicm93c2VyIG9yIHNlcnZlclxuICAgICAgICBjb25zdCBpc0Jyb3dzZXIgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJztcbiAgICAgICAgLy8gUmVhZCBkaXJlY3RseSBmcm9tIHByb2Nlc3MuZW52IGF0IHJ1bnRpbWUgaW5zdGVhZCBvZiB1c2luZyBjYWNoZWQgdmFsdWVzXG4gICAgICAgIC8vIFRoaXMgZW5zdXJlcyB3ZSBnZXQgdGhlIGN1cnJlbnQgdmFsdWUgZXZlbiBpZiBlbnYgdmFycyB3ZXJlIGxvYWRlZCBhZnRlciBtb2R1bGUgaW5pdGlhbGl6YXRpb25cbiAgICAgICAgbGV0IHNlcnZlclZhbHVlO1xuICAgICAgICBsZXQgY2xpZW50VmFsdWU7XG4gICAgICAgIGlmIChjaGFpbklkID09PSAxMTE1NTExMSkge1xuICAgICAgICAgICAgc2VydmVyVmFsdWUgPSBwcm9jZXNzLmVudi5BR0VOVElDX1RSVVNUX1JQQ19VUkxfU0VQT0xJQTtcbiAgICAgICAgICAgIGNsaWVudFZhbHVlID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQUdFTlRJQ19UUlVTVF9SUENfVVJMX1NFUE9MSUE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY2hhaW5JZCA9PT0gODQ1MzIpIHtcbiAgICAgICAgICAgIHNlcnZlclZhbHVlID0gcHJvY2Vzcy5lbnYuQUdFTlRJQ19UUlVTVF9SUENfVVJMX0JBU0VfU0VQT0xJQTtcbiAgICAgICAgICAgIGNsaWVudFZhbHVlID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQUdFTlRJQ19UUlVTVF9SUENfVVJMX0JBU0VfU0VQT0xJQTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjaGFpbklkID09PSAxMTE1NTQyMCkge1xuICAgICAgICAgICAgc2VydmVyVmFsdWUgPSBwcm9jZXNzLmVudi5BR0VOVElDX1RSVVNUX1JQQ19VUkxfT1BUSU1JU01fU0VQT0xJQTtcbiAgICAgICAgICAgIGNsaWVudFZhbHVlID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQUdFTlRJQ19UUlVTVF9SUENfVVJMX09QVElNSVNNX1NFUE9MSUE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzQnJvd3Nlcikge1xuICAgICAgICAgICAgaWYgKGNsaWVudFZhbHVlKVxuICAgICAgICAgICAgICAgIHJldHVybiBjbGllbnRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChzZXJ2ZXJWYWx1ZSlcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VydmVyVmFsdWU7XG4gICAgICAgICAgICBpZiAoY2xpZW50VmFsdWUpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNsaWVudFZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIC8vIExvZyBhbGwgQUdFTlRJQ19UUlVTVCB2YXJpYWJsZXMgZm9yIGRlYnVnZ2luZ1xuICAgICAgICBjb25zdCBhbGxNYXRjaGluZ0tleXMgPSBPYmplY3Qua2V5cyhwcm9jZXNzLmVudikuZmlsdGVyKGtleSA9PiBrZXkuc3RhcnRzV2l0aCgnQUdFTlRJQ19UUlVTVCcpIHx8IGtleS5zdGFydHNXaXRoKCdORVhUX1BVQkxJQ19BR0VOVElDX1RSVVNUJykpO1xuICAgICAgICAvLyBObyBnZW5lcmljIGZhbGxiYWNrcyAtIHRocm93IGVycm9yIGlmIGNoYWluLXNwZWNpZmljIHZhcmlhYmxlIG5vdCBjb25maWd1cmVkXG4gICAgICAgIGNvbnN0IGVudk5hbWVzID0gZ2V0Q2hhaW5FbnZWYXJOYW1lcyhjaGFpbklkKTtcbiAgICAgICAgY29uc3QgbWFzayA9ICh2YWwpID0+ICh2YWwgPyAnPHNldD4nIDogJzxtaXNzaW5nPicpO1xuICAgICAgICBjb25zdCBleHBlY3RlZFZhciA9IGlzQnJvd3NlciA/IGVudk5hbWVzLnJwY0NsaWVudCA6IGVudk5hbWVzLnJwY1NlcnZlcjtcbiAgICAgICAgY29uc29sZS5lcnJvcihgW2NoYWluQ29uZmlnXSBNaXNzaW5nIFJQQyBVUkwgZm9yIGNoYWluICR7Y2hhaW5JZH0gKCR7Y2hhaW5Db25maWcubmFtZX0pLiBDaGVja2VkIGVudiB2YXJzIGAgK1xuICAgICAgICAgICAgYCR7ZW52TmFtZXMucnBjU2VydmVyfT0ke21hc2soc2VydmVyVmFsdWUpfSBhbmQgJHtlbnZOYW1lcy5ycGNDbGllbnR9PSR7bWFzayhjbGllbnRWYWx1ZSl9LiBgICtcbiAgICAgICAgICAgIGBTZXQgJHtpc0Jyb3dzZXIgPyBlbnZOYW1lcy5ycGNDbGllbnQgOiBgJHtlbnZOYW1lcy5ycGNTZXJ2ZXJ9IChzZXJ2ZXIpIG9yICR7ZW52TmFtZXMucnBjQ2xpZW50fWB9LmApO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1pc3NpbmcgcmVxdWlyZWQgUlBDIFVSTCBmb3IgY2hhaW4gJHtjaGFpbklkfSAoJHtjaGFpbkNvbmZpZy5uYW1lfSkuIGAgK1xuICAgICAgICAgICAgYFNldCAke2V4cGVjdGVkVmFyfSBlbnZpcm9ubWVudCB2YXJpYWJsZS5gKTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCBjaGFpbiBJRDogJHtjaGFpbklkfWApO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldENoYWluSWRIZXgoY2hhaW5JZCkge1xuICAgIHJldHVybiBgMHgke2NoYWluSWQudG9TdHJpbmcoMTYpfWA7XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2hhaW5EaXNwbGF5TWV0YWRhdGEoY2hhaW5JZCkge1xuICAgIGNvbnN0IGNoYWluQ29uZmlnID0gQ0hBSU5fQ09ORklHW2NoYWluSWRdO1xuICAgIGlmICghY2hhaW5Db25maWcpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCBjaGFpbiBJRDogJHtjaGFpbklkfWApO1xuICAgIH1cbiAgICBjb25zdCBjaGFpbiA9IGdldENoYWluQnlJZChjaGFpbklkKTtcbiAgICBjb25zdCBjaGFpbklkSGV4ID0gZ2V0Q2hhaW5JZEhleChjaGFpbklkKTtcbiAgICBjb25zdCBycGNVcmwgPSBnZXRDaGFpblJwY1VybChjaGFpbklkKTtcbiAgICBjb25zdCBuYXRpdmVDdXJyZW5jeSA9IGNoYWluLm5hdGl2ZUN1cnJlbmN5ID8/IHtcbiAgICAgICAgbmFtZTogJ0V0aGVyJyxcbiAgICAgICAgc3ltYm9sOiAnRVRIJyxcbiAgICAgICAgZGVjaW1hbHM6IDE4LFxuICAgIH07XG4gICAgY29uc3QgYmxvY2tFeHBsb3JlclVybHMgPSBbXTtcbiAgICBjb25zdCBkZWZhdWx0RXhwbG9yZXJVcmwgPSBjaGFpbi5ibG9ja0V4cGxvcmVycz8uZGVmYXVsdD8udXJsO1xuICAgIGlmIChkZWZhdWx0RXhwbG9yZXJVcmwpIHtcbiAgICAgICAgYmxvY2tFeHBsb3JlclVybHMucHVzaChkZWZhdWx0RXhwbG9yZXJVcmwpO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBjaGFpbklkLFxuICAgICAgICBjaGFpbklkSGV4LFxuICAgICAgICBjaGFpbk5hbWU6IGNoYWluLm5hbWUsXG4gICAgICAgIGRpc3BsYXlOYW1lOiBjaGFpbkNvbmZpZy5kaXNwbGF5TmFtZSB8fCBjaGFpbi5uYW1lLFxuICAgICAgICBuYXRpdmVDdXJyZW5jeSxcbiAgICAgICAgcnBjVXJsczogW3JwY1VybF0sXG4gICAgICAgIGJsb2NrRXhwbG9yZXJVcmxzLFxuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0V2ViM0F1dGhDaGFpblNldHRpbmdzKGNoYWluSWQpIHtcbiAgICBjb25zdCBtZXRhZGF0YSA9IGdldENoYWluRGlzcGxheU1ldGFkYXRhKGNoYWluSWQpO1xuICAgIGNvbnN0IG5hdGl2ZUN1cnJlbmN5ID0gbWV0YWRhdGEubmF0aXZlQ3VycmVuY3k7XG4gICAgY29uc3QgcnBjVGFyZ2V0ID0gbWV0YWRhdGEucnBjVXJsc1swXTtcbiAgICBpZiAoIXJwY1RhcmdldCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1pc3NpbmcgUlBDIFVSTCBmb3IgV2ViM0F1dGggY2hhaW4gJHtjaGFpbklkfWApO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBjaGFpbk5hbWVzcGFjZTogJ2VpcDE1NScsXG4gICAgICAgIGNoYWluSWQ6IG1ldGFkYXRhLmNoYWluSWRIZXgsXG4gICAgICAgIHJwY1RhcmdldCxcbiAgICAgICAgZGlzcGxheU5hbWU6IG1ldGFkYXRhLmRpc3BsYXlOYW1lLFxuICAgICAgICBibG9ja0V4cGxvcmVyVXJsOiBtZXRhZGF0YS5ibG9ja0V4cGxvcmVyVXJsc1swXSxcbiAgICAgICAgdGlja2VyOiBuYXRpdmVDdXJyZW5jeS5zeW1ib2wgPz8gJ0VUSCcsXG4gICAgICAgIHRpY2tlck5hbWU6IG5hdGl2ZUN1cnJlbmN5Lm5hbWUgPz8gJ0V0aGVyJyxcbiAgICAgICAgZGVjaW1hbHM6IG5hdGl2ZUN1cnJlbmN5LmRlY2ltYWxzID8/IDE4LFxuICAgICAgICBuYXRpdmVDdXJyZW5jeSxcbiAgICAgICAgcnBjVXJsczogbWV0YWRhdGEucnBjVXJscyxcbiAgICAgICAgYmxvY2tFeHBsb3JlclVybHM6IG1ldGFkYXRhLmJsb2NrRXhwbG9yZXJVcmxzLFxuICAgIH07XG59XG4vKipcbiAqIEdldCBjaGFpbi1zcGVjaWZpYyBidW5kbGVyIFVSTCAoYWNjZXNzaWJsZSBmcm9tIGJvdGggc2VydmVyIGFuZCBjbGllbnQpXG4gKiBAcGFyYW0gY2hhaW5JZCAtIENoYWluIElEIHRvIGdldCBidW5kbGVyIFVSTCBmb3JcbiAqIEByZXR1cm5zIEJ1bmRsZXIgVVJMIHN0cmluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2hhaW5CdW5kbGVyVXJsKGNoYWluSWQpIHtcbiAgICBjb25zdCBjaGFpbkNvbmZpZyA9IENIQUlOX0NPTkZJR1tjaGFpbklkXTtcbiAgICBpZiAoY2hhaW5Db25maWcpIHtcbiAgICAgICAgY29uc3QgaXNCcm93c2VyID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCc7XG4gICAgICAgIGlmIChpc0Jyb3dzZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IGNsaWVudFZhbHVlID0gQ0xJRU5UX0NIQUlOX0JVTkRMRVJfRU5WW2NoYWluSWRdO1xuICAgICAgICAgICAgaWYgKGNsaWVudFZhbHVlKVxuICAgICAgICAgICAgICAgIHJldHVybiBjbGllbnRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHNlcnZlclZhbHVlID0gU0VSVkVSX0NIQUlOX0JVTkRMRVJfRU5WW2NoYWluSWRdO1xuICAgICAgICAgICAgaWYgKHNlcnZlclZhbHVlKVxuICAgICAgICAgICAgICAgIHJldHVybiBzZXJ2ZXJWYWx1ZTtcbiAgICAgICAgICAgIGNvbnN0IGNsaWVudFZhbHVlID0gQ0xJRU5UX0NIQUlOX0JVTkRMRVJfRU5WW2NoYWluSWRdO1xuICAgICAgICAgICAgaWYgKGNsaWVudFZhbHVlKVxuICAgICAgICAgICAgICAgIHJldHVybiBjbGllbnRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBlbnZOYW1lcyA9IGdldENoYWluRW52VmFyTmFtZXMoY2hhaW5JZCk7XG4gICAgICAgIGNvbnN0IG1hc2sgPSAodmFsKSA9PiAodmFsID8gJzxzZXQ+JyA6ICc8bWlzc2luZz4nKTtcbiAgICAgICAgY29uc3QgZXhwZWN0ZWRWYXIgPSBpc0Jyb3dzZXIgPyBlbnZOYW1lcy5idW5kbGVyQ2xpZW50IDogZW52TmFtZXMuYnVuZGxlclNlcnZlcjtcbiAgICAgICAgY29uc29sZS5lcnJvcihgW2NoYWluQ29uZmlnXSBNaXNzaW5nIGJ1bmRsZXIgVVJMIGZvciBjaGFpbiAke2NoYWluSWR9ICgke2NoYWluQ29uZmlnLm5hbWV9KS4gQ2hlY2tlZCBlbnYgdmFycyBgICtcbiAgICAgICAgICAgIGAke2Vudk5hbWVzLmJ1bmRsZXJTZXJ2ZXJ9PSR7bWFzayhTRVJWRVJfQ0hBSU5fQlVORExFUl9FTlZbY2hhaW5JZF0pfSBgICtcbiAgICAgICAgICAgIGBhbmQgJHtlbnZOYW1lcy5idW5kbGVyQ2xpZW50fT0ke21hc2soQ0xJRU5UX0NIQUlOX0JVTkRMRVJfRU5WW2NoYWluSWRdKX0uYCk7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyByZXF1aXJlZCBidW5kbGVyIFVSTCBmb3IgY2hhaW4gJHtjaGFpbklkfSAoJHtjaGFpbkNvbmZpZy5uYW1lfSkuIGAgK1xuICAgICAgICAgICAgYFNldCAke2V4cGVjdGVkVmFyfSBlbnZpcm9ubWVudCB2YXJpYWJsZS5gKTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCBjaGFpbiBJRDogJHtjaGFpbklkfWApO1xufVxuLyoqXG4gKiBDaGVjayBpZiBwcml2YXRlIGtleSBtb2RlIGlzIGVuYWJsZWQgKGFjY2Vzc2libGUgZnJvbSBib3RoIHNlcnZlciBhbmQgY2xpZW50KVxuICogQHJldHVybnMgVHJ1ZSBpZiBwcml2YXRlIGtleSBtb2RlIGlzIGVuYWJsZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzUHJpdmF0ZUtleU1vZGUoKSB7XG4gICAgY29uc29sZS5sb2coXCJpc1ByaXZhdGVLZXlNb2RlOiBcIiwgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQUdFTlRJQ19UUlVTVF9VU0VfUFJJVkFURV9LRVkpO1xuICAgIHJldHVybiBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19BR0VOVElDX1RSVVNUX1VTRV9QUklWQVRFX0tFWSA9PT0gJ3RydWUnO1xufVxuLyoqXG4gKiBHZXQgRU5TIG9yZ2FuaXphdGlvbiBuYW1lIChhY2Nlc3NpYmxlIGZyb20gYm90aCBzZXJ2ZXIgYW5kIGNsaWVudCksIGNoYWluLXNwZWNpZmljLlxuICogVGhyb3dzIGlmIG5vdCBjb25maWd1cmVkLlxuICogQHBhcmFtIGNoYWluSWQgLSB0YXJnZXQgY2hhaW4gKGRlZmF1bHRzIHRvIERFRkFVTFRfQ0hBSU5fSUQpXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFbnNPcmdOYW1lKGNoYWluSWQpIHtcbiAgICBjb25zdCB0YXJnZXQgPSAoY2hhaW5JZCA/PyBERUZBVUxUX0NIQUlOX0lEKTtcbiAgICBjb25zdCBjaGFpbkNvbmZpZyA9IENIQUlOX0NPTkZJR1t0YXJnZXRdO1xuICAgIGNvbnN0IGlzQnJvd3NlciA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnO1xuICAgIGNvbnN0IGNsaWVudFZhbHVlID0gQ0xJRU5UX0NIQUlOX0VOU19PUkdfTkFNRV9FTlZbdGFyZ2V0XTtcbiAgICBpZiAoY2xpZW50VmFsdWUpXG4gICAgICAgIHJldHVybiBjbGllbnRWYWx1ZTtcbiAgICAvLyBBbGxvdyBzZXJ2ZXIgdG8gYWxzbyByZWFkIE5FWFRfUFVCTElDXyB2YWx1ZSAoY29uc2lzdGVuY3kgd2l0aCBSUEMgbG9naWMpXG4gICAgaWYgKCFpc0Jyb3dzZXIgJiYgY2xpZW50VmFsdWUpXG4gICAgICAgIHJldHVybiBjbGllbnRWYWx1ZTtcbiAgICBjb25zdCBleHBlY3RlZFZhciA9IGBORVhUX1BVQkxJQ19BR0VOVElDX1RSVVNUX0VOU19PUkdfTkFNRV8ke2NoYWluQ29uZmlnLnN1ZmZpeH1gO1xuICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyByZXF1aXJlZCBFTlMgb3JnIG5hbWUgZm9yIGNoYWluICR7dGFyZ2V0fSAoJHtjaGFpbkNvbmZpZy5uYW1lfSkuIFNldCAke2V4cGVjdGVkVmFyfS5gKTtcbn1cbi8qKlxuICogR2V0IEVOUyBvcmcgYWRkcmVzcyAoc2VydmVyLW9ubHkpLCBjaGFpbi1zcGVjaWZpYy4gVGhyb3dzIGlmIG5vdCBjb25maWd1cmVkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RW5zT3JnQWRkcmVzcyhjaGFpbklkKSB7XG4gICAgY29uc3QgdGFyZ2V0ID0gY2hhaW5JZDtcbiAgICBjb25zdCBjaGFpbkNvbmZpZyA9IENIQUlOX0NPTkZJR1t0YXJnZXRdO1xuICAgIGNvbnN0IHZhbHVlID0gU0VSVkVSX0NIQUlOX0VOU19PUkdfQUREUkVTU19FTlZbdGFyZ2V0XTtcbiAgICBpZiAodmFsdWUgJiYgdmFsdWUuc3RhcnRzV2l0aCgnMHgnKSAmJiB2YWx1ZS5sZW5ndGggPT09IDQyKVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgY29uc3QgZXhwZWN0ZWRWYXIgPSBgQUdFTlRJQ19UUlVTVF9FTlNfT1JHX0FERFJFU1NfJHtjaGFpbkNvbmZpZy5zdWZmaXh9YDtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYE1pc3NpbmcgcmVxdWlyZWQgRU5TIG9yZyBhZGRyZXNzIGZvciBjaGFpbiAke3RhcmdldH0gKCR7Y2hhaW5Db25maWcubmFtZX0pLiBTZXQgJHtleHBlY3RlZFZhcn0uYCk7XG59XG4vKipcbiAqIEdldCBFTlMgcHJpdmF0ZSBrZXkgKHNlcnZlci1vbmx5KSwgY2hhaW4tc3BlY2lmaWMuIFRocm93cyBpZiBub3QgY29uZmlndXJlZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEVuc1ByaXZhdGVLZXkoY2hhaW5JZCkge1xuICAgIGNvbnN0IHRhcmdldCA9IGNoYWluSWQ7XG4gICAgY29uc3QgY2hhaW5Db25maWcgPSBDSEFJTl9DT05GSUdbdGFyZ2V0XTtcbiAgICBjb25zdCB2YWx1ZSA9IFNFUlZFUl9DSEFJTl9FTlNfUFJJVktFWV9FTlZbdGFyZ2V0XTtcbiAgICBpZiAodmFsdWUpXG4gICAgICAgIHJldHVybiB2YWx1ZS5zdGFydHNXaXRoKCcweCcpID8gdmFsdWUgOiBgMHgke3ZhbHVlfWA7XG4gICAgY29uc3QgZXhwZWN0ZWRWYXIgPSBgQUdFTlRJQ19UUlVTVF9FTlNfUFJJVkFURV9LRVlfJHtjaGFpbkNvbmZpZy5zdWZmaXh9YDtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYE1pc3NpbmcgcmVxdWlyZWQgRU5TIHByaXZhdGUga2V5IGZvciBjaGFpbiAke3RhcmdldH0gKCR7Y2hhaW5Db25maWcubmFtZX0pLiBTZXQgJHtleHBlY3RlZFZhcn0uYCk7XG59XG4vKipcbiAqIEdldCBXZWIzQXV0aCBjbGllbnQgSUQgKGFjY2Vzc2libGUgZnJvbSBib3RoIHNlcnZlciBhbmQgY2xpZW50KVxuICogQHJldHVybnMgV2ViM0F1dGggY2xpZW50IElEXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRXZWIzQXV0aENsaWVudElkKCkge1xuICAgIHJldHVybiBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19XRUIzQVVUSF9DTElFTlRfSUQgfHwgJyc7XG59XG4vKipcbiAqIEdldCBXZWIzQXV0aCBuZXR3b3JrIChhY2Nlc3NpYmxlIGZyb20gYm90aCBzZXJ2ZXIgYW5kIGNsaWVudClcbiAqIEByZXR1cm5zIFdlYjNBdXRoIG5ldHdvcmtcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFdlYjNBdXRoTmV0d29yaygpIHtcbiAgICByZXR1cm4gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfV0VCM0FVVEhfTkVUV09SSyB8fCAnc2FwcGhpcmVfZGV2bmV0Jztcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNoYWluQ29uZmlnLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/../../node_modules/.pnpm/@agentic-trust+core@1.0.17_@veramo+core@6.0.0_bufferutil@4.0.9_encoding@0.1.13_graphql@16.12._bnyldtxzb6pv7ivr5y6a3orzga/node_modules/@agentic-trust/core/dist/server/lib/chainConfig.js\n");

/***/ })

};
;